function _parsePx(e){return e&&e.indexOf&&-1<e.indexOf('px')&&parseInt(e.replace('px',''))}function isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}class Position{constructor(e,t,i,r){'object'==typeof e?(this.x=e.x,this.y=e.y,this.dx=e.dx,this.dy=e.dy):(this.x=e,this.y=t,this.dx=i,this.dy=r)}duplicate(){return new Position(this.x,this.y,this.dx,this.dy)}compute(e,t,i,r){if(e&&t&&i&&e.hasXAxis&&e.hasYAxis||e.throw(),!e.hasXAxis(t))throw'Graph does not contain the x axis that was used as a parameter';if(!e.hasYAxis(i))throw'Graph does not contain the x axis that was used as a parameter';return this._compute(e,t,i,r)}_compute(e,t,r,a){var s=this._relativeTo;if(s)var n=s._compute(e,t,r,a);var o={x:!1,y:!1},l;for(var p in t||(t=e.getXAxis()),r||(r=e.getYAxis()),o){var i='x'==p?t:r,d=this[p],g=this['d'+p];if(void 0!==d||(void 0===g||void 0!==s)&&void 0!==s)void 0!==d&&(o[p]=this.getPx(d,i));else if('x'==p){if(void 0===g)continue;o[p]=s?s[p]:0}else if(void 0!==this.x&&a)if(!1!==_parsePx(this.x))console.warn('You have defined x in px and not y. Makes no sense. Returning 0 for y'),o[p]=0;else try{var c=a.searchClosestValue(this.x);if(!c)throw new Error(`Could not find y position for x = ${this.x} on serie "${a.getName()}". Returning 0 for y.`);o[p]=a.getY(c.yClosest)}catch(e){console.error(e),o[p]=0}if(void 0!==g){var u=void 0!==d||void 0==n||void 0==n[p]?o[p]:n[p];if('y'==p&&n&&void 0!==n.x&&void 0==n.y){if(!a){throw new Error(`Error. No serie exists. Cannot find y value`)}var c=a.searchClosestValue(s.x);c&&(u=a.getY(c.yMin))}u||(u=0),!1===(l=_parsePx(g))?!1===(l=this._parsePercent(g))?i&&(o[p]=u+i.getRelPx(g)):o[p]=u+this._getPositionPx(l,!0,i,e):o[p]=u+l}}return o}_getPositionPx(e,t,i,r){var a;if(!1!==(a=_parsePx(e)))return a;return!1===(a=this._parsePercent(e))?i?i.getPos(e):void 0:a/100*(t?r.getDrawingWidth():r.getDrawingHeight())}_parsePercent(e){return e&&e.indexOf&&-1<e.indexOf('%')&&e}getDeltaPx(e,t){var i;return!1===(i=_parsePx(e))?t.getRelPx(e)+'px':i+'px'}deltaPosition(e,t,i){e='y'==e?'y':'x';var r=this[e],a=this['d'+e],s,n;if(r!==void 0)!1===(s=_parsePx(r))?(r=this.getValPosition(r,i),this[e]=!1===(n=_parsePx(t))?r+t:r+i.getRelVal(n)):!1===(n=_parsePx(t))?this[e]=s+i.getRelPx(t)+'px':this[e]=s+n+'px';else if(a!==void 0){if('y'==e&&r===void 0&&!this._relativeTo)return;!1===(s=_parsePx(a))?(a=this.getValPosition(a,i),this['d'+e]=!1===(n=_parsePx(t))?a+t:a+i.getRelVal(n)):!1===(n=_parsePx(t))?this['d'+e]=s+i.getRelPx(t)+'px':this['d'+e]=s+n+'px'}}getValPosition(e,t){return'max'==e?t.getMaxValue():'min'==e?t.getMinValue():e}getPx(e,t,i){var r;if('function'==typeof e)return e(t,i);if(!1!==(r=_parsePx(e)))return r;if(!1!==(r=this._parsePercent(e)))return r;if(t){if('min'==e)return t.getMinPx();if('max'==e)return t.getMaxPx();if(i)return t.getRelPx(e);if(isNumeric(e))return t.getPos(e)}}getPxRel(e,t){return this.getPx(e,t,!0)}relativeTo(e){return this._relativeTo=Position.check(e),this}static check(e,t){if(e instanceof Position)return e;var i=new Position(e);if(e&&e.relativeTo){const r=t(e.relativeTo);r&&i.relativeTo(r)}return i}}function setAttributeTo(e,t,r){if(r)for(var a in t)e.setAttributeNS(r,a,t[a]);else for(a in t)e.setAttribute(a,t[a])}function mapEventEmission(e,t){t||(t=this);var r;for(var a in e)0==a.indexOf('on')&&'function'==typeof e[a]&&(r=a.substring(2),r=r.substring(0,1).toLowerCase()+r.substring(1),t.on&&function(i){t.on(r,function(){e[i].apply(t,arguments)})}(a))}function guid(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(e){var t=0|16*Math.random(),i='x'==e?t:8|3&t;return i.toString(16)})}function throwError(e){console.error(e)}function warn(e){console.warn(e)}function isNumeric$1(e){return!Array.isArray(e)&&0<=e-parseFloat(e)+1}function hue2rgb(e,i,r){return 0>r&&(r+=1),1<r&&(r-=1),r<1/6?e+6*(i-e)*r:r<1/2?i:r<2/3?e+6*((i-e)*(2/3-r)):e}function hslToRgb(e,t,i){var a=Math.round,s,r,n;if(0==t)s=r=n=i;else{var o=0.5>i?i*(1+t):i+t-i*t,l=2*i-o;s=hue2rgb(l,o,e+1/3),r=hue2rgb(l,o,e),n=hue2rgb(l,o,e-1/3)}return[a(255*s),a(255*r),a(255*n)]}function saveDomAttributes(e,t,r){if(e)for(var a in e._savedAttributesIds=e._savedAttributesIds||[],-1<e._savedAttributesIds.indexOf(r)&&restoreDomAttributes(e,r),e._savedAttributes=e._savedAttributes||{},e._attributes=e._attributes||{},e._attributes[r]=t,e._savedAttributesIds.push(r),t)e._savedAttributes[a]||(e._savedAttributes[a]=e.getAttribute(a)),e.setAttribute(a,t[a])}function hasSavedAttribute(e,t){return e._savedAttributes&&e._savedAttributes[t]!==void 0}function overwriteDomAttribute(e,t,i){hasSavedAttribute(e,t)&&(e._savedAttributes[t]=i)}function restoreDomAttributes(e,t){if(e&&e._savedAttributesIds){e._savedAttributesIds.splice(e._savedAttributesIds.indexOf(t),1),delete e._attributes[t];var r={};for(var a in e._savedAttributes)r[a]=e._savedAttributes[a];for(var a=0,i=e._savedAttributesIds.length;a<i;a++)for(var s in e._attributes[e._savedAttributesIds[a]])r[s]=e._attributes[e._savedAttributesIds[a]][s];for(var s in r)e.setAttribute(s,r[s])}}function debounce(e,t,i){var r;return function(){var a=this,s=arguments,n=i&&!r;clearTimeout(r),r=setTimeout(function(){r=null,i||e.apply(a,s)},t),n&&e.apply(a,s)}}function SVGParser(e){var t=new DOMParser,i=t.parseFromString(e,'image/svg+xml');return i}function getOffset(e){var t=e.getBoundingClientRect();return{top:t.top,left:t.left}}function setCSS(e,t){var r=e.style;for(var a in t)r[a]=t[a]}function ajaxGet(e){return new Promise(function(t,i){var r=new XMLHttpRequest;r.open(e.type||'GET',e.url,!0),e.json&&r.setRequestHeader('Accept','application/json'),r.onload=function(){if(200===r.status){var a=r.responseText;e.json&&(a=JSON.parse(a)),t(a)}else i(new Error('Request error: '+r.status))},r.onerror=function(){i(new Error('Network error: '+r.status))},r.send()})}var hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,isArray=function(e){return'function'==typeof Array.isArray?Array.isArray(e):'[object Array]'===toStr.call(e)},isPlainObject=function(e){if(!e||'[object Object]'!==toStr.call(e))return!1;var t=hasOwn.call(e,'constructor'),i=e.constructor&&e.constructor.prototype&&hasOwn.call(e.constructor.prototype,'isPrototypeOf');if(e.constructor&&!t&&!i)return!1;for(var r in e);return'undefined'==typeof r||hasOwn.call(e,r)};function extend(){var e=arguments[0],t=1,i=arguments.length,r=!1,a,s,n,o,l,p;for('boolean'==typeof e?(r=e,e=arguments[1]||{},t=2):('object'!=typeof e&&'function'!=typeof e||null==e)&&(e={});t<i;++t)if(a=arguments[t],null!=a)for(s in a)n=e[s],o=a[s],e!==o&&(r&&o&&(isPlainObject(o)||(l=isArray(o)))?(l?(l=!1,p=n&&isArray(n)?n:[]):p=n&&isPlainObject(n)?n:{},e[s]=extend(r,p,o)):'undefined'!=typeof o&&(e[s]=o));return e}var extend$1={};function mix(e,t){for(let i in t)t.hasOwnProperty(i)&&(e.prototype[i]=t[i])}function emptyDom(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function EventEmitter(){}var proto=EventEmitter.prototype;function indexOfListener(e,t){for(var r=e.length;r--;)if(e[r].listener===t)return r;return-1}function alias(e){return function(){return this[e].apply(this,arguments)}}proto.getListeners=function(e){var t=this._getEvents(),i,r;if(e instanceof RegExp)for(r in i={},t)t.hasOwnProperty(r)&&e.test(r)&&(i[r]=t[r]);else i=t[e]||(t[e]=[]);return i},proto.flattenListeners=function(e){var t=[],r;for(r=0;r<e.length;r+=1)t.push(e[r].listener);return t},proto.getListenersAsObject=function(e){var t=this.getListeners(e),i;return t instanceof Array&&(i={},i[e]=t),i||t},proto.addListener=function(e,t){var i=this.getListenersAsObject(e),r;for(r in i)i.hasOwnProperty(r)&&-1===indexOfListener(i[r],t)&&i[r].push('object'==typeof t?t:{listener:t,once:!1});return this},proto.on=alias('addListener'),proto.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},proto.once=alias('addOnceListener'),proto.defineEvent=function(e){return this.getListeners(e),this},proto.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},proto.removeListener=function(e,t){var i=this.getListenersAsObject(e),r,a;for(a in i)i.hasOwnProperty(a)&&(r=indexOfListener(i[a],t),-1!==r&&i[a].splice(r,1));return this},proto.off=alias('removeListener'),proto.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},proto.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},proto.manipulateListeners=function(e,t,r){var a=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners,n,i;if('object'==typeof t&&!(t instanceof RegExp))for(n in t)t.hasOwnProperty(n)&&(i=t[n])&&('function'==typeof i?a.call(this,n,i):s.call(this,n,i));else for(n=r.length;n--;)a.call(this,t,r[n]);return this},proto.removeEvent=function(e){var t=this._getEvents(),i;if('string'==typeof e)delete t[e];else if(e instanceof RegExp)for(i in t)t.hasOwnProperty(i)&&e.test(i)&&delete t[i];else delete this._events;return this},proto.removeAllListeners=alias('removeEvent'),proto.emitEvent=function(e,t){var r=this.getListenersAsObject(e),a,s,i,n;for(i in r)if(r.hasOwnProperty(i))for(s=r[i].length;s--;)a=r[i][s],!0===a.once&&this.removeListener(e,a.listener),n=a.listener.apply(this,t||[]),n===this._getOnceReturnValue()&&this.removeListener(e,a.listener);return this},proto.trigger=alias('emitEvent'),proto.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},proto.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},proto._getOnceReturnValue=function(){return!this.hasOwnProperty('_onceReturnValue')||this._onceReturnValue},proto._getEvents=function(){return this._events||(this._events={})};class FitHost{constructor(e){this.DELTAP=1e-6,this.BIGVAL=9e99,this.WEIGHT=1,this.setYData(e.dataY),this.setXData(e.dataX),this.setWeight(e.weight),this.setInitialParams(e.params),e.subsetIndex&&this.setSubset(...e.subsetIndex),this.setFunction(e.function),e.progress&&this.hookIteration(e.progress),this.options=e}setYData(e){this.data=e}setXData(e){this.dataX=e}setWeight(e){this.weight=e}setInitialParams(e){this.parms=e,this.parms=this.parms.map((e)=>'function'==typeof e?e(this.data,this.dataX):e),this.NPARMS=e.length}setSubset(e,t){e!==void 0&&t!==void 0&&(this._from=e,this._to=t)}hookIteration(e){this._hookIteration=(t)=>{let i=this.buildFit(t,200);e(i)}}setFunction(e){this._func=e}init(){if(void 0!==this._from&&void 0!==this._to){if(this._from>=this._to)throw'Impossible to fit negative subranges. The starting index must be lower than the ending index';if(this.NPTS=this._to-this._from+1,this.data&&this.data.getLength()<=this._to)throw'Wave Y has not enough point to be fitted to subrange ['+this._from+', '+this._to+']';if(0>this._from)throw'Impossible to fit a subrange with negative indices'}else this.NPTS=this.data.getLength(),this._from=0,this._to=this.data.getLength()-1;if(this.dataX&&this.dataX.getLength()<=this._to)throw'Wave X has not enough point to be fitted to subrange ['+this._from+', '+this._to+']';this.arrY=this.data.getDataY(),this.arrX=this.dataX?this.dataX.getDataY():this.data.getDataX(),this.resid=Array(this.NPTS).fill(0),this.jac=Array(this.NPTS).fill(0),this.jac=this.jac.map(()=>Array(this.NPARMS))}fit(){return this.log('Starting the fit with initial parameter list {'+this.parms.join()+'};'),new LM(this,this.NPARMS,this.NPTS,this._hookIteration),this.log('Fit successful. Output parameters {'+this.parms.join()+'};'),this._result=this.buildFit(this.parms,200),this.options.done&&this.options.done(this.parms,this._result),this._result}func(e,t){return this._func(e,t)}computeResiduals(){for(var e=0,t=0;t<this.NPTS;t++)this.resid[t]=(this.func(this.arrX[t+this._from],this.parms)-this.arrY[t+this._from])*this.WEIGHT,e+=this.resid[t]*this.resid[t];return e}log(e){this.options.log&&console.log(e)}nudge(e){for(var t=0;t<this.NPARMS;t++)this.parms[t]+=e[t];return this.computeResiduals()}buildJacobian(){for(var e=Array(this.NPARMS),t=0.5/this.DELTAP,r=0,a=0;a<this.NPARMS;a++){for(var s=0;s<this.NPARMS;s++)e[s]=s==a?this.DELTAP:0;if(r=this.nudge(e),r==this.BIGVAL)throw'Bad dBuildJacobian() exit 2';for(var n=0;n<this.NPTS;n++)this.jac[n][a]=this.getResidualElement(n);for(var s=0;s<this.NPARMS;s++)e[s]=s==a?-2*this.DELTAP:0;if(r=this.nudge(e),r==this.BIGVAL)throw'Bad dBuildJacobian(). exit 3';for(var n=0;n<this.NPTS;n++)this.jac[n][a]-=this.getResidualElement(n);for(var n=0;n<this.NPTS;n++)this.jac[n][a]*=t;for(var s=0;s<this.NPARMS;s++)e[s]=s==a?this.DELTAP:0;if(r=this.nudge(e),r==this.BIGVAL)throw'Bad dBuildJacobian(). exit 4'}return!0}getResidualElement(e){return this.resid[e]}getJacobianElement(e,t){return this.jac[e][t]}buildFit(e,t){let r;if(!t)r=this.arrX;else{const e=this.dataX.getMin(this._from,this._to),i=this.dataX.getMax(this._from,this._to);r=Array(t).fill(0).map((r,a)=>a*(i-e)/(t-1)+e)}for(var a=Array(r.length),s=0,i=r.length;s<i;s++)a[s]=this.func(r[s],this.parms);let n=this.options.waveform;return n.setData(a,r),n}}class LM{constructor(e,t,i,r){this.LMITER=100,this.LMBOOST=2,this.LMSHRINK=0.1,this.LAMBDAZERO=1e-3,this.LAMBDAMAX=1E9,this.LMTOL=1e-12,this.BIGVAL=9e99,this.sos,this.sosprev,this.lambda,this.myH=null,this.nadj=0,this.npts=0,this.delta,this.beta,this.alpha,this.amatrix,this.myH=e,this.nadj=t,this.npts=i,this.delta=Array(this.nadj).fill(0),this.beta=Array(this.nadj).fill(0),this.alpha=Array(this.nadj).fill(0),this.amatrix=Array(this.nadj).fill(0),this.alpha=this.alpha.map(()=>Array(this.nadj)),this.amatrix=this.amatrix.map(()=>Array(this.nadj)),this.lambda=this.LAMBDAZERO;var a=0,s=!1;do s=this.bLMiter(),r&&r(this.myH.params),a++;while(!s&&a<this.LMITER)}bLMiter(){for(var e=0;e<this.nadj;e++)this.delta[e]=0;if(this.sos=this.myH.nudge(this.delta),this.sos==this.BIGVAL)return console.error('  bLMiter finds faulty initial nudge()'),!1;if(this.sosprev=this.sos,this.myH.log('  bLMiter..SumOfSquares= '+this.sos),!this.myH.buildJacobian())return console.error('  bLMiter finds buildJacobian()=false'),!1;for(var e=0;e<this.nadj;e++){this.beta[e]=0;for(var t=0;t<this.npts;t++)this.beta[e]-=this.myH.getResidualElement(t)*this.myH.getJacobianElement(t,e)}for(var e=0;e<this.nadj;e++)for(var i=0;i<this.nadj;i++){this.alpha[i][e]=0;for(var t=0;t<this.npts;t++)this.alpha[i][e]+=this.myH.getJacobianElement(t,i)*this.myH.getJacobianElement(t,e)}var r=0;do{for(var e=0;e<this.nadj;e++)for(var i=0;i<this.nadj;i++)this.amatrix[i][e]=this.alpha[i][e]+(i==e?this.lambda:0);this.gaussj(this.amatrix,this.nadj);for(var e=0;e<this.nadj;e++){this.delta[e]=0;for(var i=0;i<this.nadj;i++)this.delta[e]+=this.amatrix[i][e]*this.beta[i]}if(this.sos=this.myH.nudge(this.delta),this.sos==this.BIGVAL)return console.error('  LMinner failed SOS step'),!1;if(r=(this.sos-this.sosprev)/(1+this.sos),0>=r){this.lambda*=this.LMSHRINK;break}for(var a=0;a<this.nadj;a++)this.delta[a]*=-1;if(this.myH.nudge(this.delta),r<this.LMTOL)break;this.lambda*=this.LMBOOST}while(this.lambda<this.LAMBDAMAX);return r>-this.LMTOL||this.lambda>this.LAMBDAMAX}gaussj(e,t){var r=Math.abs,a=1,s=Array(100),n=Array(100),o,l,p,i,d,g;for(d=0;d<t;d++){for(o=0,p=d;p<t;p++)for(i=d;i<t;i++)r(o)<=r(e[p][i])&&(o=e[p][i],s[d]=p,n[d]=i);if(0==o)return 0;if(p=s[d],p>d)for(i=0;i<t;i++)l=e[d][i],e[d][i]=e[p][i],e[p][i]=-l;if(i=n[d],i>d)for(p=0;p<t;p++)l=e[p][d],e[p][d]=e[p][i],e[p][i]=-l;for(p=0;p<t;p++)p!=d&&(e[p][d]=-e[p][d]/o);for(p=0;p<t;p++)for(i=0;i<t;i++)p!=d&&i!=d&&(e[p][i]+=e[p][d]*e[d][i]);for(i=0;i<t;i++)i!=d&&(e[d][i]/=o);e[d][d]=1/o,a*=o}for(g=0;g<t;g++){if(d=t-g-1,i=s[d],i>d)for(p=0;p<t;p++)l=e[p][d],e[p][d]=-e[p][i],e[p][i]=l;if(p=n[d],p>d)for(i=0;i<t;i++)l=e[d][i],e[d][i]=-e[p][i],e[p][i]=l}return a}}class Waveform{constructor(e=[],t=0,i=1){this.xOffset=t,this.xScale=i,this.errors={nb:0,bars:{above:null,below:null},boxes:{above:null,below:null}},this.BELOW=Waveform.BELOW,this.ABOVE=Waveform.ABOVE,this.BOX=Waveform.BOX,this.BAR=Waveform.BAR,this.setData(e)}setData(e,t=null){if(Array.isArray(e[0])){let t=[],i=[];e.forEach((e)=>{t.push(e[0]),i.push(e[1])}),this.setXWaveform(t),e=i}let i=this._makeArray(e.length),r=!1;const a=this.isNaNAllowed();return e.map((e,t)=>{a||e[0]===e[0]&&e[1]===e[1]||(r=!0),i[t]=e}),r&&this.warn('Trying to assign NaN values to a typed array that does not support NaNs. 0\'s will be used instead'),this._setData(i),t&&this.setXWaveform(t),this}getY(e,t){return t&&this.dataInUse?this.dataInUse.y[e]*this.getScale()+this.getShift():this.data[e]*this.getScale()+this.getShift()}setXWaveform(e){if(!(e instanceof Waveform))if(Array.isArray(e))e=new Waveform(e);else throw'Cannot set X waveform. Data is not a valid array.';return this.xdata=e,this.computeXMinMax(),this}hasXWaveform(){return!!this.xdata}getXWaveform(){if(this.xdata)return this.xdata;for(var e=new Waveform,t=0;t<this.getLength();t+=1)e.append(this.getX(t));return e}rescaleX(e,t){return this.xScale=t,this.xOffset=e,this.computeXMinMax(),this}getTypedArrayClass(){return this._typedArrayClass||!1}setTypedArrayClass(e){this.getTypedArrayClass()&&this.isNaNAllowed()&&!this.isNaNAllowed(e)&&this.warn('NaN values are not allowed by the new constructor ('+e.name+') while it was allowed by the previous one ('+this._typedArrayClass.name+')'),this.getTypedArrayClass()&&this.isUnsigned()&&!this.isUnsigned(e)&&this.warn('You are switching from signed values to unsigned values. You may experience data corruption if there were some negative values.'),this._typedArrayClass=e,this.data&&this._setData(e.from(this.data)),this.hasXWaveform()&&this.getXWaveform().setTypedArrayClass(e)}isNaNAllowed(e=this._typedArrayClass){return e==Array||e==Float32Array||e==Float64Array}isUnsigned(e=this._typedArrayClass){return e==Uint8Array||e==Uint8ClampedArray||e==Uint16Array||e==Uint32Array}recalculateMinMaxNewPoint(e,t){(e<this.minX||this.minX===void 0)&&(this.minX=e),(e>this.maxX||this.maxX===void 0)&&(this.maxX=e),(t<this.minY||this.minY===void 0)&&(this.minY=t),(t>this.maxY||this.maxY===void 0)&&(this.maxY=t)}prepend(e,t){return'function'==typeof e&&(e=e(this)),'function'==typeof t&&(t=t(this)),this.xdata?this.xdata.prepend(null,e):null===e?this.xOffset-=this.xScale:(this.xdata=this.getXWaveform(),this.xdata.prepend(null,e)),this.data.unshift(t),this.recalculateMinMaxNewPoint(e,t),this}append(e,t){return'function'==typeof e&&(e=e(this)),'function'==typeof t&&(t=t(this)),this.xdata?this.xdata.append(null,e):null!==e&&(this.xdata=this.getXWaveform(),this.xdata.append(null,e)),this.monotoneous&&(t>this.data[this.data.y]&&!1===this.getMonotoneousAscending()?this.monotoneous=!1:t<this.data[this.data.y]&&!0===this.getMonotoneousAscending()&&(this.monotoneous=!1)),(1==this.data.length||void 0===this._monotoneousAscending)&&(this.monotoneous=!0,this._monotoneousAscending=t==this.data[0]?void 0:t>this.data[0]),this.data.push(t),this.recalculateMinMaxNewPoint(e,t),this}_makeArray(e){const t=this.getTypedArrayClass();return t?new t(e):Array(e)}_setData(e){var t=Math.max,r=Math.min,a=Number.MAX_VALUE;const s=e.length;let n=1,i=e[1]>e[0],o=e[0],l=e[0];for(isNaN(o)&&(o=a),isNaN(l)&&(l=-a),this._monotoneous=!0;n<s;n++)e[n]!==e[n-1]&&i!=e[n]>e[n-1]&&(this._monotoneous=!1),e[n]===e[n]&&(o=r(e[n],o),l=t(e[n],l));if(this._monotoneous&&(this._monotoneousAscending=e[1]>e[0]),this.hasErrorBars()){for(n=0;n<s;n++)e[n]===e[n]&&(o=r(o,e[n]-this.getMaxError(n,'below')),l=t(l,e[n]+this.getMaxError(n,'above')));this.minY=o,this.maxY=l}else this.minY=o,this.maxY=l;this.data=e,this.computeXMinMax()}computeXMinMax(){if(this.data)if(this.xdata)this.minX=this.xdata.getMin(),this.maxX=this.xdata.getMax();else{const e=this.xOffset+this.xScale*this.getLength(),t=this.xOffset;this.minX=Math.min(e,t),this.maxX=Math.max(e,t)}}getDataInUse(){return this.dataInUse||this.data}getIndexFromVal(e,t=!1,i=Math.round){let r=t&&this.dataInUse?this.dataInUse.y:this.data;let a;return a=this.getIndexFromData(e,r,this.data.getMonotoneousAscending(),i),t&&this.dataInUse&&'aggregateY'==this.dataInUseType?a-a%4:a}getIndexFromX(e,t=!1,i=Math.round){let r;t&&this.dataInUse?r=this.dataInUse.x:this.xdata&&(r=this.xdata.getData());let a;return a=this.hasXWaveform()?this.xdata.getIndexFromData(e,r,this.xdata.getMonotoneousAscending(),i):Math.max(0,Math.min(this.getLength()-1,i((e-this.xOffset)/this.xScale))),t&&this.dataInUse&&'aggregateX'==this.dataInUseType?a-a%4:a}getIndexFromXY(e,t,i=!1,r=Math.round,a,s){let n,o;i&&this.dataInUse?(n=this.dataInUse.x,o=this.dataInUse.y):this.xdata&&(n=this.xdata.data,o=this.data);let l;if(this.isXMonotoneous())l=this.hasXWaveform()?this.xdata.getIndexFromData(e,n,this.xdata.getMonotoneousAscending(),r):Math.max(0,Math.min(this.getLength()-1,r((e-this.xOffset)/this.xScale)));else if(!isNaN(t))l=this.getIndexFromDataXY(e,n,t,o,a,s);else return;return i&&this.dataInUse&&'aggregateX'==this.dataInUseType?l-l%4:l}getIndexFromDataXY(e,t,i,r,a=1,s=1){return e-=this.getXShift(),e/=this.getXScale(),i-=this.getShift(),i/=this.getScale(),euclidianSearch(e,i,t,r,a,s)}getIndexFromData(e,t,i){if(!this.isMonotoneous())throw console.trace(),'Impossible to get the index from a non-monotoneous wave !';return e-=this.getShift(),e/=this.getScale(),binarySearch(e,t,!i)}getReductionType(){return this.dataInUseType}getXMin(){return this.minX*this.getXScale()+this.getXShift()}getXMax(){return this.maxX*this.getXScale()+this.getXShift()}getYMin(){return this.minY*this.getScale()+this.getShift()}getYMax(){return this.maxY*this.getScale()+this.getShift()}getMin(){return this.minY*this.getScale()+this.getShift()}getMax(){return this.maxY*this.getScale()+this.getShift()}getMinX(){return this.minX*this.getXScale()+this.getXShift()}getMaxX(){return this.maxX*this.getXScale()+this.getXShift()}getMinY(){return this.minY*this.getScale()+this.getShift()}getMaxY(){return this.maxY*this.getScale()+this.getShift()}getDataMaxX(){return this.maxX}getDataMinX(){return this.minX}getDataMaxY(){return this.maxY}getDataMaxY(){return this.minY}getDataY(){return this.data}getData(e){return e&&this.dataInUse?this.dataInUse.y:this.data}setShift(e=0){return this.shift=e,this}getShift(){return this.shift||0}getScale(){return this.scale||1}setScale(e=1){return this.scale=e,this}setXShift(e=0){return this.hasXWaveform?(this.getXWaveform().setShift(e),this):this}getXShift(e=0){return this.hasXWaveform?this.getXWaveform().getShift():0}setXScale(e=1){return this.hasXWaveform?(this.getXWaveform().setScale(e),this):this}getXScale(){return this.hasXWaveform?this.getXWaveform().getScale():1}getLength(){return this.data.length}getDataToUseFlat(){let e=0,t,r;if(this.dataInUse){t=this.dataInUse.x.length,r=Array(2*t).fill(0);for(var a=0;a<t;a+=1)r[e]=this.dataInUse.x[a],r[e+1]=this.dataInUse.y[a],e+=2}else{t=this.getLength(),r=Array(2*t).fill(0);for(var a=0;a<t;a+=1)r[e+1]=this.data[a],r[e]=this.getX(a),e+=2}return r}fit(e){var t=this;return new Promise(function(i){var r=new FitHost(extend$1({},{dataY:t,dataX:t.getXWaveform(),done:function(e){i(e)},waveform:new Waveform},e));r.init(),r.fit()})}getX(e,t){return t&&this.dataInUse?this.dataInUse.x[e]*this.getXScale()+this.getXShift():this.xdata?this.xdata.data[e]*this.getXScale()+this.getXShift():this.xOffset+e*this.xScale}getXRaw(e,t){return t&&this.dataInUse?this.dataInUse.x[e]:this.xdata?this.xdata.data[e]:e}_integrateP(e=0,t=this.getLength()-1){var i=Math.round;if(e=i(e),t=i(t),e>t){let i=e;e=t,t=i}var r=t-e+1,a=0;let s=0,n;for(var o=this.getData();e<=t;e++)o.length-1>e&&(n=this.getX(e+1)-this.getX(e),s+=n,a+=o[e]*n);return[a,r,s]}integrateP(e,t){var i=this._integrateP(e,t);return i[0]}integrate(e,t){return this.integrateP(this.getIndexFromX(e),this.getIndexFromX(t))}average(e=0,t=this.getLength()-1){return this.getAverageP(e,t)}mean(){return this.average()}getAverageP(e,t){var i=this._integrateP(e,t);return i[0]/i[2]}getAverageX(e,t){var i=this._integrateX(e,t);return i[0]/i[2]}checkMonotonicity(){let e=1,t=this.getData();const i=this.data.length;for(let r=t[1]>t[0];e<i;e++)if(t[e]!==t[e-1]&&r!=t[e]>t[e-1])return this._monotoneous=!1;return this._monotoneousAscending=t[1]>t[0],this._monotoneous=!0}requireXMonotonicity(){this.xdata&&this.xdata.requireMonotonicity()}requireMonotonicity(){if(!this.isMonotoneous())throw'The wave must be monotonic'}isMonotoneous(){return!!this._monotoneous}isXMonotoneous(){return!this.xdata||this.xdata.isMonotoneous()}invert(){let e=dataY||this.data;return e.reverse(),this.isMonotoneous()&&(this._monotoneousAscending=!this._monotoneousAscending),e}resampleForDisplay(e){let t=0;this.requireXMonotonicity();let i=!1,r=this.getDataY(),a={x:[],y:[]},s=[],n=!1,o=0,p,d,g,c,u,h,x,m;const y=this.getLength();if(!e.xPosition)throw'No position calculation method provided';if(!e.resampleToPx)throw'No "resampleToPx" method was provided. Unit: px per point';if(e.minX>e.maxX){let t=e.minX;e.minX=e.maxX,e.maxX=t}for((this.xdata&&!this.xdata.getMonotoneousAscending()||!this.xdata&&-0>this.xScale)&&(i=!0,t=y);i?0<t:t<y;i?t--:t++){if(m=this.getX(t),e.minX>m){o=t;continue}if(x=e.xPosition(m),!n){for(o?(a.x.push(m),a.y.push(r[o])):o=t;isNaN(r[t]);)i?t--:t++;p=d=g=r[o],c=1,h=x,u=m,o=0,n=!0;continue}if(Math.abs(x-h)>e.resampleToPx||t==y||0==t||isNaN(r[t])){let t=(u+m)/2;if(a.x.push(t),a.y.push(p/c),s.push(t,d,g),void 0!==e.maxX&&m>e.maxX)break;n=!1;continue}p+=r[t],c++,d=Math.min(d,r[t]),g=Math.max(g,r[t])}return this.dataInUseType='resampled',this.dataInUse=a,s}interpolate(e){let t=this.getDataY(),i;if(this.xdata){let r=this.xdata.getData();try{i=binarySearch(e,r,!this.xdata.getMonotoneousAscending())}catch(t){return NaN}return r[i]==e?t[i]:(e-r[i])/(r[i+1]-r[i])*(t[i+1]-t[i])+t[i]}else{i=(e-this.xOffset)/this.xScale;let r=Math.floor(i);return(i-r)*(t[r+1]-t[r])+t[r]}}interpolateIndex_X(e){this.getDataY();if(this.xdata){let t=this.xdata.getData(),i=Math.floor(e);return(e-i)*(t[i+1]-t[i])+t[i]}}getMonotoneousAscending(){return this.isMonotoneous()?this._monotoneousAscending:'The waveform is not monotoneous'}getXMonotoneousAscending(){return this.xdata?this.xdata.getMonotoneousAscending():0<this.xScale}isXMonotoneousAscending(){return this.getXMonotoneousAscending(...arguments)}divide(e){return this._arithmetic(e,DIVIDE)}divideBy(){return this.divide(...arguments)}multiply(e){return this._arithmetic(e,MULTIPLY)}multiplyBy(){return this.multiply(...arguments)}log(){return this.logBase(10)}ln(){return this.logBase(Math.E)}logBase(e){var t=Math.log;let i=t(e);this.data.map((e)=>t(e)/i)}add(e){return this._arithmetic(e,ADD)}addBy(){return this.add(...arguments)}subtract(e){return this._arithmetic(e,SUBTRACT)}subtractBy(){return this.subtract(...arguments)}math(e){for(var t=0;t<this.getLength();t++)this.data[t]=e(this.getY(t),this.getX(t));return this._setData(this.data),this}_arithmetic(e,t){if(e instanceof Waveform)return this._waveArithmetic(e,t);return'number'==typeof e?this._numberArithmetic(e,t):void 0}_numberArithmetic(e,t){let r=0,i=this.getLength();if(t==MULTIPLY){for(;r<i;r++)this.data[r]*=e;this.minY*=e,this.maxY*=e}else if(t==DIVIDE){for(;r<i;r++)this.data[r]/=e;this.minY/=e,this.maxY/=e}else if(t==ADD){for(;r<i;r++)this.data[r]+=e;this.minY+=e,this.maxY+=e}else if(t==SUBTRACT){for(;r<i;r++)this.data[r]-=e;this.minY-=e,this.maxY-=e}return this}_waveArithmetic(e,t){let r=this.getDataY(),a=0;const i=this.getLength();if(this.requireXMonotonicity(),e.requireXMonotonicity(),t==MULTIPLY)for(;a<i;a++)r[a]*=e.interpolate(this.getX(a));else if(t==DIVIDE)for(;a<i;a++)r[a]/=e.interpolate(this.getX(a));else if(t==ADD)for(;a<i;a++)r[a]+=e.interpolate(this.getX(a));else if(t==SUBTRACT)for(;a<i;a++)r[a]-=e.interpolate(this.getX(a));return this._setData(r),this}aggregate(e='x'){this._dataAggregating={},this._dataAggregated={},this._dataAggregationDirection=e.toUpperCase();var t=pow2floor(this.getLength());this._dataAggregating=aggregator({minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,data:this.data,xdata:this.xdata?this.xdata.getData():void 0,xScale:this.xScale,xOffset:this.xOffset,numPoints:t,direction:e}).then((e)=>{this._dataAggregated=e.aggregates,this._dataAggregating=!1})}hasAggregation(){return!!this._dataAggregated}selectAggregatedData(e){if(2>e)return!1;var t=pow2ceil(e);return this._dataAggregated[t]?(this.dataInUseType='aggregate'+this._dataAggregationDirection,void(this.dataInUse=this._dataAggregated[t])):this._dataAggregating?this._dataAggregating:void(this.dataInUseType='none',this.dataInUse={y:this.data,x:this.getXWaveform().data})}duplicate(e){var t=new Waveform;return t._setData(this.getDataY().slice()),t.rescaleX(this.xOffset,this.xShift),t.setShift(this.getShift()),t.setScale(this.getScale()),this.xdata?(e?t.setXWaveform(this.xdata.duplicate()):t.setXWaveform(this.xdata),t.setXShift(this.getXShift()),t.setXScale(this.getXScale())):(t.xOffset=this.xOffset,t.xScale=this.xScale),t}subrangeX(e,t){if(!this.xdata){let t=this.getIndexFromX(e),i=this.getIndexFromX(i);return new Waveform().setData(this.data.slice(t,i)).rescaleX(this.xOffset,this.xScale)}for(var r=new Waveform,a=0,i=this.data.length;a<i;a++)this.data[a]>=e&&this.data[a]<t&&r.append(this.dataX[a],this.data[a]);return r}findLocalMinMax(e,t,i){let r=this.getIndexFromX(e),a=this.getIndexFromX(e+t),s=this.getIndexFromX(e-t);return this.findLocalMinMaxIndex(s,a,i)}findLocalMinMaxIndex(e,t,r){let a;t<e&&(a=t,t=e,e=a);let s,n;if('max'==r){s=Number.NEGATIVE_INFINITY;for(var o=e;o<=t;o++)this.getY(o)>s&&(s=this.getY(o),n=o)}else{s=Number.POSITIVE_INFINITY;for(var o=e;o<=t;o++)this.getY(o)<s&&(s=this.getY(o),n=o)}return n==e||n==t?!1:this.getX(n)}warn(e){console&&console.warn(e)}setUnit(e){return this.unit=e,this}setXUnit(e){return this.hasXWaveform()&&this.xdata.setUnit(e),this.xunit=e,this}getUnit(){return this.unit||''}getXUnit(){return this.hasXWaveform()?this.xdata.getUnit():''|this.xunit}hasXUnit(){return 0<this.getXUnit().length}hasUnit(){return 0<this.getUnit().length}findLevels(e,t){t=extend$1({box:1,edge:'both',rounding:'before',rangeP:[0,this.getLength()]},t);for(var r=t.rangeP[0],a=[],s=0,i;i=this.findLevel(e,extend$1(!0,{},t,{rangeP:[r,t.rangeP[1]]}));)if(a.push(i),r=Math.ceil(i),s++,1e3<s)return;return a}findLevel(e,t){t=extend$1({box:1,edge:'both',direction:'ascending',rounding:'before',rangeP:[0,this.getLength()]},t),t.rangeX&&(t.rangeP=t.rangeX.map(this.getIndexFromX));var r=t.box,a,s,n,i,o,l;for(0==r%2&&r++,'descending'==t.direction?(n=t.rangeP[1],o=t.rangeP[0],l=-1):(n=t.rangeP[0],o=t.rangeP[1],l=1);;n+=l){if('descending'==t.direction){if(n<o)break;}else if(n>o)break;if(!(n<t.rangeP[0]+(r-1)/2)){if(n>t.rangeP[1]-(r-1)/2)break;if(a=this.getAverageP(n-(r-1)/2,n+(r-1)/2),void 0==s){s=a<e;continue}if(a>=e&&s){if(s=!1,'ascending'==t.edge||'both'==t.edge)for(i=n+(r-1)/2;i>=n-(r-1)/2;i--)if(this.data[i]>=e&&this.data[i-1]<=e)switch(t.rounding){case'before':return i-1;break;case'after':return i;break;case'interpolate':return getIndexInterpolate(e,this.data[i],this.data[i-1],i,i-1);}}else if(a<=e&&!s&&(s=!0,'descending'==t.edge||'both'==t.edge))for(i=n+(r-1)/2;i>=n-(r-1)/2;i--)if(this.data[i]<=e&&this.data[i-1]>=e)switch(t.rounding){case'before':return i-1;break;case'after':return i;break;case'interpolate':return getIndexInterpolate(e,this.data[i],this.data[i-1],i,i-1);}}}}normalize(e){let t,r,a,s,n,o;if('max1'==e||'max100'==e){for(t=1,'max100'==e&&(t=100),s=this.data[0],o=1;o<this.getLength();o++)this.data[o]>s&&(s=this.data[o]);for(o=0;o<this.getLength();o++)this.data[o]/=s/t}else if('sum1'==e){for(r=0,o=0;o<this.getLength();o++)r+=this.data[o];for(o=0;o<this.getLength();o++)this.data[o]/=r}else if('max1min0'==e){for(s=this.data[0],a=this.data[0],o=1;o<this.getLength();o++)this.data[o]>s?s=this.data[o]:this.data[o]<a&&(a=this.data[o]);for(n=1/(s-a),o=0;o<this.getLength();o++)this.data[o]=(this.data[o]-a)*n}this.setData(this.data)}setErrorBarX(e){Array.isArray(e)&&(e=new Waveform(e));var t=this.getXWaveform();return t.setErrorBar(e),this}setErrorBarXBelow(e){Array.isArray(e)&&(e=new Waveform(e));var t=this.getXWaveform();return t.setErrorBarBelow(e),this}setErrorBarXAbove(e){Array.isArray(e)&&(e=new Waveform(e));var t=this.getXWaveform();return t.setErrorBarAbove(e),this}setErrorBoxX(e){Array.isArray(e)&&(e=new Waveform(e));var t=this.getXWaveform();return t.setErrorBoxAbove(e),t.setErrorBoxBelow(e),this}setErrorBoxXBelow(e){Array.isArray(e)&&(e=new Waveform(e));var t=this.getXWaveform();return t.setErrorBoxBelow(e),this}setErrorBoxXAbove(e){Array.isArray(e)&&(e=new Waveform(e));var t=this.getXWaveform();return t.setErrorBoxAbove(e),this}setErrorBar(e,t=!0){Array.isArray(e)&&(e=new Waveform(e)),this.errors.nb++,this.errors.nb++,this.errors.bars.bottom=e,this.errors.bars.top=e,t&&this._setData()}setErrorBarBelow(e,t=!0){Array.isArray(e)&&(e=new Waveform(e)),this.errors.nb++,this.errors.bars.below=e,t&&this._setData()}setErrorBarAbove(e,t=!0){Array.isArray(e)&&(e=new Waveform(e)),this.errors.nb++,this.errors.bars.above=e,t&&this._setData()}setErrorBox(e,t=!0){Array.isArray(e)&&(e=new Waveform(e)),this.errors.nb++,this.errors.nb++,this.errors.boxes.above=e,this.errors.boxes.below=e,t&&this._setData()}setErrorBoxBelow(e,t=!0){Array.isArray(e)&&(e=new Waveform(e)),this.errors.nb++,this.errors.boxes.below=e,t&&this._setData()}setErrorBoxAbove(e,t=!0){Array.isArray(e)&&(e=new Waveform(e)),this.errors.boxes.above=e,t&&this._setData()}getMaxError(e,t=Waveform.ABOVE){return Math.max(this.getMaxErrorType(e,t,Waveform.BOX),this.getMaxErrorType(e,t,Waveform.BAR))}getMaxErrorType(e,t=Waveform.ABOVE,i=Waveform.BOX){let r;if(i==Waveform.BOX)r=this.errors.boxes;else if(i==Waveform.BAR)r=this.errors.bars;else throw'Unknown type of error';let a;return(a=r[t])||(t==Waveform.ABOVE?r[t]==Waveform.BELOW&&(a=r.below):r[t]==Waveform.ABOVE&&(a=r.above)),a?a.getY(e):0}getErrorBarXBelow(e){return this.getErrorX(e,Waveform.BELOW,Waveform.BAR)}getErrorBarXAbove(e){return this.getErrorX(e,Waveform.ABOVE,Waveform.BAR)}getErrorBoxXBelow(e){return this.getErrorX(e,Waveform.BELOW,Waveform.BOX)}getErrorBoxXAbove(e){return this.getErrorX(e,Waveform.ABOVE,Waveform.BOX)}getErrorBarYBelow(e){return this.getError(e,Waveform.BELOW,Waveform.BAR)}getErrorBarYAbove(e){return this.getError(e,Waveform.ABOVE,Waveform.BAR)}getErrorBoxYBelow(e){return this.getError(e,Waveform.BELOW,Waveform.BOX)}getErrorBoxYAbove(e){return this.getError(e,Waveform.ABOVE,Waveform.BOX)}getErrorX(e,t=Waveform.ABOVE,i=Waveform.BAR){return!!this.hasXWaveform()&&this.xdata.getError(e,t,i)}getError(e,t=Waveform.ABOVE,i=Waveform.BAR){let r=i==Waveform.BAR?this.errors.bars:this.errors.boxes;if(!r)return!1;let a;if(a=t==Waveform.ABOVE?r.above:r.below)return a==Waveform.ABOVE&&t==Waveform.BELOW?a=r.above:a==Waveform.BELOW&&t==Waveform.ABOVE&&(a=r.below),!!a&&a.getY(e)}hasErrorBars(){return 0<this.errors.nb||this.hasXWaveform()&&0<this.xdata.errors.nb}}Waveform.BELOW=Symbol(),Waveform.ABOVE=Symbol(),Waveform.BOX=Symbol(),Waveform.BAR=Symbol();const MULTIPLY=Symbol(),ADD=Symbol(),SUBTRACT=Symbol(),DIVIDE=Symbol();function pow2ceil(e){e--;for(var t=2;e>>=1;)t<<=1;return t}function pow2floor(e){for(var t=1;e>>=1;)t<<=1;return t}function getIndexInterpolate(e,t,i,r,a){return(e-t)/(i-t)*(a-r)+r}function euclidianSearch(e,t,r,a,s=1,n=1){var o=Math.pow;let p=Number.MAX_VALUE,d=-1,g;for(var c=0,i=r.length;c<i;c++)g=o((e-r[c])*s,2)+o((t-a[c])*n,2),g<p&&(d=c,p=g);return d}function binarySearch(e,t,r=t[t.length-1]<t[0]){let a=0,s=t.length,n=s-1,o=0,i=1,l;if(!r&&(t[0]>e||t[n]<e)||r&&(t[0]<e||t[n]>e))throw new Error(`Target ${e} is not in the stack`);if(t[a]==e)return a;if(t[n]==e)return n;for(;;){if(o++,100<o)throw new Error('Error loop');for(l=Math.floor((a+n)/2);isNaN(t[l]);){if(l>=t.length-1)return t.length-1;if(0>=l)return 0;l+=i}if(l==a||t[l]==e||l==n)return l;if(t[l]<e)r?n=l:a=l;else if(t[l]>e)r?a=l:n=l;else return!1;i*=-1}}const GraphOptionsDefault={title:'',paddingTop:30,paddingBottom:5,paddingLeft:20,paddingRight:20,close:{left:!0,right:!0,top:!0,bottom:!0},closeColor:'black',fontSize:12,fontFamily:'Myriad Pro, Helvetica, Arial',plugins:{},pluginAction:{},mouseActions:[],keyActions:[],wheel:{},dblclick:{},shapesUnselectOnClick:!0,shapesUniqueSelection:!0},defaultScatterStyle={shape:'circle',r:4};var _constructors=new Map;class Graph$1 extends EventEmitter{constructor(e,t,r){for(var a in super(),this._creation=guid(),this._drawn=!1,e!==Object(e)||e instanceof HTMLElement?'string'==typeof e?e=document.getElementById(e):'number'==typeof e.length&&(e=e[0]):(r=t,t=e,e=null),this.options=extend({},GraphOptionsDefault,t),doDom.bind(this)(),e&&this.setWrapper(e),this.prevented=!1,this.axis={left:[],top:[],bottom:[],right:[]},this.shapes=[],this.shapesLocked=!1,this.plugins={},this.options.pluginAction)this.options.pluginAction.plugin=a,this.options.mouseActions.push(this.options.pluginAction);if(this.selectedShapes=[],this.series=[],this._axesHaveChanged=!0,this.options.hasOwnProperty('padding')&&isNumeric$1(this.options.padding)&&(this.options.paddingTop=this.options.paddingBottom=this.options.paddingLeft=this.options.paddingRight=this.options.padding),this.currentAction=!1,this.ns=Graph$1.ns,this.nsxlink=Graph$1.nsxlink,r)for(var a in r)for(var i=0,s=r[a].length;i<s;i++)switch(a){case'top':this.getTopAxis(i,r[a][i]);break;case'left':this.getLeftAxis(i,r[a][i]);break;case'right':this.getRightAxis(i,r[a][i]);break;case'bottom':this.getBottomAxis(i,r[a][i]);break;default:}this._pluginsInit()}setWrapper(e){if(!e)throw new Error('The wrapper DOM element was not found.');if(!e.appendChild)throw new Error('The wrapper appears to be an invalid HTMLElement');if(e.style['-webkit-user-select']='none',e.style['-moz-user-select']='none',e.style['-o-user-select']='none',e.style['-ms-user-select']='none',e.style['user-select']='none',e.style.position='relative',e.style.outline='none',this.wrapper=e,!this.height||!this.width){var t=getComputedStyle(e),i=parseInt(t.width,10),r=parseInt(t.height,10);this.setSize(i,r),this._resize()}e.appendChild(this.dom),_registerEvents(this)}getDom(){return this.dom}getId(){return this._creation}getWrapper(){return this.wrapper}setOption(e,t){return this.options[e]=t,this}setTitle(e){this.options.title=e,this.domTitle.textContent=e}displayTitle(){this.domTitle.setAttribute('display','inline')}hideTitle(){this.domTitle.setAttribute('display','none')}hide(){'none'!==this.dom.style.display&&(this.dom.style.display='none')}show(){'none'==this.dom.style.display&&(this.dom.style.display='initial')}redraw(e,t){if(this.width&&this.height)return this.sizeSet?!e||t||haveAxesChanged(this)||hasSizeChanged(this)?(this.executeRedrawSlaves(),refreshDrawingZone(this),!0):(this.executeRedrawSlaves(!0),!1):(this._resize(),this.executeRedrawSlaves(),!0)}executeRedrawSlaves(){this._pluginsExecute('preDraw')}draw(e){this.drawn=!0,this.updateLegend(!0),this.drawSeries(this.redraw(!0,e)),this._pluginsExecute('postDraw')}delayUpdate(){return this._lockUpdate=!0,this}doUpdate(){return this.legend&&this.legend.update(),this.draw(),this.legend&&this.legend.update(),this}resumeUpdate(){return this._lockUpdate=!1,this}isDelayedUpdate(){return this._lockUpdate}setWidth(e,t){this.width=e,t||this._resize()}setHeight(e,t){this.height=e,t||this._resize()}resize(e,t){return e&&t&&this.setSize(e,t),this._resize(),this}setSize(e,t){this.setWidth(e,!0),this.setHeight(t,!0),this.getDrawingHeight(),this.getDrawingWidth()}getWidth(){return this.width}getHeight(){return this.height}getPaddingTop(){return this.options.paddingTop}getPaddingLeft(){return this.options.paddingLeft}getPaddingBottom(){return this.options.paddingBottom}getPaddingRight(){return this.options.paddingRight}getDrawingHeight(e){return e&&this.innerHeight?this.innerHeight:this.innerHeight=this.height-this.options.paddingTop-this.options.paddingBottom}getDrawingWidth(e){return e&&this.innerWidth?this.innerWidth:this.innerWidth=this.width-this.options.paddingLeft-this.options.paddingRight}cacheOffset(){this.offsetCached=getOffset(this.wrapper)}uncacheOffset(){this.offsetCached=!1}getXAxis(e,t){return 0<this.axis.top.length&&0==this.axis.bottom.length?this.getTopAxis(e,t):this.getBottomAxis(e,t)}getYAxis(e,t){return 0<this.axis.right.length&&0==this.axis.left.length?this.getRightAxis(e,t):this.getLeftAxis(e,t)}getTopAxis(e,t){return _getAxis(this,e,t,'top')}getBottomAxis(e,t){return _getAxis(this,e,t,'bottom')}getLeftAxis(e,t){return _getAxis(this,e,t,'left')}getRightAxis(e,t){return _getAxis(this,e,t,'right')}setXAxis(e,t){this.setBottomAxis(e,t)}setYAxis(e,t){this.setLeftAxis(e,t)}setLeftAxis(e,t){t=t||0,this.axis.left[t]&&this.axis.left[t].kill(),this.axis.left[t]=e}setRightAxis(e,t){t=t||0,this.axis.right[t]&&this.axis.right[t].kill(),this.axis.right[t]=e}setTopAxis(e,t){t=t||0,this.axis.top[t]&&this.axis.top[t].kill(),this.axis.top[t]=e}setBottomAxis(e,t){t=t||0,this.axis.bottom[t]&&this.axis.bottom[t].kill(),this.axis.bottom[t]=e}killAxis(e,t=!1,i=!1){var r;e.isX()&&(-1<(r=this.axis.bottom.indexOf(e))&&this.axis.bottom.splice(r,1),-1<(r=this.axis.top.indexOf(e))&&this.axis.top.splice(r,1),!i&&this.series.forEach((t)=>{t.getXAxis()==e&&t.kill()})),e.isY()&&(-1<(r=this.axis.left.indexOf(e))&&this.axis.left.splice(r,1),-1<(r=this.axis.right.indexOf(e))&&this.axis.right.splice(r,1),!i&&this.series.forEach((t)=>{t.getYAxis()==e&&t.kill()})),this.axisGroup.removeChild(e.group),this.groupPrimaryGrids.removeChild(e.gridPrimary),this.groupSecondaryGrids.removeChild(e.gridSecondary),t||this.draw(!0)}hasXAxis(e){return this.hasTopAxis(e)||this.hasBottomAxis(e)}hasYAxis(e){return this.hasLeftAxis(e)||this.hasRightAxis(e)}hasTopAxis(e){return this.hasAxis(e,this.axis.top)}hasBottomAxis(e){return this.hasAxis(e,this.axis.bottom)}hasLeftAxis(e){return this.hasAxis(e,this.axis.left)}hasRightAxis(e){return this.hasAxis(e,this.axis.right)}hasAxis(e,t){for(var r=0,i=t.length;r<i;r++){if(t[r]==e)return!0;if(t[r].hasAxis(e))return!0}return!1}autoscaleAxes(){return this._applyToAxes('setMinMaxToFitSeries',null,!0,!0),this}autoscale(){return this.autoscaleAxes(...arguments)}autoScale(){return this.autoscaleAxes(...arguments)}autoScaleAxes(){return this.autoscaleAxes(...arguments)}autoScaleAxis(e){return e?(e.setMinMaxToFitSeries(),this):this}setBackgroundColor(e){return this.rectEvent.setAttribute('fill',e),this}getAxisState(){var e={};for(var t in this.axis)e[t]=this.axis[t].map(function(e){return[e.getCurrentMin(),e.getCurrentMax()]});return e}setAxisState(e){var t,r;for(var a in e)if(this.axis[a])for(t=0,r=e[a].length;t<r;t++)this.axis[a][t]&&(this.axis[a][t].setCurrentMin(e[a][t][0]),this.axis[a][t].setCurrentMax(e[a][t][1]));this.draw()}saveAxisState(e){return this.savedAxisState=this.savedAxisState||{},this.savedAxisState[e]=this.getAxisState(),this}recallAxisState(e){return this.savedAxisState[e]&&this.recallAxisState(this.savedAxisState[e]),this}_applyToAxis(e){switch(e){case'string':return function(e,t,r){for(var a=0;a<this.axis[e].length;a++)this.axis[e][a][t].apply(this.axis[e][a],r)};case'function':return function(e,t,r){for(var a=0;a<this.axis[e].length;a++)t.call(this,this.axis[e][a],e,r)};default:throw new Error('You must either execute a function or provide a string that registers a function');}}getBoundaryAxis(e,t,i){var r=this.getBoundaryAxisFromSeries(e,t,i);return r}getBoundaryAxisFromSeries(e,t,r){var a='min'==t,s=e.isX()?['getMinX','getMaxX']:['getMinY','getMaxY'],n=s[a?0:1],o=a?+Infinity:-Infinity,p,d,g,c,u,i;for(p=o,g=this.getSeriesFromAxis(e),(u=0,i=g.length);u<i;u++)(d=g[u],!!d.isShown())&&(c=d[n](r),p=Math[t](isNaN(p)?o:p,isNaN(c)?o:c));return p}getSeriesFromAxis(e){for(var t=[],r=this.series.length-1;0<=r;r--)(this.series[r].getXAxis()==e||this.series[r].getYAxis()==e)&&t.push(this.series[r]);return t}updateDataMinMaxAxes(e){var t=['bottom','top','left','right'],r,a,s,n;for(a=0,s=t.length;a<s;a++)for(n=this.axis[t[a]].length-1;0<=n;n--){r=this.axis[t[a]][n],!r.isShown();let i=this.getBoundaryAxis(this.axis[t[a]][n],'min',e),s=this.getBoundaryAxis(this.axis[t[a]][n],'max',e);isFinite(s)&&r.setMaxValueData(s),isFinite(i)&&r.setMinValueData(i)}}_applyToAxes(e,t,r,a){var s=[],n=0,i;for((r||void 0==r)&&(s.push('top'),s.push('bottom')),(a||void 0==a)&&(s.push('left'),s.push('right')),i=s.length;n<i;n++)this._applyToAxis(typeof e).call(this,s[n],e,t)}findAxesLinkedTo(e){var t=[];return this._applyToAxes(function(i){i.linkedToAxis&&i.linkedToAxis.axis==e&&t.push(i)},{},e instanceof this.getConstructor('graph.axis.x'),e instanceof this.getConstructor('graph.axis.y')),t}_axisHasChanged(){this._axesHaveChanged=!0}newSerie(e,t,i){let r;return('object'==typeof t||i||(i=t,t={}),i||(i=Graph$1.SERIE_LINE),r=this.getSerie(e))?r:(r=makeSerie(this,e,t,i))?(this.series.push(r),this.emit('newSerie',r),r):void 0}getSerie(e){if('number'==typeof e)return this.series[e]||!1;'function'==typeof e&&(e=e());for(var t=0,i=this.series.length;t<i;t++)if(this.series[t].getName()==e||this.series[t]==e)return this.series[t];return!1}getSeries(){return this.series}allSeries(...e){return this.series.filter((t)=>e.include(t.getType()))}drawSerie(e,t){if(!e.draw)throw new Error('Serie has no method draw');e.draw(t)}drawSeries(e){if(this.width&&this.height)for(var t=this.series.length-1;0<=t;t--)this.series[t].isShown()&&this.drawSerie(this.series[t],e)}resetSeries(){this.removeSeries()}killSeries(){this.resetSeries()}removeSeries(){for(;this.series[0];)this.series[0].kill(!0);this.series=[],this.legend&&this.legend.update()}selectSerie(e,t){'object'==typeof e||(e=this.getSerie(e));this.selectedSerie==e&&this.selectedSerie.selectionType==t||(this.selectedSerie!==e&&this.selectedSerie&&this.unselectSerie(this.selectedSerie),this.selectedSerie=e,this.triggerEvent('onSelectSerie',e),e.select(t||'selected'))}getSelectedSerie(){return this.selectedSerie}unselectSerie(e){e.unselect&&(e.unselect(),this.selectedSerie=!1,this.triggerEvent('onUnselectSerie',e))}getShapesOfSerie(e){for(var t=[],r=this.shapes.length-1;0<=r;r--)this.shapes[r].getSerie()==e&&t.push(this.shapes[r]);return t}makeToolbar(e){var t=this.getConstructor('graph.toolbar');return t?this.toolbar=new t(this,e):throwError('No constructor exists for toolbar')}getShapes(){return this.shapes||[]}newShape(e,t,r=!1,a){if(this.prevent(!1),!r&&(this.emit('beforeNewShape',t),this.prevent(!1)))return!1;'object'==typeof e&&(r=t,t=e,e=t.type),t=t||{},t._id=guid();var s;if(s='function'==typeof e?e:this.getConstructor('graph.shape.'+e),!s)return throwError('No constructor for this shape');var n=new s(this,t);if(!n)return throwError('Failed to construct shape.');if(n.type=e,n.graph=this,n._data=t,void 0!==t.properties&&n.setProperties(t.properties),n.init(this,a),void 0!==t.props)for(var o in t.props)n.setProp(o,t.props[o]);if(t.position)for(var o=0,i=t.position.length;o<i;o++)n.setPosition(new Position(t.position[o]),o);if(void 0!==t.fillColor&&n.setFillColor(t.fillColor),void 0!==t.fillOpacity&&n.setFillOpacity(t.fillOpacity),void 0!==t.strokeColor&&n.setStrokeColor(t.strokeColor),void 0!==t.strokeWidth&&n.setStrokeWidth(t.strokeWidth),void 0!==t.layer&&n.setLayer(t.layer),!0==t.locked&&n.lock(),!0==t.movable&&n.movable(),!0==t.selectable&&n.selectable(),!0==t.resizable&&n.resizable(),void 0!==t.attributes&&n.setProp('attributes',t.attributes),void 0!==t.handles&&n.setProp('handles',t.handles),void 0!==t.selectOnMouseDown&&n.setProp('selectOnMouseDown',!0),void 0!==t.selectOnClick&&n.setProp('selectOnClick',!0),void 0!==t.transforms&&Array.isArray(t.transforms)&&t.transforms.forEach(({type:e,value:t})=>{n.addTransform(e,t)}),void 0!==t.highlightOnMouseOver&&n.setProp('highlightOnMouseOver',!0),t.labelEditable&&n.setProp('labelEditable',t.labelEditable),t.labels&&!t.label&&(t.label=t.labels),void 0!==t.label){Array.isArray(t.label)||(t.label=[t.label]);for(var o=0,i=t.label.length;o<i;o++)n.showLabel(o),n.setLabelText(t.label[o].text,o),n.setLabelPosition(t.label[o].position,o),n.setLabelColor(t.label[o].color||'black',o),n.setLabelSize(t.label[o].size,o),n.setLabelAngle(t.label[o].angle||0,o),n.setLabelBaseline(t.label[o].baseline||'no-change',o),n.setLabelAnchor(t.label[o].anchor||'start',o),n.setLabelBackgroundColor(t.label[o].backgroundColor||'transparent',o),n.setLabelBackgroundOpacity(t.label[o].backgroundOpacity||1,o)}return t.serie&&n.setSerie(this.getSerie(t.serie)),n.createHandles(),n.applyStyle(),this.shapes.push(n),r||this.emit('newShape',n,t),n}newPosition(){return new Position(...arguments)}redrawShapes(){for(var e=0,t=this.shapes.length;e<t;e++)this.shapes[e].redraw()}removeShapes(){for(var e=0,t=this.shapes.length;e<t;e++)this.shapes[e]&&this.shapes[e].kill&&this.shapes[e].kill(!0);this.shapes=[]}selectShape(e,t){if(e){if(-1<this.selectedShapes.indexOf(e))return!1;if(!e.isSelectable())return!1;t||this.emit('beforeShapeSelect',e),this.prevent(!1)||(0<this.selectedShapes.length&&this.options.shapesUniqueSelection&&this.unselectShapes(t),e._select(t),this.selectedShapes.push(e),!t&&this.emit('shapeSelect',e))}}getSelectedShapes(){return this.selectedShapes}unselectShape(e,t){if(-1!=this.selectedShapes.indexOf(e))return t||this.emit('beforeShapeUnselect',e),this.cancelUnselectShape?void(this.cancelUnselectShape=!1):void(e._unselect(),this.selectedShapes.splice(this.selectedShapes.indexOf(e),1),!t&&this.emit('shapeUnselect',e))}unselectShapes(e){for(;this.selectedShapes[0];)this.unselectShape(this.selectedShapes[0],e);return this}_removeShape(e){this.shapes.splice(this.shapes.indexOf(e),1)}appendShapeToDom(e){e.isHTML()&&this.wrapper.insertBefore(e._dom,this.dom),this.getLayer(e.getLayer(),'shape').appendChild(e.group)}removeShapeFromDom(e){e.isHTML()&&this.wrapper.removeChild(e._dom),this.getLayer(e.getLayer(),'shape').removeChild(e.group)}appendSerieToDom(e){this.getLayer(e.getLayer(),'serie').appendChild(e.groupMain)}removeSerieFromDom(e){this.getLayer(e.getLayer(),'serie').removeChild(e.groupMain)}getLayer(e,t){if(!this.layers[e]){this.layers[e]=[],this.layers[e][0]=document.createElementNS(Graph$1.ns,'g'),this.layers[e][0].setAttribute('data-layer',e),this.layers[e][1]=document.createElementNS(Graph$1.ns,'g'),this.layers[e][2]=document.createElementNS(Graph$1.ns,'g'),this.layers[e][0].appendChild(this.layers[e][1]),this.layers[e][0].appendChild(this.layers[e][2]);for(var r=1,i;!(i=this.layers[e-r])&&0<=e-r;)r++;i?i.nextSibling?this.plotGroup.insertBefore(this.layers[e][0],i.nextSibling):this.plotGroup.appendChild(this.layers[e][0]):this.plotGroup.insertBefore(this.layers[e][0],this.plotGroup.firstChild)}return this.layers[e]['shape'==t?2:1]}focus(){this.wrapper.focus()}elementMoving(e){this.bypassHandleMouse=e}stopElementMoving(e){e&&e==this.bypassHandleMouse?this.bypassHandleMouse=!1:!e&&(this.bypassHandleMouse=!1)}_makeClosingLines(){this.closingLines={};for(var e=['top','bottom','left','right'],t=0;t<4;t++){var i=document.createElementNS(Graph$1.ns,'line');i.setAttribute('stroke',this.options.closeColor),i.setAttribute('shape-rendering','crispEdges'),i.setAttribute('stroke-linecap','square'),i.setAttribute('display','none'),this.closingLines[e[t]]=i,this.graphingZone.appendChild(i)}}isActionAllowed(t,e){if((e.type===t.type||void 0===e.type&&'mousedown'===t.type||('wheel'===t.type||'mousewheel'===t.type)&&'mousewheel'==e.type)&&!(e.enabled&&('function'==typeof e.enabled?!e.enabled(this):!e.enabled))){if(e.key&&e.key!==t.keyCode){if({backspace:8,enter:13,tab:9,shift:16,ctrl:17,alt:18,pause:19,escape:27,up:33,down:34,left:37,right:39}[e.key]!==t.keyCode)return}return void 0===e.shift&&(e.shift=!1),void 0===e.ctrl&&(e.ctrl=!1),void 0===e.meta&&(e.meta=!1),void 0===e.alt&&(e.alt=!1),t.shiftKey==e.shift&&t.ctrlKey==e.ctrl&&t.metaKey==e.meta&&t.altKey==e.alt}}forcePlugin(e){this.forcedPlugin=e}unforcePlugin(){this.forcedPlugin=!1}_pluginsExecute(e,...t){for(var r in this.plugins)this.plugins[r]&&this.plugins[r][e]&&this.plugins[r][e].apply(this.plugins[r],t)}_pluginExecute(e,t,i){return e?this.plugins[e]&&this.plugins[e][t]?(this.plugins[e][t].apply(this.plugins[e],i),!0):void 0:void 0}pluginYieldActiveState(){this.activePlugin=!1}_serieExecute(e,t,i){'object'!=typeof e&&(e=this.getSerie(e)),'function'==typeof e[t]&&e.apply(e,i)}_pluginsInit(){var e,t,r;for(var a in this.options.plugins)t=a,r=this.options.plugins[a],e=this.getConstructor('graph.plugin.'+t),e?(this.plugins[t]=new e(r),mapEventEmission(this.plugins[t].options,this.plugins[t]),this.plugins[t].init(this,r)):throwError('Plugin "'+t+'" has not been registered')}getPlugin(e){var t=this.plugins[e];return t?t:throwError('Plugin "'+e+'" has not been loaded or properly registered')}triggerEvent(){var e=arguments[0];if('function'==typeof this.options[e])return this.options[e].apply(this,arguments)}makeLegend(e){if(this.legend)return this.legend;var t=this.getConstructor('graph.legend');if(t)this.legend=new t(this,e);else return throwError('Graph legend is not available as it has not been registered');return this.legend}updateLegend(e=!1){if(this.legend)return this.legend.update(e),this}getLegend(){return this.legend?this.legend:void 0}requireLegendUpdate(){this.legend&&this.legend.requireDelayedUpdate()}orthogonalProjectionSetup(){this.options.zAxis=extend(!0,{maxZ:10,minZ:0,shiftX:-25,shiftY:-15,xAxis:this.getXAxis(),yAxis:this.getYAxis()})}orthogonalProjectionUpdate(){this.zAxis||(this.zAxis={g:document.createElementNS(Graph$1.ns,'g'),l:document.createElementNS(Graph$1.ns,'line')},this.zAxis.g.appendChild(this.zAxis.l),this.groupGrids.appendChild(this.zAxis.g));let e=this.options.zAxis.xAxis,t=this.options.zAxis.yAxis;var r=e.getMinPx(),a=t.getMinPx(),s=e.getZProj(this.options.zAxis.maxZ),n=t.getZProj(this.options.zAxis.maxZ);this.zAxis.l.setAttribute('stroke','black'),this.zAxis.l.setAttribute('x1',r),this.zAxis.l.setAttribute('x2',r+s),this.zAxis.l.setAttribute('y1',a),this.zAxis.l.setAttribute('y2',a+n),this.updateDataMinMaxAxes(!0);var o=this.series.map((e)=>[e.getZPos(),e]);o.sort((e,t)=>t[0]-e[0]);let l=0;o.forEach((e)=>{e[1].setLayer(l),this.appendSerieToDom(e[1]),l++}),this.drawSeries(!0)}kill(){this.wrapper.removeChild(this.dom)}_removeSerie(e){this.series.splice(this.series.indexOf(e),1),this._pluginsExecute('serieRemoved',e)}contextListen(e,t,i){if(this.options.onContextMenuListen)return this.options.onContextMenuListen(e,t,i)}lockShapes(){this.shapesLocked=!0;for(var e=0,t=this.shapes.length;e<t;e++)this.shapes[e].moving=!1,this.shapes[e].resizing=!1}unlockShapes(){this.shapesLocked=!1}prevent(e){var t=this.prevented;return-1!=e&&(this.prevented=void 0==e||e),t}_getXY(t){var e=t.clientX,i=t.clientY,r=this.offsetCached||getOffset(this.wrapper);return e-=r.left,i-=r.top,{x:e,y:i}}_resize(){this.width&&this.height&&(this.getDrawingWidth(),this.getDrawingHeight(),this.sizeSet=!0,this.dom.setAttribute('width',this.width),this.dom.setAttribute('height',this.height),this.domTitle.setAttribute('x',this.width/2),this._sizeChanged=!0,this.drawn&&(this.requireLegendUpdate(),this.draw(!0)))}updateGraphingZone(){setAttributeTo(this.graphingZone,{transform:'translate('+this.options.paddingLeft+', '+this.options.paddingTop+')'}),this._sizeChanged=!0}getDrawingSpaceWidth(){return()=>this.drawingSpaceWidth}getDrawingSpaceHeight(){return()=>this.drawingSpaceHeight}getDrawingSpaceMinX(){return()=>this.drawingSpaceMinX}getDrawingSpaceMinY(){return()=>this.drawingSpaceMinY}getDrawingSpaceMaxX(){return()=>this.drawingSpaceMaxX}getDrawingSpaceMaxY(){return()=>this.drawingSpaceMaxY}trackingLine(e){var t=this;return'boolean'==typeof e?void(this.options.trackingLine&&(this.options.trackingLine.enable=e)):(e&&(this.options.trackingLine=e),e.series=e.series||[],e.enable=void 0===e.enable||!!e.enable,'individual'==e.mode?e.series&&(!Array.isArray(e.series)&&('all'==e.series?e.series=this.series.map((e)=>({serie:e})):e.series=[e.series]),e.series.forEach((e)=>{if('object'!=typeof e.serie){if('object'!=typeof e)throw new Error('Misuse of the trackingLine() method. Each serie must be an object with the serie property: { series: [ { serie: jsGraphSerie, options: { ... someOptions } } ] }');e.serie=this.getSerie(e.serie)}e.serie&&t.addSerieToTrackingLine(e.serie,e)})):e.series.forEach((e)=>{e.serie.disableTracking()}),!e.noLine)?(this.trackingObject||(this.trackingObject=this.newShape('line',extend(!0,{position:[{y:'min'},{y:'max'}],stroke:'black',layer:-1},e.trackingLineShapeOptions))),this.trackingObject.draw(),this.trackingObject):void 0}addSerieToTrackingLine(e,t){this.options.trackingLine||this.trackingLine({mode:'individual'}),this.options.trackingLine.series.forEach((t,i)=>{t.serie==e&&this.options.trackingLine.series.splice(i,1)}),this.options.trackingLine.series.push(Object.assign({serie:e},t)),e.enableTracking((e,i,r,a)=>{this.options.trackingLine.enable&&i&&(this.trackingObject&&(this.trackingObject.show(),this.trackingObject.getPosition(0).x=i.trueX,this.trackingObject.getPosition(1).x=i.trueX,this.trackingObject.redraw()),e._trackingLegend=_trackingLegendSerie(this,{serie:e},r,a,e._trackingLegend,t.textMethod?t.textMethod:(e)=>{for(var t in e)return e[t].serie.serie.getName()+': '+e[t].serie.serie.getYAxis().valueToHtml(e[t].yValue)},i.trueX),e._trackingLegend&&(e._trackingLegend.style.display='block'))},(e)=>{this.trackingObject&&this.trackingObject.hide(),e.trackingShape&&e.trackingShape.hide(),e._trackingLegend&&(e._trackingLegend.style.display='none'),e._trackingLegend=_trackingLegendSerie(this,{serie:e},!1,!1,e._trackingLegend,!1,!1)})}setKatexRenderer(e){this._katexRenderer=e}hasKatexRenderer(){return!!this._katexRenderer}renderWithKatex(e,t){if(this._katexRenderer){t?t.removeChild(t.firstChild):t=document.createElementNS(Graph$1.ns,'foreignObject');let i=document.createElement('div');return t.appendChild(i),this._katexRenderer(e,i),t}return!1}static fromJSON(e,t){let i={},r={left:[],top:[],right:[],bottom:[]},a,s;return e.title&&(i.title=e.title),e.axis&&e.axis.forEach(function(e){e.type||throwError('Axis type is required (top, bottom, left or right)');var t={};e.label&&(t.labelValue=e.label),void 0!==e.unit&&(t.unit=e.unit),void 0!==e.unitWrapperAfter&&(t.unitWrapperAfter=e.unitWrapperAfter),void 0!==e.unitWrapperBefore&&(t.unitWrapperBefore=e.unitWrapperBefore),void 0!==e.min&&(t.forcedMin=e.min),void 0!==e.max&&(t.forcedMax=e.max),void 0!==e.flip&&(t.flipped=e.flip),r[e.type].push(t),e._jsGraphIndex=r[e.type].length-1}),a=new Graph$1(t,i,r),e.width&&a.setWidth(e.width),e.height&&a.setHeight(e.width),a._resize(),e.data&&e.data.forEach(function(t){var r=t.type,n={},o,p;let d;switch(t.type){case'bar':throwError('Bar charts not supported'),r=!1;break;case'color':r=Graph$1.SERIE_LINE_COLORED;break;case'scatter':r=Graph$1.SERIE_SCATTER;break;case'box':r=Graph$1.SERIE_BOX,('x'==t.orientation||'y'==t.orientation)&&(n.orientation=t.orientation);break;default:r=Graph$1.SERIE_LINE;}if(r!==Graph$1.SERIE_BOX&&(d=Graph$1.newWaveform()),!r)return void throwError('No valid serie type was found');if(o=a.newSerie(t.id||t.label||guid(),n,r),t.lineStyle){let e;Array.isArray(e)&&(e={unselected:e}),Object.entries(e).forEach(([e,t])=>{var i={};r===Graph$1.SERIE_LINE?(void 0!==t.lineWidth&&(i.lineWidth=t.lineWidth),void 0!==t.color&&(i.lineColor=t.color),t.lineStyle&&(i.lineStyle=t.lineStyle),o.setStyle(i,e)):void 0})}let g={},c={};if(t.defaultStyle&&(g=t.defaultStyle),t.defaultStyles&&(c=t.defaultStyles),t.styles){let e=Array.isArray(t.styles)?{unselected:t.styles}:t.styles;let i=new Set(Object.keys(c).concat(Object.keys(e)));i.forEach((t)=>{let i=[],a;e&&e[t]&&(i=e[t],!Array.isArray(i)&&(i=[i]),a=i.map(function(e){switch(r){case Graph$1.SERIE_LINE:return{type:e.shape,zoom:e.zoom,strokeWidth:e.lineWidth,strokeColor:e.lineColor,fillColor:e.color,points:e.points};break;case Graph$1.SERIE_BOX:return e;break;case Graph$1.SERIE_SCATTER:return e;}})),r===Graph$1.SERIE_LINE?o.setMarkers(a,t):r===Graph$1.SERIE_SCATTER?o.setStyle(Object.assign({},defaultScatterStyle,g,c[t]||{}),a,t):r===Graph$1.SERIE_BOX?o.setStyle(a[0],t||'unselected'):void 0})}if(t.color&&r==Graph$1.SERIE_LINE_COLORED&&o.setColors(t.color),r!==Graph$1.SERIE_BOX&&d.setData(t.y,t.x),!!o){let n=[],l=[],g=[],c=[],h=[],x=[],m=[],y=[];if(void 0!==d){if(t.errorX)for(var u=0,i=t.errorX.length;u<i;u++)Array.isArray(t.errorX[u])?(n.push(t.errorX[u][0]),l.push(t.errorX[u][1])):(n.push(t.errorX[u]),l.push(t.errorX[u]));else if(t.errorBarX||t.errorBoxX){if(t.errorBarX)for(var u=0,i=t.errorBarX.length;u<i;u++)Array.isArray(t.errorBarX[u])?(n.push(t.errorBarX[u][0]),l.push(t.errorBarX[u][1])):(n.push(t.errorBarX[u]),l.push(t.errorBarX[u]));if(t.errorBoxX)for(var u=0,i=t.errorBoxX.length;u<i;u++)Array.isArray(t.errorBoxX[u])?(h.push(t.errorBoxX[u][0]),x.push(t.errorBoxX[u][1])):(h.push(t.errorBoxX[u]),x.push(t.errorBoxX[u]))}if(t.errorY)for(var u=0,i=t.errorY.length;u<i;u++)Array.isArray(t.errorY[u])?(g.push(t.errorY[u][0]),c.push(t.errorY[u][1])):(g.push(t.errorY[u]),c.push(t.errorY[u]));else if(t.errorBarY||t.errorBoxY){if(t.errorBarY)for(var u=0,i=t.errorBarY.length;u<i;u++)Array.isArray(t.errorBarY[u])?(g.push(t.errorBarY[u][0]),c.push(t.errorBarY[u][1])):(g.push(t.errorBarY[u]),c.push(t.errorBarY[u]));if(t.errorBoxY)for(var u=0,i=t.errorBoxY.length;u<i;u++)Array.isArray(t.errorBoxY[u])?(m.push(t.errorBoxY[u][0]),y.push(t.errorBoxY[u][1])):(m.push(t.errorBoxY[u]),y.push(t.errorBoxY[u]))}s={},0<n.length&&(d.setErrorBarXAbove(Graph$1.newWaveform(n)),s.right={}),0<l.length&&(d.setErrorBarXAbove(Graph$1.newWaveform(n)),s.left={}),0<g.length&&(d.setErrorBarXAbove(Graph$1.newWaveform(g)),s.top={}),0<c.length&&(d.setErrorBarXAbove(Graph$1.newWaveform(g)),s.bottom={}),o.setErrorBarStyle(s),s={},0<h.length&&(d.setErrorBoxXAbove(Graph$1.newWaveform(h)),s.right={}),0<x.length&&(d.setErrorBoxXBelow(Graph$1.newWaveform(x)),s.left={}),0<m.length&&(d.setErrorBoxAbove(Graph$1.newWaveform(m)),s.top={}),0<y.length&&(d.setErrorBoxBelow(Graph$1.newWaveform(y)),s.bottom={}),o.setErrorBoxStyle(s)}switch(e.axis?(p=e.axis[t.xAxis],p&&('top'===p.type||'bottom'===p.type)?'top'==p.type?o.setXAxis(a.getTopAxis(p._jsGraphIndex)):'bottom'==p.type&&o.setXAxis(a.getBottomAxis(p._jsGraphIndex)):(warn('No x axis found. Setting automatically'),o.setXAxis(a.getXAxis(0))),p=e.axis[t.yAxis],p&&('left'===p.type||'right'===p.type)?'left'==p.type?o.setYAxis(a.getLeftAxis(p._jsGraphIndex)):'right'==p.type&&o.setYAxis(a.getRightAxis(p._jsGraphIndex)):(warn('No y axis found. Setting automatically'),o.setYAxis(a.getYAxis(0)))):(warn('No axes found. Setting automatically'),o.autoAxis()),r){case Graph$1.SERIE_BOX:o.setData(t.boxes);break;default:case Graph$1.SERIE_SCATTER:case Graph$1.SERIE_LINE_COLORED:case Graph$1.SERIE_LINE:o.setWaveform(d);}}}),a.autoscaleAxes(),a.draw(),a}exportToSchema(){let e={title:this.options.title,width:this.getWidth(),height:this.getHeight()},t=[],i={x:[],y:[]};['top','bottom','left','right'].map((e)=>{this.axis[e]&&(t=t.concat(this.axis[e].map((t)=>({type:e,label:t.options.label,unit:t.options.unit,min:t.options.forcedMin,max:t.options.forcedMax,flip:t.options.flipped}))),'top'==e||'bottom'==e?i.x=i.x.concat(this.axis[e]):i.y=i.y.concat(this.axis[e]))}),e.axis=t;let r=(e)=>{switch(e){case Graph$1.SERIE_LINE:return'line';break;case Graph$1.SERIE_BAR:return'bar';break;case Graph$1.SERIE_LINE_COLORED:return'color';break;case Graph$1.SERIE_SCATTER:return'scatter';}},a=(e,t)=>{let r=[];switch(e.getType()){case Graph$1.SERIE_LINE:for(var a=0;a<e.data.length;a++)for(var i=0;i<e.data[a].length-1;i+=2)r.push(e.data[a][i+(t&&e.isFlipped()||!t&&!e.isFlipped()?1:0)]);break;case Graph$1.SERIE_SCATTER:for(var i=0;i<e.data.length-1;i+=2)r.push(e.data[a+(t&&e.isFlipped()||!t&&!e.isFlipped()?1:0)]);}return r};return e.data=[].concat(this.series.map((e)=>{let t=[],s=[];if(e.getType()==Graph$1.SERIE_LINE)for(var n in e.styles){s.push({styleName:n,color:e.styles[n].lineColor,lineWidth:e.styles[n].lineWidth,lineStyle:e.styles[n].lineStyle});let i={styleName:n,styles:[]};t.push(i),i.styles=i.styles.concat((e.styles[n].markers||[]).map((e)=>({shape:e.type,zoom:e.zoom,lineWidth:e.strokeWidth,lineColor:e.strokeColor,color:e.fillColor,points:e.points})))}return{label:e.getLabel(),id:e.getName(),type:r(e.getType()),x:a(e,!0),y:a(e,!1),xAxis:i.x.indexOf(e.getXAxis()),yAxis:i.y.indexOf(e.getYAxis()),style:t,lineStyle:s}})),e}static registerConstructor(e,t){return _constructors.has(e)?throwError('Constructor '+t+' already exists.'):void _constructors.set(e,t)}static getConstructor(e,t=!1){return _constructors.has(e)?_constructors.get(e):!t&&throwError('Constructor "'+e+'" doesn\'t exist')}static newWaveform(){return new Waveform(...arguments)}static waveform(){return new Waveform(...arguments)}}Graph$1.prototype.getConstructor=Graph$1.getConstructor;function makeSerie(e,t,i,r){var a=e.getConstructor(r,!0);if(a||'string'!=typeof r||(a=e.getConstructor('graph.serie.'+r,!0)),a){var s=new a(e,t,i);e.appendSerieToDom(s)}else return throwError('No constructor exists for the serie type provided. Use Graph.registerConstructor( name, constructor ) first is you use your own series');return s}function getAxisLevelFromSpan(e,t){for(var r=0,i=t.length,a;r<i;r++){a=!0;for(var s=0,n=t[r].length;s<n;s++)e[0]<t[r][s][0]&&e[1]<t[r][s][0]||e[0]>t[r][s][1]&&e[1]>t[r][s][1]||(a=!1);if(a)return t[r].push(e),r}return t.push([e]),t.length-1}function refreshDrawingZone(e){var t=Math.max,i={top:[],bottom:[],left:[],right:[]},r={top:[],bottom:[],left:[],right:[]};e._painted=!0,e._applyToAxes(function(e,a){if(!e.isShown())return void e.hideGroup();if(e.showGroup(),!e.floating){var s=getAxisLevelFromSpan(e.getSpan(),r[a]);e.setLevel(s),i[a][s]=t(e.getAxisPosition(),i[a][s]||0)}},!1,!0,!1);var a=i.top.reduce(function(e,t){return e+t},0),s=i.bottom.reduce(function(e,t){return e+t},0);e.drawingSpaceHeight=e.getDrawingHeight()-a-s,[i.top,i.bottom].map(function(e){e.reduce(function(t,i,r){return e[r]=t+i,t+i},0)}),e._applyToAxes(function(e,t){!e.isShown()||e.floating||e.setShift(i[t][e.getLevel()])},!1,!0,!1),e._applyToAxes(function(n,o){if(n.isShown()?n.showGroup():n.hideGroup(),n.setMinPx(a),n.setMaxPx(e.getDrawingHeight(!0)-s),!n.floating){let e=n.linkedToAxis?0:n.draw();if(n.isShown()){var l=getAxisLevelFromSpan(n.getSpan(),r[o]);n.setLevel(l),i[o][l]=t(e,i[o][l]||0)}}},!1,!1,!0);var n=extend(!0,{},i);e._applyToAxes(function(e,r){!e.isShown()||e.floating||(n[r][e.getLevel()]=t(i[r][e.getLevel()],e.equalizePosition(i[r][e.getLevel()])))},!1,!1,!0),i=n;var o=i.left.reduce(function(e,t){return e+t},0),l=i.right.reduce(function(e,t){return e+t},0);e.drawingSpaceWidth=e.getDrawingWidth()-o-l,[i.left,i.right].map(function(e){e.reduce(function(t,i,r){return e[r]=t+i,t+i},0)}),e._applyToAxes((e,t)=>{!e.isShown()||e.floating||e.setShift(i[t][e.getLevel()])},!1,!1,!0),e._applyToAxes(function(t){!t.isShown(),t.setMinPx(o),t.setMaxPx(e.getDrawingWidth(!0)-l);t.floating||!t.linkedToAxis&&t.draw()},!1,!0,!1),e._applyToAxes(function(e){if(e.floating){var t=e.getFloatingAxis(),i=e.getFloatingValue(),r=t.getPx(i);e.setShift(r),e.linkedToAxis||e.draw()}},!1,!0,!0),_closeLine(e,'right',e.getDrawingWidth(!0),e.getDrawingWidth(!0),a,e.getDrawingHeight(!0)-s),_closeLine(e,'left',0,0,a,e.getDrawingHeight(!0)-s),_closeLine(e,'top',o,e.getDrawingWidth(!0)-l,0,0),_closeLine(e,'bottom',o,e.getDrawingWidth(!0)-l,e.getDrawingHeight(!0)-s,e.getDrawingHeight(!0)-s),e.clipRect.setAttribute('y',a),e.clipRect.setAttribute('x',o),e.clipRect.setAttribute('width',e.getDrawingWidth()-o-l),e.clipRect.setAttribute('height',e.getDrawingHeight()-a-s),e.rectEvent.setAttribute('y',a+e.getPaddingTop()),e.rectEvent.setAttribute('x',o+e.getPaddingLeft()),e.rectEvent.setAttribute('width',e.drawingSpaceWidth),e.rectEvent.setAttribute('height',e.drawingSpaceHeight),e.drawingSpaceMinX=o+e.getPaddingLeft(),e.drawingSpaceMinY=a+e.getPaddingTop(),e.drawingSpaceMaxX=e.getDrawingWidth()-l+e.getPaddingLeft(),e.drawingSpaceMaxY=e.getDrawingHeight()-s+e.getPaddingTop(),e._applyToAxes(function(e){e.isShown()&&e.drawLines()},!1,!0,!0),e.shift=i,e.redrawShapes()}function _handleKey(e,t,i){return console.log(t,i),e.forcedPlugin?(e.activePlugin=e.forcedPlugin,void e._pluginExecute(e.activePlugin,i,[e,t])):void checkKeyActions(e,t,[e,t],i)}function checkKeyActions(t,r,e,a){var s=t.options.keyActions,n,i;for(n=0,i=s.length;n<i;n++){if(s[n].plugin){if(t.forcedPlugin==s[n].plugin||t.isActionAllowed(r,s[n]))return s[n].options&&e.push(s[n].options),t.activePlugin=s[n].plugin,t._pluginExecute(s[n].plugin,a,e),r.preventDefault(),r.stopPropagation(),!0;}else if(s[n].callback&&t.isActionAllowed(r,s[n]))return s[n].options&&e.push(s[n].options),r.preventDefault(),r.stopPropagation(),s[n].callback.apply(t,e),!0;s[n].removeSelectedShape&&t.isActionAllowed(r,s[n])&&(r.preventDefault(),r.stopPropagation(),t.selectedShapes.map((e)=>{e.kill(s[n].keepInDom)}))}return!1}function doDom(){this.dom=document.createElementNS(Graph$1.ns,'svg'),this.dom.setAttributeNS('http://www.w3.org/2000/xmlns/','xmlns:xlink','http://www.w3.org/1999/xlink'),setAttributeTo(this.dom,{xmlns:Graph$1.ns,"font-family":this.options.fontFamily,"font-size":this.options.fontSize});try{setAttributeTo(this.dom,{"data-jsgraph-version":'v<%= pkg.version %>'})}catch(t){}this.defs=document.createElementNS(Graph$1.ns,'defs'),this.dom.appendChild(this.defs),this.groupEvent=document.createElementNS(Graph$1.ns,'g'),this.rectEvent=document.createElementNS(Graph$1.ns,'rect'),setAttributeTo(this.rectEvent,{"pointer-events":'fill',fill:'transparent'}),this.groupEvent.appendChild(this.rectEvent),this.dom.appendChild(this.groupEvent),this.domTitle=document.createElementNS(Graph$1.ns,'text'),this.setTitle(this.options.title),setAttributeTo(this.domTitle,{"text-anchor":'middle',y:20}),this.groupEvent.appendChild(this.domTitle),this.graphingZone=document.createElementNS(Graph$1.ns,'g'),this.updateGraphingZone(),this.groupEvent.appendChild(this.graphingZone),this.axisGroup=document.createElementNS(Graph$1.ns,'g'),this.graphingZone.appendChild(this.axisGroup),this.groupGrids=document.createElementNS(Graph$1.ns,'g'),this.groupPrimaryGrids=document.createElementNS(Graph$1.ns,'g'),this.groupSecondaryGrids=document.createElementNS(Graph$1.ns,'g'),this.axisGroup.appendChild(this.groupGrids),this.groupGrids.appendChild(this.groupSecondaryGrids),this.groupGrids.appendChild(this.groupPrimaryGrids),this.plotGroup=document.createElementNS(Graph$1.ns,'g'),this.graphingZone.appendChild(this.plotGroup),this.layers=[],this._makeClosingLines(),this.clip=document.createElementNS(Graph$1.ns,'clipPath'),this.clip.setAttribute('id','_clipplot'+this._creation),this.defs.appendChild(this.clip),this.clipRect=document.createElementNS(Graph$1.ns,'rect'),this.clip.appendChild(this.clipRect),this.clip.setAttribute('clipPathUnits','userSpaceOnUse'),this.markerArrow=document.createElementNS(this.ns,'marker'),this.markerArrow.setAttribute('viewBox','0 0 10 10'),this.markerArrow.setAttribute('id','arrow'+this._creation),this.markerArrow.setAttribute('refX','6'),this.markerArrow.setAttribute('refY','5'),this.markerArrow.setAttribute('markerUnits','strokeWidth'),this.markerArrow.setAttribute('markerWidth','8'),this.markerArrow.setAttribute('markerHeight','6'),this.markerArrow.setAttribute('orient','auto');var e=document.createElementNS(Graph$1.ns,'path');e.setAttribute('d','M 0 0 L 10 5 L 0 10 z'),this.markerArrow.appendChild(e),this.defs.appendChild(this.markerArrow),this.markerHorizontalSplit=document.createElementNS(Graph$1.ns,'marker'),this.markerHorizontalSplit.setAttribute('viewBox','0 0 6 8'),this.markerHorizontalSplit.setAttribute('id','horionzalsplit_'+this.getId()),this.markerHorizontalSplit.setAttribute('refX','3'),this.markerHorizontalSplit.setAttribute('refY','4'),this.markerHorizontalSplit.setAttribute('markerUnits','strokeWidth'),this.markerHorizontalSplit.setAttribute('markerWidth','6'),this.markerHorizontalSplit.setAttribute('markerHeight','8');var t=document.createElementNS(Graph$1.ns,'line');t.setAttribute('x1','0'),t.setAttribute('y1','8'),t.setAttribute('x2','6'),t.setAttribute('y2','0'),t.setAttribute('stroke','black'),this.markerHorizontalSplit.appendChild(t),this.defs.appendChild(this.markerHorizontalSplit),this.markerVerticalSplit=document.createElementNS(Graph$1.ns,'marker'),this.markerVerticalSplit.setAttribute('viewBox','0 0 8 6'),this.markerVerticalSplit.setAttribute('id','verticalsplit_'+this.getId()),this.markerVerticalSplit.setAttribute('refX','4'),this.markerVerticalSplit.setAttribute('refY','3'),this.markerVerticalSplit.setAttribute('markerUnits','strokeWidth'),this.markerVerticalSplit.setAttribute('markerWidth','8'),this.markerVerticalSplit.setAttribute('markerHeight','6');var t=document.createElementNS(Graph$1.ns,'line');t.setAttribute('x1','0'),t.setAttribute('y1','0'),t.setAttribute('x2','8'),t.setAttribute('y2','6'),t.setAttribute('stroke','black'),this.markerVerticalSplit.appendChild(t),this.defs.appendChild(this.markerVerticalSplit),this.vertLineArrow=document.createElementNS(Graph$1.ns,'marker'),this.vertLineArrow.setAttribute('viewBox','0 0 10 10'),this.vertLineArrow.setAttribute('id','verticalline'+this._creation),this.vertLineArrow.setAttribute('refX','0'),this.vertLineArrow.setAttribute('refY','5'),this.vertLineArrow.setAttribute('markerUnits','strokeWidth'),this.vertLineArrow.setAttribute('markerWidth','20'),this.vertLineArrow.setAttribute('markerHeight','10'),this.vertLineArrow.setAttribute('orient','auto'),this.vertLineArrow.setAttribute('stroke-width','1px');var i=document.createElementNS(Graph$1.ns,'path');i.setAttribute('d','M 0 -10 L 0 10'),i.setAttribute('stroke','black'),this.vertLineArrow.appendChild(i),this.defs.appendChild(this.vertLineArrow),this.bypassHandleMouse=!1}function _registerEvents(t){if(!t.wrapper)throw'No wrapper exists. Cannot register the events.';t.dom.setAttribute('tabindex',0),t.dom.addEventListener('keydown',(i)=>{_handleKey(t,i,'keydown')}),t.dom.addEventListener('keypress',(i)=>{_handleKey(t,i,'keypress')}),t.dom.addEventListener('keyup',(i)=>{_handleKey(t,i,'keyup')}),t.dom.addEventListener('mousemove',(i)=>{var e=t._getXY(i);_handleMouseMove(t,e.x,e.y,i)}),t.dom.addEventListener('mouseleave',()=>{_handleMouseLeave(t)}),t.groupEvent.addEventListener('mousedown',(i)=>{if(t.focus(),!(3==i.which||i.ctrlKey)){var e=t._getXY(i);_handleMouseDown(t,e.x,e.y,i)}}),t.dom.addEventListener('mouseup',(i)=>{t.emit('mouseUp',i);var e=t._getXY(i);_handleMouseUp(t,e.x,e.y,i)}),t.wrapper.addEventListener('mouseup',(t)=>{t.stopPropagation()}),t.dom.addEventListener('dblclick',(i)=>{t.emit('dblClick',i);var e=t._getXY(i);_handleDblClick(t,e.x,e.y,i)}),t.groupEvent.addEventListener('click',(i)=>{if(!(3==i.which||i.ctrlKey)){var e=t._getXY(i);t.prevent(!1)||_handleClick(t,e.x,e.y,i)}}),t.groupEvent.addEventListener('mousewheel',(i)=>{var e=i.wheelDeltaY||i.wheelDelta||-i.deltaY,r=t._getXY(i);return _handleMouseWheel(t,e,r.x,r.y,i),!1}),t.groupEvent.addEventListener('wheel',(i)=>{var e=t._getXY(i),r=i.wheelDeltaY||i.wheelDelta||-i.deltaY;return _handleMouseWheel(t,r,e.x,e.y,i),!1})}function _handleMouseDown(t,i,r,a){return t.forcedPlugin?(t.activePlugin=t.forcedPlugin,void t._pluginExecute(t.activePlugin,'onMouseDown',[t,i,r,a])):void(t.activePlugin&&(t.activePlugin=!1),checkMouseActions(t,a,[t,i,r,a],'onMouseDown'))}function _handleMouseMove(t,r,a,s){if(t.bypassHandleMouse)return void t.bypassHandleMouse.handleMouseMove(s);if(!(t.activePlugin&&t._pluginExecute(t.activePlugin,'onMouseMove',[t,r,a,s]))){if(t._applyToAxes('handleMouseMove',[r-t.options.paddingLeft,s],!0,!1),t._applyToAxes('handleMouseMove',[a-t.options.paddingTop,s],!1,!0),!t.activePlugin){var e;if(t.options.trackingLine&&t.options.trackingLine.enable&&t.options.trackingLine.snapToSerie&&'common'==t.options.trackingLine.mode){var n=t.options.trackingLine.snapToSerie;if(e=n.handleMouseMove(!1,!0),this.trackingObject)if(!e)t.trackingObject.hide();else{t.trackingObject.show(),t.trackingObject.getPosition(0).x=e.xClosest,t.trackingObject.getPosition(1).x=e.xClosest,t.trackingObject.redraw();var r=n.getXAxis().getPx(e.xClosest)+t.options.paddingLeft}var o=t.options.trackingLine.series;o||(o=t.getSeries().map(function(e){return{serie:e,withinPx:20,withinVal:-1}})),t._trackingLegend=_trackingLegendSerie(t,o,r,a,t._trackingLegend,t.options.trackingLine.textMethod,e.xClosest)}}if(t.options.onMouseMoveData){for(var l={},p=0;p<t.series.length;p++)l[t.series[p].getName()]=t.series[p].handleMouseMove(!1,!0);t.options.onMouseMoveData.call(t,s,l)}checkMouseActions(t,s,[t,r,a,s],'onMouseMove')}}function checkMouseActions(t,r,e,a){var s=t.options.mouseActions,n=!1,o,i;for(o=0,i=s.length;o<i;o++)if(s[o].plugin){if(t.forcedPlugin==s[o].plugin||t.isActionAllowed(r,s[o])){s[o].options&&e.push(s[o].options),'wheel'!==r.type&&'mousewheel'!==r.type&&(t.activePlugin=s[o].plugin),t._pluginExecute(s[o].plugin,a,e),n=!0;continue}}else if(s[o].callback&&t.isActionAllowed(r,s[o])){s[o].options&&e.push(s[o].options),s[o].callback.apply(t,e),n=!0;continue}else if(s[o].series){var l;'all'===s[o].series&&(l=t.series),Array.isArray(s[o].series)||(l=[l]),s[o].options&&e.push(s[o].options);for(;0<l.length;o++)t._serieExecute(l[o],a,e);n=!0;continue}return n}var _trackingLegendSerie=function(e,t,i,r,a,s,n){var o=Math.abs,l=!1;Array.isArray(t)||(t=[t]);var p=[];if(!a&&e.options.trackingLine.legend&&(l=!0,a=_makeTrackingLegend(e)),t.map((t)=>{var r=t.serie.handleMouseMove(n,!1);if(!r||!s)return t.serie.trackingShape&&t.serie.trackingShape.hide(),a;if(0<t.withinPx&&1e-14<o(i-e.options.paddingLeft-t.serie.getXAxis().getPx(r.xClosest))-t.withinPx||0<t.withinVal&&o(t.serie.getXAxis().getVal(i-e.options.paddingLeft)-r.xClosest)-t.withinVal>t.serie.getXAxis().getVal(i-e.options.paddingLeft)/1e5)t.serie.trackingShape&&t.serie.trackingShape.hide();else{p[t.serie.getName()]={yValue:r.xClosest,xValue:r.yClosest,serie:t,index:r};let i;if(i=e.options.trackingLine&&e.options.trackingLine.serieShape?e.options.trackingLine.serieShape:{shape:'ellipse',properties:{rx:[3*t.serie.getLineWidth()+'px'],ry:[3*t.serie.getLineWidth()+'px']}},t.serie.trackingShape||(t.serie.trackingShape=e.newShape(i.shape,{fillColor:t.serie.getLineColor(),strokeColor:'White',strokeWidth:t.serie.getLineWidth()},!0,i.properties).setSerie(t.serie).forceParentDom(t.serie.groupMain).draw(),i.onCreated&&i.onCreated(t.serie.trackingShape),t.serie.trackingShape.on('changed',()=>{i.onChanged&&i.onChanged(t.serie.trackingShape)})),t.serie.trackingShape.show(),t.serie.trackingShape.getPosition(0).x=r.xClosest,i.magnet){let e=i.magnet,a=e.within,s;e.withinPx&&(a=t.serie.getXAxis().getRelVal(e.withinPx)),(s=t.serie.findLocalMinMax(r.xClosest,a,e.mode))&&(t.serie.trackingShape.getPosition(0).x=s)}t.serie.trackingShape.redraw()}}),!!e.options.trackingLine.legend){if(0==Object.keys(p).length||!s)a.style.display='none';else{'none'==a.style.display||l?forceTrackingLegendMode(e,a,i,r,!0):_trackingLegendMove(e,a,i,r),a.style.display='block';var d=s(p,n,i,r);a.innerHTML=d}return a}},forceTrackingLegendMode=function(e,t,i,r,a){function s(){var e=(Date.now()-n)/200;1<e&&(e=1),t.style.marginLeft=(i-l)*e+l+'px',t.style.marginTop=(r-p)*e+p+'px',1>e&&window.requestAnimationFrame(s)}var n=Date.now(),o=t.offsetHeight,l=parseInt(t.style.marginLeft.replace('px','')||0),p=parseInt(t.style.marginTop.replace('px','')||0);return i=i>e.getWidth()/2?i-i%10-20-t.offsetWidth:i-i%10+30,r=r-r%10+o/2,a?(t.style.marginLeft=i+'px',void(t.style.marginTop=r+'px')):void window.requestAnimationFrame(s)},_trackingLegendMove=debounce(forceTrackingLegendMode,50);function _makeTrackingLegend(e){var t=document.createElement('div');return t.setAttribute('class','trackingLegend'),t.style.position='absolute',t.style.borderRadius='4px',t.style.boxShadow='1px 1px 3px 0px rgba(100,100,100,0.6)',t.style.border='2px solid #333333',t.style.backgroundColor='rgba(255, 255, 255, 0.5 )',t.style.pointerEvents='none',t.style.paddingTop='5px',t.style.paddingBottom='5px',t.style.paddingLeft='10px',t.style.paddingRight='10px',e.getWrapper().insertBefore(t,e.getDom()),t}function _handleDblClick(t,i,r,a){t.options.dblclick;checkMouseActions(t,a,[i,r,a],'onDblClick')}function _handleMouseUp(t,i,r,a){return t.bypassHandleMouse?(t.bypassHandleMouse.handleMouseUp(a),void(t.activePlugin=!1)):void(t._pluginExecute(t.activePlugin,'onMouseUp',[t,i,r,a]),t.activePlugin=!1)}function _handleClick(t,i,r,a){t.emit('click',[t,i,r,a]),checkMouseActions(t,a,[i,r,a],'onClick'),a.target.jsGraphIsShape||t.prevent(!1)||!t.options.shapesUnselectOnClick||t.unselectShapes()}function _getAxis(e,t,i,r){var i=i||{},a={def:{x:e.getConstructor('graph.axis.x'),y:e.getConstructor('graph.axis.y')},time:{x:e.getConstructor('graph.axis.x.time')},bar:{x:e.getConstructor('graph.axis.x.bar')}},s;switch(i.type){case'time':var n=a.time;break;case'bar':var n=a.bar;break;case'broken':var n=a.broken;break;default:var n=a.def;}return'top'===r||'bottom'===r?s=n.x:'left'===r||'right'===r?s=n.y:void 0,t=t||0,'object'==typeof t&&(i=t,t=0),e.axis[r][t]||(e.axis[r][t]=new s(e,r,i),e.axis[r][t].init(e,i)),e.axis[r][t]}function _closeLine(e,t,i,r,a,s){if(!1!==e.options.close){var n=0;e.axis[t].map(function(e){e.isDisplayed()&&!e.floating&&n++}),(!0===e.options.close||e.options.close[t])&&0==n?(e.closingLines[t].setAttribute('display','block'),e.closingLines[t].setAttribute('x1',i),e.closingLines[t].setAttribute('x2',r),e.closingLines[t].setAttribute('y1',a),e.closingLines[t].setAttribute('y2',s)):e.closingLines[t].setAttribute('display','none')}}function _handleMouseWheel(t,i,r,a,s){checkMouseActions(t,s,[i,s,r,a],'onMouseWheel')&&(s.preventDefault(),s.stopPropagation())}function _handleMouseLeave(e){e.options.handleMouseLeave&&e.options.handleMouseLeave.call(e)}function haveAxesChanged(e){var t=e._axesHaveChanged;return e._axesHaveChanged=!1,t}function hasSizeChanged(e){var t=e._sizeChanged;return e._sizeChanged=!1,t}Graph$1.SERIE_LINE=Symbol(),Graph$1.SERIE_SCATTER=Symbol(),Graph$1.SERIE_CONTOUR=Symbol(),Graph$1.SERIE_BAR=Symbol(),Graph$1.SERIE_BOX=Symbol(),Graph$1.SERIE_ZONE=Symbol(),Graph$1.SERIE_LINE_COLORED=Symbol(),Graph$1.SERIE_ZONE=Symbol(),Graph$1.SERIE_DENSITYMAP=Symbol(),Graph$1.SERIE_LINE_3D=Symbol(),Graph$1.SERIE_ZONE_3D=Symbol(),Graph$1.TICKS_OUTSIDE=Symbol(),Graph$1.TICKS_INSIDE=Symbol(),Graph$1.TICKS_CENTERED=Symbol(),Graph$1.ns='http://www.w3.org/2000/svg',Graph$1.nsxlink='http://www.w3.org/1999/xlink';var legendDefaults={backgroundColor:'rgba(255, 255, 255, 0.8)',frame:!0,frameWidth:1,frameColor:'black',paddingTop:10,paddingLeft:10,paddingBottom:10,paddingRight:10,color:'black',frameRounding:0,movable:!1,shapesToggleable:!0,isSerieHideable:!0,isSerieSelectable:!0};class Legend{constructor(e,t){this.options=extend({},legendDefaults,t),this.graph=e,this.svg=document.createElementNS(this.graph.ns,'g'),this.subG=document.createElementNS(this.graph.ns,'g'),this.groups=[],this.rect=document.createElementNS(this.graph.ns,'rect'),this.rectBottom=document.createElementNS(this.graph.ns,'rect'),this.rect.setAttribute('x',0),this.rect.setAttribute('y',0),this.rectBottom.setAttribute('x',0),this.rectBottom.setAttribute('y',0),this.series=!1,this.svg.setAttribute('display','none'),this.pos={x:void 0,y:void 0,transformX:0,transformY:0},this.setEvents(),this.eyeId=guid(),this.eyeCrossedId=guid();var i=SVGParser('<svg xmlns="http://www.w3.org/2000/svg"><symbol id="'+this.eyeCrossedId+'" viewBox="0 -256 1850 1850"><rect pointer-events="fill" fill="transparent" x="-256" y="0" width="2106" height="1850" /><g transform="matrix(1,0,0,-1,30.372881,1214.339)"><path d="m 555,201 78,141 q -87,63 -136,159 -49,96 -49,203 0,121 61,225 Q 280,812 128,576 295,318 555,201 z m 389,759 q 0,20 -14,34 -14,14 -34,14 -125,0 -214.5,-89.5 Q 592,829 592,704 q 0,-20 14,-34 14,-14 34,-14 20,0 34,14 14,14 14,34 0,86 61,147 61,61 147,61 20,0 34,14 14,14 14,34 z m 363,191 q 0,-7 -1,-9 Q 1201,954 991,576 781,198 675,9 l -49,-89 q -10,-16 -28,-16 -12,0 -134,70 -16,10 -16,28 0,12 44,87 Q 349,154 228.5,262 108,370 20,507 0,538 0,576 q 0,38 20,69 153,235 380,371 227,136 496,136 89,0 180,-17 l 54,97 q 10,16 28,16 5,0 18,-6 13,-6 31,-15.5 18,-9.5 33,-18.5 15,-9 31.5,-18.5 16.5,-9.5 19.5,-11.5 16,-10 16,-27 z m 37,-447 Q 1344,565 1265,450.5 1186,336 1056,286 l 280,502 q 8,-45 8,-84 z m 448,-128 q 0,-35 -20,-69 Q 1733,443 1663,362 1513,190 1315.5,95 1118,0 896,0 l 74,132 q 212,18 392.5,137 180.5,119 301.5,307 -115,179 -282,294 l 63,112 q 95,-64 182.5,-153 87.5,-89 144.5,-184 20,-34 20,-69 z" fill="#c0c0c0"></path></g></symbol></svg>'),r=SVGParser('<svg xmlns="http://www.w3.org/2000/svg"><symbol id="'+this.eyeId+'" viewBox="0 -256 1850 1850"><rect pointer-events="fill" x="-256" y="0" fill="transparent" width="2106" height="1850" /><g transform="matrix(1,0,0,-1,30.372881,1259.8983)"><path d="m 1664,576 q -152,236 -381,353 61,-104 61,-225 0,-185 -131.5,-316.5 Q 1081,256 896,256 711,256 579.5,387.5 448,519 448,704 448,825 509,929 280,812 128,576 261,371 461.5,249.5 662,128 896,128 1130,128 1330.5,249.5 1531,371 1664,576 z M 944,960 q 0,20 -14,34 -14,14 -34,14 -125,0 -214.5,-89.5 Q 592,829 592,704 q 0,-20 14,-34 14,-14 34,-14 20,0 34,14 14,14 14,34 0,86 61,147 61,61 147,61 20,0 34,14 14,14 14,34 z m 848,-384 q 0,-34 -20,-69 Q 1632,277 1395.5,138.5 1159,0 896,0 633,0 396.5,139 160,278 20,507 0,542 0,576 q 0,34 20,69 140,229 376.5,368 236.5,139 499.5,139 263,0 499.5,-139 236.5,-139 376.5,-368 20,-35 20,-69 z" fill="#444444" /></g></symbol></svg>');this.svg.appendChild(document.adoptNode(r.documentElement.firstChild)),this.svg.appendChild(document.adoptNode(i.documentElement.firstChild)),this.svg.appendChild(this.subG),this.applyStyle()}setPosition(e,t,i){e&&(this.position=e,this.alignToX=t||'left',this.alignToY=i||'top')}setDraggable(e){this.options.movable=e}setAutoPosition(e){return-1<['bottom','left','top','right'].indexOf(e=e.toLowerCase())?(this.autoPosition=e,this):void(this.requireDelayedUpdate(),this.autoPosition=!1)}autoPosition(){return this.setAutoPosition(...arguments)}buildLegendBox(){var e=this.series||this.graph.getSeries(),t=0,r=this.options.paddingTop;this.autoPosition?this.graph.getDom().appendChild(this.getDom()):this.graph.graphingZone.appendChild(this.getDom());for(var a=0,i=e.length;a<i;a++)if(!e[a].excludedFromLegend||this.series){if('bottom'==this.autoPosition||'top'==this.autoPosition){var s=getBBox(this.groups[a]);t+s.width>this.graph.getDrawingWidth()-this.options.paddingRight&&(r+=16,t=0)}this.groups[a].setAttribute('transform','translate( '+t+', '+r+')'),'bottom'==this.autoPosition||'top'==this.autoPosition?(t+=s.width+10,r+=0):(t=0,r+=16)}var s=getBBox(this.subG);switch(this.width=s.width+this.options.paddingRight+this.options.paddingLeft,this.height=s.height+this.options.paddingBottom+this.options.paddingTop,this.rect.setAttribute('width',this.width),this.rect.setAttribute('height',this.height),this.rect.setAttribute('fill','none'),this.rect.setAttribute('pointer-events','fill'),this.rect.setAttribute('display','none'),this.options.movable&&(this.rectBottom.style.cursor='move'),this.rectBottom.setAttribute('width',this.width),this.rectBottom.setAttribute('height',this.height),this.rectBottom.setAttribute('x',s.x-this.options.paddingLeft),this.rectBottom.setAttribute('y',s.y-this.options.paddingTop),this.position=this.position||{},this.autoPosition){case'bottom':this.position.y=this.graph.getHeight()+'px',this.position.x=(this.graph.drawingSpaceWidth-this.width)/2+this.graph.drawingSpaceMinX+'px',this.alignToY='bottom',this.alignToX=!1;break;case'left':this.position.x='6px',this.position.y=(this.graph.getHeight()-this.height)/2+'px',this.alignToX='left',this.alignToY=!1;break;case'right':this.position.x=this.graph.getWidth()+'px',this.position.y=(this.graph.getHeight()-this.height)/2+'px',this.alignToX='right',this.alignToY=!1;break;case'top':this.position.x=(this.graph.drawingSpaceWidth-this.width)/2+this.graph.drawingSpaceMinX+'px',this.position.y='10px',this.alignToY='top',this.alignToX=!1;}if(this.autoPosition){switch(this.autoPosition){case'bottom':this.graph.options.paddingBottom=this.height+10;break;case'left':this.graph.options.paddingLeft=this.width+5;break;case'right':this.graph.options.paddingRight=this.width+10;break;case'top':this.graph.options.paddingTop=this.height+14;}this.graph.updateGraphingZone(),this.graph.getDrawingHeight(),this.graph.getDrawingWidth()}this.bbox=s}calculatePosition(){var e=Position.check(this.position);let t=e.compute(this.graph,this.graph.getXAxis(),this.graph.getYAxis());t&&('max'==e.y&&(t.y+=this.graph.getPaddingTop()),'max'==e.x&&(t.x-=this.graph.getPaddingRight()),'right'==this.alignToX&&(t.x-=this.width,t.x-=this.bbox.x),'bottom'==this.alignToY?(t.y-=this.height,t.y-=this.bbox.y):t.y-=this.bbox.y,this.pos.transformX=t.x,this.pos.transformY=t.y,this._setPosition())}update(e){if(!(this.graph.isDelayedUpdate()||!this._requiredUpdate&&e)){this._requiredUpdate=!1;var t=this;for(this.applyStyle();this.subG.hasChildNodes();)this.subG.removeChild(this.subG.lastChild);this.svg.insertBefore(this.rectBottom,this.svg.firstChild);var r=this.series||this.graph.getSeries();if(0<r.length)this.svg.setAttribute('display','block');else return;if('bottom'==this.autoPosition||'top'==this.autoPosition)this.graph.getDrawingWidth();for(var a=0,i=r.length;a<i;a++)(!r[a].excludedFromLegend||this.series)&&function(i){var e,s,n;if('bottom'==this.autoPosition||'top'==this.autoPosition)this.graph.getDrawingWidth();e=document.createElementNS(t.graph.ns,'g');var o=document.createElementNS(t.graph.ns,'rect');t.subG.appendChild(e),e.appendChild(o);var s=r[i].getSymbolForLegend(),l=r[i].getMarkerForLegend(),n=r[i].getTextForLegend(),p=35;if(this.isHideable()){p+=20;var d=document.createElementNS(t.graph.ns,'use');d.setAttributeNS('http://www.w3.org/1999/xlink','xlink:href','#'+(r[a].isShown()?this.eyeId:this.eyeCrossedId)),d.setAttribute('width',15),d.setAttribute('height',15),d.setAttribute('x',35),d.setAttribute('y',-8),d.addEventListener('click',function(a){a.stopPropagation();var e;r[i].isShown()?(r[i].hide(t.options.hideShapesOnHideSerie),e=t.eyeCrossedId):(r[i].show(t.options.hideShapesOnHideSerie),e=t.eyeId),d.setAttributeNS('http://www.w3.org/1999/xlink','xlink:href','#'+e)})}n.setAttribute('transform','translate('+p+', 3)'),n.setAttribute('fill',this.options.color),s&&e.appendChild(s),'scatter'==r[i].getType()&&s.setAttribute('transform','translate( 20, 0 )'),l&&e.appendChild(l),d&&e.appendChild(d),e.appendChild(n);var g=getBBox(e);o.setAttribute('x',g.x),o.setAttribute('y',g.y),o.setAttribute('width',g.width),o.setAttribute('height',g.height),o.setAttribute('fill','none'),o.setAttribute('pointer-events','fill'),t.groups[i]=e,e.addEventListener('click',function(a){var e=r[i];e.isShown()&&(t.isSelectable()&&!e.isSelected()?t.graph.selectSerie(e):t.graph.unselectSerie(e),a.preventDefault(),a.stopPropagation())})}.call(this,a);this.svg.appendChild(this.rect),this.buildLegendBox(),this.calculatePosition()}}isHideable(){return this.options.isSerieHideable}notHideable(){return this.options.isSerieHideable=!1,this}hideable(){return this.options.isSerieHideable=!0,this}set seriesHideable(e){this.options.isSerieHideable=!!e}get seriesHideable(){return this.options.isSerieHideable}isSelectable(){return this.options.isSerieSelectable}isToggleShapes(){return this.options.shapesToggleable}getDom(){return this.svg}setEvents(){var t=this,i=this.pos;this.svg.addEventListener('mousedown',function(r){r.stopPropagation(),console.log('down'),t.options.movable&&(i.x=r.clientX,i.y=r.clientY,r.preventDefault(),t.mousedown=!0,t.graph.elementMoving(t),t.rect.setAttribute('display','block'))}),this.svg.addEventListener('click',function(t){t.stopPropagation()}),this.svg.addEventListener('dblclick',function(t){t.stopPropagation()}),this.svg.addEventListener('mousemove',function(i){t.handleMouseMove(i)})}handleMouseUp(t){t.stopPropagation(),t.preventDefault(),this.mousedown=!1,this.rect.setAttribute('display','none'),this.graph.elementMoving(!1)}handleMouseMove(t){if(this.mousedown){var e=this.pos,i=t.clientX-e.x,r=t.clientY-e.y;e.transformX+=i,e.transformY+=r,e.x=t.clientX,e.y=t.clientY,t.stopPropagation(),t.preventDefault(),this._setPosition()}}_setPosition(){var e=this.pos;isNaN(e.transformX)||isNaN(e.transformY)||!1===e.transformX||!1===e.transformY||this.svg.setAttribute('transform','translate('+e.transformX+', '+e.transformY+')')}applyStyle(){this.options.frame&&(this.rectBottom.setAttribute('stroke',this.options.frameColor),this.rectBottom.setAttribute('stroke-width',this.options.frameWidth+'px'),this.rectBottom.setAttribute('rx',this.options.frameRounding),this.rectBottom.setAttribute('ry',this.options.frameRounding)),this.rectBottom.setAttribute('fill',this.options.backgroundColor)}fixSeries(){var e=[];if(!1===arguments[0])return this.series=!1,void this.update();for(var t=0,i=arguments.length;t<i;t++)Array.isArray(arguments[t])?e=e.concat(arguments[t]):e.push(arguments[t]);this.update(),this.series=e}fixSeriesAdd(e){this.series=this.series||[],this.series.push(e)}requireDelayedUpdate(){this._requiredUpdate=!0}}function getBBox(e){try{return e.getBBox()}catch(t){return{height:0,width:0,x:0,y:0}}}const defaults={lineAt:!1,display:!0,flipped:!1,axisDataSpacing:{min:0.1,max:0.1},unitModification:!1,primaryGrid:!0,secondaryGrid:!0,primaryGridColor:'#f0f0f0',secondaryGridColor:'#f0f0f0',primaryGridWidth:1,secondaryGridWidth:1,hideWhenNoSeriesShown:!1,shiftToZero:!1,tickPosition:1,nbTicksPrimary:3,nbTicksSecondary:10,ticklabelratio:1,exponentialFactor:0,exponentialLabelFactor:0,logScale:!1,forcedMin:!1,forcedMax:!1,span:[0,1],marginMin:0,marginMax:0,scientificScale:!1,scientificScaleExponent:!1,engineeringScale:!1,unitInTicks:!1,unit:!1,unitWrapperBefore:'',unitWrapperAfter:'',splitMarks:!1,tickLabelOffset:0,useKatexForLabel:!1};class Axis extends EventEmitter{constructor(){super()}init(e,t,i){this.unitModificationTimeTicks=[[1,[1,2,5,10,20,30]],[60,[1,2,5,10,20,30]],[3600,[1,2,6,12]],[86400,[1,2,3,4,5,10,20,40]]],this.graph=e,this.options=extend(!0,{},defaults,i,t),this.group=document.createElementNS(this.graph.ns,'g'),this.hasChanged=!0,this.rectEvent=document.createElementNS(this.graph.ns,'rect'),this.rectEvent.setAttribute('pointer-events','fill'),this.rectEvent.setAttribute('fill','transparent'),this.group.appendChild(this.rectEvent),this.graph.axisGroup.appendChild(this.group),this._lines=[],this.line=document.createElementNS(this.graph.ns,'line'),this.line.setAttribute('stroke','black'),this.line.setAttribute('shape-rendering','crispEdges'),this.line.setAttribute('stroke-linecap','square'),this.groupTicks=document.createElementNS(this.graph.ns,'g'),this.groupTickLabels=document.createElementNS(this.graph.ns,'g'),this.group.appendChild(this.groupTicks),this.group.appendChild(this.groupTickLabels),this.group.appendChild(this.line),this.label=document.createElementNS(this.graph.ns,'text'),this.labelTspan=document.createElementNS(this.graph.ns,'tspan'),this.preunit='',this.unitTspan=document.createElementNS(this.graph.ns,'tspan'),this.expTspan=document.createElementNS(this.graph.ns,'tspan'),this.expTspanExp=document.createElementNS(this.graph.ns,'tspan'),this.label.appendChild(this.labelTspan),this.label.appendChild(this.unitTspan),this.label.appendChild(this.expTspan),this.label.appendChild(this.expTspanExp),this.expTspan.setAttribute('dx',6),this.expTspanExp.setAttribute('dy',-5),this.expTspanExp.setAttribute('font-size','0.8em'),this.label.setAttribute('text-anchor','middle'),this.setTickPosition(this.options.tickPosition),this.gridLinePath={primary:'',secondary:''},this.gridPrimary=document.createElementNS(this.graph.ns,'path'),this.gridSecondary=document.createElementNS(this.graph.ns,'path'),this.graph.groupPrimaryGrids.appendChild(this.gridPrimary),this.graph.groupSecondaryGrids.appendChild(this.gridSecondary),this.setGridLinesStyle(),this.group.appendChild(this.label),this.groupSeries=document.createElementNS(this.graph.ns,'g'),this.group.appendChild(this.groupSeries),this.widthHeightTick=0,this.ticks={},this.ticksLabels=[],this.tickScaling={1:3,2:2,3:1,4:0.5},this.currentTick={},this.lastCurrentTick={},this.series=[],this.totalDelta=0,this.currentAction=!1,this.group.addEventListener('mousemove',(t)=>{t.preventDefault();var e=this.graph._getXY(t);this.handleMouseMoveLocal(e.x,e.y,t);for(var r=0,i=this.series.length;r<i;r++)this.series[r].handleMouseMove(!1,!0)}),this.labels=[],this.group.addEventListener('click',(t)=>{t.preventDefault();var e=this.graph._getXY(t);this.addLabel(this.getVal(e.x-this.graph.getPaddingLeft()))}),this.gridPrimary.setAttribute('clip-path','url(#_clipplot'+this.graph._creation+')'),this.gridSecondary.setAttribute('clip-path','url(#_clipplot'+this.graph._creation+')'),this.graph._axisHasChanged(this)}handleMouseMoveLocal(){}hide(){return this.options.display=!1,this}show(){return this.options.display=!0,this}setDisplay(e){return this.options.display=!!e,this}isDisplayed(){return this.options.hideWhenNoSeriesShown?this.graph.getSeriesFromAxis(this).reduce((e,t)=>e||t.isShown(),!1):this.options.display}isShown(){return this.isDisplayed(...arguments)}hideGroup(){this._hidden||(this._hidden=!0,this.group.setAttribute('display','none'))}showGroup(){this._hidden&&(this._hidden=!1,this.group.setAttribute('display','initial'))}kill(e,t){this.graph.killAxis(this,e,t)}setLineAt(e){return this.options.lineAt=e,this}adaptTo(e,t,i,r){return e?(this.options.adaptTo={axis:e,thisValue:t,foreignValue:i,preference:r},this.adapt(),this):(this.options.adaptTo=!1,this)}adapt(){if(this.options.adaptTo){var e=this.options.adaptTo.axis,t=this.options.adaptTo.thisValue,i=this.options.adaptTo.foreignValue;if((void 0===e.currentAxisMin||void 0===e.currentAxisMax)&&e.setMinMaxToFitSeries(),!1!==this.options.forcedMin&&!1==this.options.forcedMax||'max'!==this.options.adaptTo.preference){this.currentAxisMin=!1===this.options.forcedMin?this._zoomed?this.getCurrentMin():this.getMinValue()-(t-this.getMinValue())*(this.options.axisDataSpacing.min*(e.getCurrentMax()-e.getCurrentMin())/(i-e.getCurrentMin())):this.options.forcedMin,this.currentAxisMin==t&&(this.currentAxisMin-=this.options.axisDataSpacing.min*this.getInterval());var r=!1===this.options.forcedMin?this.currentAxisMin:this.options.forcedMin;this.currentAxisMax=(t-r)*(e.getCurrentMax()-e.getCurrentMin())/(i-e.getCurrentMin())+r}else{this.currentAxisMax=!1===this.options.forcedMax?this._zoomed?this.getCurrentMax():this.getMaxValue()+(this.getMaxValue()-t)*(this.options.axisDataSpacing.max*(e.getCurrentMax()-e.getCurrentMin())/(e.getCurrentMax()-i)):this.options.forcedMax,this.currentAxisMax==t&&(this.currentAxisMax+=this.options.axisDataSpacing.max*this.getInterval());var r=!1===this.options.forcedMax?this.currentAxisMax:this.options.forcedMax;this.currentAxisMin=(t-r)*(e.getCurrentMin()-e.getCurrentMax())/(i-e.getCurrentMax())+r}this.graph._axisHasChanged(this)}}setFloating(e,t){return this.floating=!0,this.floatingAxis=e,this.floatingValue=t,this}getFloatingAxis(){return this.floatingAxis}getFloatingValue(){return this.floatingValue}setAxisDataSpacing(e,t){return this.options.axisDataSpacing.min=e,this.options.axisDataSpacing.max=t||e,this}dataSpacing(){return this.setAxisDataSpacing(...arguments)}setAxisDataSpacingMin(e){this.options.axisDataSpacing.min=e}setAxisDataSpacingMax(e){this.options.axisDataSpacing.max=e}setMinPx(e){this.minPx=e,this.setMinMaxFlipped()}setMaxPx(e){this.maxPx=e,this.setMinMaxFlipped()}getMinPx(){return this.minPxFlipped}getMaxPx(){return this.maxPxFlipped}getMathMaxPx(){return this.maxPx}getMathMinPx(){return this.minPx}getMinValue(){return!1===this.options.forcedMin?this.dataMin:this.options.forcedMin}getMaxValue(){return!1===this.options.forcedMax?this.dataMax:this.options.forcedMax}setMinValueData(e){this.dataMin=e,isNaN(this.getCurrentMin())}setMaxValueData(e){this.dataMax=e,isNaN(this.getCurrentMax())}getDataMax(){return this.dataMax}getDataMin(){return this.dataMin}forceMin(e,t=!1){return this.options.forcedMin=e,this.setCurrentMin(t?this.getCurrentMin():void 0),this.graph._axisHasChanged(this),this}forceMax(e,t=!1){return this.options.forcedMax=e,this.setCurrentMax(t?this.getCurrentMax():void 0),this.graph._axisHasChanged(this),this}getForcedMin(){return this.options.forcedMin}getForcedMax(){return this.options.forcedMax}forceToAxis(e){return e.getMaxValue&&e.getMinValue&&(this.options.forcedMin=e.getMinValue(),this.options.forcedMax=e.getMaxValue()),this}getNbTicksPrimary(){return this.options.nbTicksPrimary}setNbTicksPrimary(e){this.options.nbTicksPrimary=e}getNbTicksSecondary(){return this.options.nbTicksSecondary}setNbTicksSecondary(e){return this.options.nbTicksSecondary=e,this}handleMouseMove(e){this.mouseVal=this.getVal(e)}handleMouseWheel(t,i,e){t=Math.min(0.2,Math.max(-0.2,t)),'min'==e?e=this.getMinValue():'max'==e?e=this.getMaxValue():!e&&(e=0),this._doZoomVal((this.getCurrentMax()-e)*(1+t)+e,(this.getCurrentMin()-e)*(1+t)+e),this.graph.draw()}set zoomLock(e){this._zoomLocked=e}get zoomLock(){return this._zoomLocked||!1}zoom(e,t,i){return!i&&this.zoomLock?void 0:this._doZoomVal(e,t,!0)}_doZoomVal(e,t,i){return this._doZoom(this.getPx(e),this.getPx(t),e,t,i)}_doZoom(e,t,i,r,a){var i=void 0===i?this.getVal(e):i,r=void 0===r?this.getVal(t):r;return this.setCurrentMin(Math.min(i,r)),this.setCurrentMax(Math.max(i,r)),this.cacheCurrentMin(),this.cacheCurrentMax(),this.cacheInterval(),this._zoomed=!0,this.adapt(),this._hasChanged=!0,a||this.emit('zoom',[this.currentAxisMin,this.currentAxisMax,this]),this}getSerieShift(){return this._serieShift}getSerieScale(){return this._serieScale}getMouseVal(){return this.mouseVal}getUnitPerTick(e,t,i){var r=Math.pow,a=Math.abs,s=e/c;t=t?Math.min(t,e/10):e/10;var n=i/t;switch(this.options.unitModification){case'time':case'time:min.sec':{let e=!1,t,i,r,a;for(t=0,i=this.unitModificationTimeTicks.length;t<i;t++){for(r=0,a=this.unitModificationTimeTicks[t][1].length;r<a;r++)if(n<this.unitModificationTimeTicks[t][0]*this.unitModificationTimeTicks[t][1][r]){e=!0;break}if(e)break}g=t===this.unitModificationTimeTicks.length?1:this.unitModificationTimeTicks[t][0]*this.unitModificationTimeTicks[t][1][r];break}default:{var o=Math.floor(Math.log(n)/2.302585092994046),l=n*r(10,-o);this.decimals=-o;var p=[1,2,5,10],d=!1;for(let e=p.length-1;0<=e;e--)(!d||a(p[e]-l)<a(d-l))&&(d=p[e]);var g=d*r(10,o);break}}var c=i/g,s=e/t;return[g,c,s]}setMinMaxToFitSeries(e){var t=Math.max,i=this.getInterval();return this.options.logScale?(this.currentAxisMin=t(1e-50,0.9*this.getMinValue()),this.currentAxisMax=t(1e-50,1.1*this.getMaxValue())):(this.currentAxisMin=this.getMinValue(),this.currentAxisMax=this.getMaxValue(),!1===this.getForcedMin()&&(this.currentAxisMin-=this.options.axisDataSpacing.min*i),!1===this.getForcedMax()&&(this.currentAxisMax+=this.options.axisDataSpacing.max*i)),(isNaN(this.currentAxisMin)||isNaN(this.currentAxisMax))&&(this.currentAxisMax=void 0,this.currentAxisMin=void 0),this.cache(),this._zoomed=!1,this.adapt(),e||this.graph._axisHasChanged(this),this.emit('zoomOutFull',[this.currentAxisMin,this.currentAxisMax,this]),this}getInterval(){return this.getMaxValue()-this.getMinValue()}getCurrentInterval(){return this.cachedInterval}getCurrentMin(){return this.cachedCurrentMin}getCurrentMax(){return this.cachedCurrentMax}cacheCurrentMin(){this.cachedCurrentMin=this.currentAxisMin==this.currentAxisMax?this.options.logScale?this.currentAxisMin/10:this.currentAxisMin-1:this.currentAxisMin}cacheCurrentMax(){this.cachedCurrentMax=this.currentAxisMax==this.currentAxisMin?this.options.logScale?10*this.currentAxisMax:this.currentAxisMax+1:this.currentAxisMax}cacheInterval(){this.cachedInterval=this.cachedCurrentMax-this.cachedCurrentMin}cache(){this.cacheCurrentMin(),this.cacheCurrentMax(),this.cacheInterval()}setCurrentMin(e){return(void 0===e||!1!==this.getForcedMin()&&(e<this.getForcedMin()||void 0===e))&&(e=this.getMinValue()),this.currentAxisMin=e,this.options.logScale&&(this.currentAxisMin=Math.max(1e-50,e)),this.cacheCurrentMin(),this.cacheInterval(),this.graph._axisHasChanged(this),this}setCurrentMax(e){(e===void 0||!1!==this.getForcedMax()&&(e>this.getForcedMax()||e===void 0))&&(e=this.getMaxValue()),this.currentAxisMax=e,this.options.logScale&&(this.currentAxisMax=Math.max(1e-50,e)),this.cacheCurrentMax(),this.cacheInterval(),this.graph._axisHasChanged(this)}flip(e){return this.options.flipped=e,this.setMinMaxFlipped(),this}isFlipped(){return this.options.flipped}_draw(){var e=Math.abs,t=this;(void 0===this.currentAxisMin||void 0===this.currentAxisMax)&&this.setMinMaxToFitSeries(!0);var i=e(this.getMaxPx()-this.getMinPx()),r=this.getCurrentInterval();if(!this.isShown())return this.line.setAttribute('display','none'),0;this.line.setAttribute('display','block'),this.scientificExponent=!0==this.options.scientificScale?this.options.scientificScaleExponent?this.options.scientificScaleExponent:Math.floor(Math.log(Math.max(e(this.getCurrentMax()),e(this.getCurrentMin())))/2.302585092994046):0,this.gridLinePath.primary='',this.gridLinePath.secondary='';let a;if(!this.options.useKatexForLabel||!this.graph.hasKatexRenderer())this.options.unitDecade&&this.options.unit&&0!==this.scientificExponent&&(this.scientificExponent=this.getEngineeringExponent(this.scientificExponent))&&(a=this.getExponentGreekLetter(this.scientificExponent))?(this.preunit=a,this.unitTspan.setAttribute('dx',0)):0===this.scientificExponent||isNaN(this.scientificExponent)?(!this.options.unit&&this.unitTspan.setAttribute('display','none'),this.preunit='',this.expTspan.setAttribute('display','none'),this.expTspanExp.setAttribute('display','none')):(this.options.engineeringScale&&(this.scientificExponent=this.getEngineeringExponent(this.scientificExponent)),this.preunit='',this.expTspan.setAttribute('display','visible'),this.expTspanExp.setAttribute('display','visible'),this.expTspan.textContent='x10',this.expTspanExp.textContent=this.scientificExponent),this.writeUnit();else{let e=this.getLabel();this.options.unitDecade&&this.options.unit&&0!==this.scientificExponent&&(this.scientificExponent=this.getEngineeringExponent(this.scientificExponent))&&(a=this.getExponentGreekLetter(this.scientificExponent))?(e+=a,this.preunitTspan.innerHTML=a,this.preunitTspan.setAttribute('display','visible'),this.unitTspan.setAttribute('dx',0),e+=' '+a+' '+this.options.unit):0!==this.scientificExponent&&!isNaN(this.scientificExponent)&&(this.options.engineeringScale&&(this.scientificExponent=this.getEngineeringExponent(this.scientificExponent)),e+=' \\cdot 10^'+this.scientificExponent+' '+this.options.unit),this.katexElement=this.graph.renderWithKatex(e,this.katexElement)}if(!!this.options.hideTicks)var s=0;else if(this.resetTicksLength(),this.linkedToAxis){this.linkedToAxis.deltaPx=10;var s=this.drawLinkedToAxisTicksWrapper(i,r)}else if(!this.options.logScale)var s=this.drawLinearTicksWrapper(i,r);else var s=this.drawLogTicks();this.removeUselessTicks(),this.removeUselessTickLabels(),this.gridPrimary.setAttribute('d',this.gridLinePath.primary),this.gridSecondary.setAttribute('d',this.gridLinePath.secondary);var n=this.graph.findAxesLinkedTo(this);return n.forEach(function(e){e.linkedToAxis&&(e.setMinPx(t.getMinPx()),e.setMaxPx(t.getMaxPx()),e.draw())}),s}drawLines(){this.options.lineAt&&Array.isArray(this.options.lineAt)&&this.options.lineAt.forEach((e,t)=>{!isNaN(e)&&this.getCurrentMin()<=e&&this.getCurrentMax()>=e?this._lines[t]=this._drawLine(e,this._lines[t]):this._hideLine(this._lines[t])})}writeUnit(){this.options.unit?(this.unitTspan.setAttribute('display','visible'),this.unitTspan.setAttribute('dx',5),this.expTspan.setAttribute('display','none'),this.expTspanExp.setAttribute('display','none'),this.unitTspan.innerHTML=(this.options.unitWrapperBefore+this.preunit+this.options.unit+this.options.unitWrapperAfter).replace(/\^([-+0-9]*)(.*)/g,'<tspan dy=\'-5\' font-size=\'0.7em\'>$1</tspan><tspan dy=\'5\' font-size=\'1em\'>$2</tspan>')):this.unitTspan.setAttribute('display','none')}getExponentGreekLetter(e){return 3===e?'k':6===e?'M':9===e?'G':12===e?'T':15===e?'E':-3===e?'m':-6===e?'&mu;':-9===e?'n':-12===e?'p':-15===e?'f':''}drawLinearTicksWrapper(e,t){let i;return this.options.primaryTickUnit?i=this.options.primaryTickUnit:(i=this.getUnitPerTick(e,this.getNbTicksPrimary(),t)[0],this.options.maxPrimaryTickUnit&&this.options.maxPrimaryTickUnit<i?i=this.options.maxPrimaryTickUnit:this.options.minPrimaryTickUnit&&this.options.minPrimaryTickUnit>i&&(i=this.options.minPrimaryTickUnit)),this.drawTicks(i,this.secondaryTicks())}forcePrimaryTickUnit(e){this.options.primaryTickUnit=e,this.decimals=Math.max(0,Math.round(-Math.log(e)/2.302585092994046))}forcePrimaryTickUnitMax(e){this.options.maxPrimaryTickUnit=e}forcePrimaryTickUnitMin(e){this.options.minPrimaryTickUnit=e}getPrimaryTickUnit(){return this.incrTick}setTickLabelRatio(e){this.options.ticklabelratio=e}doesHideWhenNoSeriesShown(){return this.options.hideWhenNoSeriesShown}draw(){this._widthLabels=0;var e=this._draw();return this._widthLabels+=e,e}drawTicks(e,t){var i=e,r=this.getCurrentMin(),a=this.getCurrentMax(),s=0,n,o,l;for(t&&(n=i/t),o=this.options.shiftToZero?this.dataMin-Math.ceil((this.dataMin-r)/i)*i:Math.floor(r/i)*i,this.incrTick=e;o<=a&&(s++,!(1e3<s));){if(t){l=o+n,this.subIncrTick=l;for(var p=0;l<o+i&&(p++,!(100<p));){if(l<r||l>a){l+=n;continue}this.drawTickWrapper(l,!1,1e-4>Math.abs(l-o-i/2)?2:3),l+=n}}if(o<r||o>a){o+=e;continue}this.drawTickWrapper(o,!0,1),o+=e}return this.widthHeightTick=this.getMaxSizeTick(),this.widthHeightTick}nextTick(e,t){if(this.ticks[e]=this.ticks[e]||[],this.lastCurrentTick[e]=this.lastCurrentTick[e]||0,this.currentTick[e]=this.currentTick[e]||0,this.currentTick[e]>=this.ticks[e].length){var i=document.createElementNS(this.graph.ns,'line');this.groupTicks.appendChild(i),this.ticks[e].push(i),t(i)}var i=this.ticks[e][this.currentTick[e]];return this.currentTick[e]>=this.lastCurrentTick[e]&&i.setAttribute('display','visible'),this.currentTick[e]++,i}nextTickLabel(e){if(this.ticksLabels=this.ticksLabels||[],this.lastCurrentTickLabel=this.lastCurrentTickLabel||0,this.currentTickLabel=this.currentTickLabel||0,this.currentTickLabel>=this.ticksLabels.length){var t=document.createElementNS(this.graph.ns,'text');this.groupTickLabels.appendChild(t),this.ticksLabels.push(t),e(t)}var t=this.ticksLabels[this.currentTickLabel];return this.currentTickLabel>=this.lastCurrentTickLabel&&t.setAttribute('display','visible'),this.currentTickLabel++,t}removeUselessTicks(){for(var e in this.currentTick){for(var t=this.currentTick[e];t<this.ticks[e].length;t++)this.ticks[e][t].setAttribute('display','none');this.lastCurrentTick[e]=this.currentTick[e],this.currentTick[e]=0}}removeUselessTickLabels(){for(var e=this.currentTickLabel;e<this.ticksLabels.length;e++)this.ticksLabels[e].setAttribute('display','none');this.lastCurrentTickLabel=this.currentTickLabel,this.currentTickLabel=0}nextGridLine(e,t,i,r,a){(e&&this.options.primaryGrid||!e&&this.options.secondaryGrid)&&(this.gridLinePath[e?'primary':'secondary']+='M '+t+' '+r+' L '+i+' '+a)}setGridLineStyle(e,t){e.setAttribute('shape-rendering','crispEdges'),e.setAttribute('stroke',t?this.getPrimaryGridColor():this.getSecondaryGridColor()),e.setAttribute('stroke-width',t?this.getPrimaryGridWidth():this.getSecondaryGridWidth()),e.setAttribute('stroke-opacity',t?this.getPrimaryGridOpacity():this.getSecondaryGridOpacity());var i;(i=t?this.getPrimaryGridDasharray():this.getSecondaryGridDasharray())&&e.setAttribute('stroke-dasharray',i)}setGridLinesStyle(){return this.setGridLineStyle(this.gridPrimary,!0),this.setGridLineStyle(this.gridSecondary,!1),this}resetTicksLength(){}secondaryTicks(){return this.options.nbTicksSecondary}drawLogTicks(){var e=Math.pow,t=Math.log,i=this.getCurrentMin(),r=this.getCurrentMax(),a=Math.min(i,r),r=Math.max(i,r);1e-50>a&&(a=1e-50),20<t(a)-t(r)&&(r=e(10,20*t(a)));var s={fontSize:'1.0em',exponential:!0,overwrite:!1};0>a&&(a=0);for(var n=0==a?0:Math.floor(t(a)/2.302585092994046),a=1,o;(o=a*e(10,n))<r;)1==a&&o>i&&this.drawTickWrapper(o,!0,1,s),10==a?(a=1,n++):(1!=a&&o>i&&this.drawTickWrapper(o,!1,2,{overwrite:'',fontSize:'0.6em'}),a++);return this.widthHeightTick=this.getMaxSizeTick(),this.widthHeightTick}drawTickWrapper(e,t,i,r){this.drawTick(e,i,r)}linkToAxis(e,t,i){this.linkedToAxis={axis:e,scalingFunction:t,decimals:i||1}}drawLinkedToAxisTicksWrapper(e,i){var r=this.linkedToAxis,a=0,s,n,o,l;r.deltaPx||(r.deltaPx=10);do{if(s=r.scalingFunction(r.axis.getVal(a+this.getMinPx())),r.decimals&&(this.decimals=r.decimals),n=this.drawTick(s,1,{},a+this.getMinPx()),!n)throw console.error(s,a,this.getMinPx()),new Error('Unable to draw tick. Please report the test-case');if(o=8*(n[1].textContent+'').length,l=5*Math.round(o/5),l>r.deltaPx)return r.deltaPx=l,void this.drawLinkedToAxisTicksWrapper(e,i);a+=r.deltaPx}while(a<e)}getPos(e){return this.getPx(e)}getPx(e){var t=Math.log;if(!this.options.logScale)return(e-this.getCurrentMin())/this.getCurrentInterval()*(this.getMaxPx()-this.getMinPx())+this.getMinPx();if(!(0>e)){var e=(t(e)-t(this.getCurrentMin()))/(t(this.getCurrentMax())-t(this.getCurrentMin()))*(this.getMaxPx()-this.getMinPx())+this.getMinPx();return e}}getRoundedPx(e){return Math.round(10*this.getPx(e))/10}getVal(e){var t=Math.log;return this.options.logScale?Math.exp((e-this.getMinPx())/(this.getMaxPx()-this.getMinPx())*(t(this.getCurrentMax())-t(this.getCurrentMin()))+t(this.getCurrentMin())):(e-this.getMinPx())/(this.getMaxPx()-this.getMinPx())*this.getCurrentInterval()+this.getCurrentMin()}getRelPx(e){return e/this.getCurrentInterval()*(this.getMaxPx()-this.getMinPx())}getRelVal(e){return e/(this.getMaxPx()-this.getMinPx())*this.getCurrentInterval()}valueToText(e){var t=Math.pow;if(this.scientificExponent)return e/=t(10,this.scientificExponent),e.toFixed(1);if(e=e*t(10,this.getExponentialFactor())*t(10,this.getExponentialLabelFactor()),this.options.shiftToZero&&(e-=this.dataMin),this.options.ticklabelratio&&(e*=this.options.ticklabelratio),this.options.unitModification)return e=this.modifyUnit(e,this.options.unitModification),e;var i=this.decimals-this.getExponentialFactor()-this.getExponentialLabelFactor();return isNaN(e)?'':(console.log(i,e,this.decimals,this.getExponentialFactor(),this.getExponentialLabelFactor()),e=0<i?e.toFixed(i):e.toFixed(0),this.options.unitInTicks&&this.options.unit&&(e+=' '+this.options.unit),e)}valueToHtml(e,t,i){var r=this.valueToText(e),a;return this.options.unitDecade&&this.options.unit&&0!==this.scientificExponent&&(this.scientificExponent=this.getEngineeringExponent(this.scientificExponent))&&(a=this.getExponentGreekLetter(this.scientificExponent))?r+=a:0!==this.scientificExponent&&!isNaN(this.scientificExponent)&&!t&&(r+='x10',r+='<sup>'+this.scientificExponent+'</sup>'),this.options.unit&&!i&&(r+=this.options.unit.replace(/\^([-+0-9]*)/g,'<sup>$1</sup>')),r}getModifiedValue(e){return this.options.ticklabelratio&&(e*=this.options.ticklabelratio),this.options.shiftToZero&&(e-=this.getMinValue()*(this.options.ticklabelratio||1)),e}modifyUnit(e,t){var i=Math.floor,r=Math.round,a='',n=this.incrTick,o;switch(t){case'time':var l=this.getModifiedValue(this.getMaxValue()),p=[[60,'min'],[3600,'h'],[86400,'d']];if(3600>l?o=0:86400>l?o=1:2592000>l&&(o=2),!p[o])return!1;e/=p[o][0];var d=i(e);for(a=d+p[o][1],o--;n<1*p[o+1][0]&&-1<o;)e=(e-d)*p[o+1][0]/p[o][0],d=r(e),a+=' '+d+p[o][1],o--;break;case'time:min.sec':e/=60;var d=i(e),g=r(60*(e-d))+'';g=1==g.length?'0'+g:g,a=d+'.'+g;break;default:}return a}getExponentialFactor(){return this.options.exponentialFactor}setExponentialFactor(e){this.options.exponentialFactor=e}setExponentialLabelFactor(e){this.options.exponentialLabelFactor=e}getExponentialLabelFactor(){return this.options.exponentialLabelFactor}setLabel(e){return this.options.labelValue=e,this}setLabelFont(e){return this.options.labelFont=e,this}getLabel(){return this.options.labelValue}setSpan(e,t){return this.options.span=[e,t],this}getSpan(){return this.options.span}setLevel(e){return this._level=e,this}getLevel(){return this._level}setShift(e){this.shift=e}getShift(){return this.shift}setTickPosition(e){switch(e){case 3:case'outside':case Graph$1.TICKS_OUTSIDE:{e=3;break}case 2:case'centered':case Graph$1.TICKS_CENTERED:{e=2;break}case 1:case'inside':case Graph$1.TICKS_INSIDE:default:{e=1;break}}switch(this.options.tickPosition=e,this.options.tickPosition){case 3:this.tickPx1=-2,this.tickPx2=0;break;case 2:this.tickPx1=-1,this.tickPx2=1;break;default:case 1:this.tickPx1=0,this.tickPx2=2;}return this}setGrids(e){return this.options.primaryGrid=e,this.options.secondaryGrid=e,this}setPrimaryGrid(e){return this.options.primaryGrid=e,this}setSecondaryGrid(e){return this.options.secondaryGrid=e,this}primaryGridOn(){return this.setPrimaryGrid(!0)}primaryGridOff(){return this.setPrimaryGrid(!1)}secondaryGridOn(){return this.setSecondaryGrid(!0)}secondaryGridOff(){return this.setSecondaryGrid(!1)}gridsOn(){return this.setGrids(!0)}gridsOff(){return this.setGrids(!1)}turnGridsOff(){return this.gridsOff(...arguments)}turnGridsOn(){return this.gridsOn(...arguments)}setColor(e='black'){return this.options.axisColor=e,this.options.primaryTicksColor=e,this.options.secondaryTicksColor=e,this.options.ticksLabelColor=e,this.options.primaryGridColor=e,this.options.secondaryGridColor=e,this.options.labelColor=e,this}setAxisColor(e){return this.options.axisColor=e,this}getAxisColor(){return this.options.axisColor||'black'}setTickLabelOffset(e){return this.options.tickLabelOffset=e,this}setPrimaryTicksColor(e){return this.options.primaryTicksColor=e,this}getPrimaryTicksColor(){return this.options.primaryTicksColor||'black'}setSecondaryTicksColor(e){return this.options.secondaryTicksColor=e,this}getSecondaryTicksColor(){return this.options.secondaryTicksColor||'black'}setTicksLabelColor(e){return this.options.ticksLabelColor=e,Array.isArray(this.ticksLabels)&&this.ticksLabels.forEach((t)=>{t.setAttribute('fill',e)}),this}getTicksLabelColor(){return this.options.ticksLabelColor||'black'}setPrimaryGridColor(e){return this.options.primaryGridColor=e,this.setGridLinesStyle(),this}getPrimaryGridColor(){return this.options.primaryGridColor}setSecondaryGridColor(e){return this.options.secondaryGridColor=e,this.setGridLinesStyle(),this}getSecondaryGridColor(){return this.options.secondaryGridColor}setPrimaryGridWidth(e){return this.options.primaryGridWidth=e,this.setGridLinesStyle(),this}getPrimaryGridWidth(){return this.options.primaryGridWidth}setSecondaryGridWidth(e){return this.options.secondaryGridWidth=e,this.setGridLinesStyle(),this}getSecondaryGridWidth(){return this.options.secondaryGridWidth}setPrimaryGridOpacity(e){return this.options.primaryGridOpacity=e,this}getPrimaryGridOpacity(){return this.options.primaryGridOpacity}setSecondaryGridOpacity(e){return this.options.secondaryGridOpacity=e,this}getSecondaryGridOpacity(){return this.options.secondaryGridOpacity}setPrimaryGridDasharray(e){return this.options.primaryGridDasharray=e,this}getPrimaryGridDasharray(){return this.options.primaryGridDasharray}setSecondaryGridDasharray(e){return this.options.secondaryGridDasharray=e,this}getSecondaryGridDasharray(){return this.options.secondaryGridDasharray}setLabelColor(e){return this.options.labelColor=e,this}getLabelColor(){return this.options.labelColor}setTickContent(e,t,i){if(i||(i={}),i.overwrite||!i.exponential)e.textContent=i.overwrite||this.valueToText(t);else{var r=Math.round(Math.log(t)/2.302585092994046),a=Math.floor(t*Math.pow(10,-r));e.textContent=1==a?'10':a+'x10';var s=document.createElementNS(this.graph.ns,'tspan');s.textContent=r,s.setAttribute('font-size','0.7em'),s.setAttribute('dy',-5),e.appendChild(s)}i.fontSize&&e.setAttribute('font-size',i.fontSize)}isX(){return!1}isY(){return!1}setUnit(e){return this.options.unit=e,this}setUnitInTicks(e){return this.options.unitInTicks=e,this}setUnitWrapper(e,t){return this.options.unitWrapperBefore=e,this.options.unitWrapperAfter=t,this}setUnitDecade(e){return this.options.unitDecade=e,this}setScientific(e){return this.options.scientificScale=e,this}setScientificScaleExponent(e){return this.options.scientificScaleExponent=e,this}setEngineering(e){return this.options.scientificScale=e,this.options.engineeringScale=e,this}getEngineeringExponent(e){return e-=0<e?e%3:(3- -e%3)%3,e}setLogScale(e){return this.options.logScale=e,this}isZoomed(){return this.currentAxisMin!=this.getMinValue()&&this.currentAxisMax!=this.getMaxValue()}hasAxis(){return!1}getType(){return null}useKatexForLabel(e=!0){return this.options.useKatexForLabel=e,this}}Axis.prototype.getValue=Axis.prototype.getVal,Axis.prototype.getDeltaPx=Axis.prototype.getRelPx;class AxisX extends Axis{constructor(e,t,i={}){super(e,t,i),this.top='top'==t}getAxisPosition(){if(!this.options.display)return 0;let e;return 0==this.options.tickLabelOffset?(e=1==this.options.tickPosition?8:20,e+=1*this.graph.options.fontSize):e=1==this.options.tickPosition?0:12,this.getLabel()&&(e+=this.graph.options.fontSize),e}isX(){return!0}isY(){return!1}setShift(e){this.shift=e;void 0!==this.getShift()&&this.graph.getDrawingHeight()&&this.group.setAttribute('transform','translate(0 '+(this.floating?this.getShift():this.top?this.shift:this.graph.getDrawingHeight()-this.shift)+')')}getMaxSizeTick(){return(this.top?-1:1)*(1==this.options.tickPosition?10:10)}drawTick(e,t,i,r){var a=this,s;if(s=r||this.getPos(e),!(void 0==s||isNaN(s))){var n=this.nextTick(t,function(e){e.setAttribute('y1',(a.top?1:-1)*a.tickPx1*a.tickScaling[t]),e.setAttribute('y2',(a.top?1:-1)*a.tickPx2*a.tickScaling[t]),1==t?e.setAttribute('stroke',a.getPrimaryTicksColor()):e.setAttribute('stroke',a.getSecondaryTicksColor())});if(n.setAttribute('x1',s),n.setAttribute('x2',s),this.nextGridLine(1==t,s,s,0,this.graph.getDrawingHeight()),1==t){var o=this.nextTickLabel((e)=>{e.setAttribute('y',(a.top?-1:1)*((1==a.options.tickPosition?8:20)+(a.top?10:0))+this.options.tickLabelOffset),e.setAttribute('text-anchor','middle'),'black'!==a.getTicksLabelColor()&&e.setAttribute('fill',a.getTicksLabelColor()),e.style.dominantBaseline='hanging'});o.setAttribute('x',s),this.setTickContent(o,e,i)}return[n,o]}}drawLabel(){'black'!==this.getLabelColor()&&this.label.setAttribute('fill',this.getLabelColor()),this.options.labelFont&&this.label.setAttribute('font-family',this.options.labelFont),this.label.setAttribute('text-anchor','middle'),this.label.setAttribute('style','display: initial;'),this.label.setAttribute('x',Math.abs(this.getMaxPx()+this.getMinPx())/2),this.label.setAttribute('y',(this.top?-1:1)*((1==this.options.tickPosition?10:25)+this.graph.options.fontSize)),this.labelTspan.textContent=this.getLabel()}draw(){var e=super.draw(...arguments);return this.drawSpecifics(),e}drawSpecifics(){this.drawLabel(),this.line.setAttribute('x1',this.getMinPx()),this.line.setAttribute('x2',this.getMaxPx()),this.line.setAttribute('y1',0),this.line.setAttribute('y2',0),this.line.setAttribute('stroke',this.getAxisColor()),this.top||(this.labelTspan.style.dominantBaseline='hanging',this.expTspan.style.dominantBaseline='hanging',this.expTspanExp.style.dominantBaseline='hanging',this.unitTspan.style.dominantBaseline='hanging');var e=this.getSpan();this.line.setAttribute('marker-start',this.options.splitMarks&&0!=e[0]?'url(#horionzalsplit_'+this.graph.getId()+')':''),this.line.setAttribute('marker-end',this.options.splitMarks&&1!=e[1]?'url(#horionzalsplit_'+this.graph.getId()+')':'')}_drawLine(e,t){let i=this.getPx(e);return t?t.setAttribute('display','initial'):t=document.createElementNS(this.graph.ns,'line'),t.setAttribute('x1',i),t.setAttribute('x2',i),t.setAttribute('y1',0),t.setAttribute('y2',this.graph.drawingSpaceHeight),t.setAttribute('stroke','black'),this.group.appendChild(t),t}_hideLine(e){e&&e.setAttribute('display','none')}handleMouseMoveLocal(e){e-=this.graph.getPaddingLeft(),this.mouseVal=this.getVal(e)}setMinMaxFlipped(){var e=this.maxPx-this.minPx;if(!isNaN(e)){var t=e*this.options.span[1]+this.minPx-this.options.marginMax,i=e*this.options.span[0]+this.minPx+this.options.marginMin;this.minPxFlipped=this.isFlipped()?t:i,this.maxPxFlipped=this.isFlipped()?i:t}}getZProj(e){return e*this.graph.options.zAxis.shiftX}}class AxisY extends Axis{constructor(e,t,i){super(e,t,i),this.leftright=t,this.left='left'==t}setAxisPosition(e){this.shiftPosition=e}getAxisPosition(){return this.shiftPosition||0}getAdditionalWidth(){let e=0;return this.getLabel()&&(e+=this.graph.options.fontSize),this.isShown()&&(e+=Math.abs(this.tickMargin)),e}isX(){return!1}isY(){return!0}resetTicksLength(){this.longestTick=[!1,0]}getMaxSizeTick(){return this.longestTick&&this.longestTick[0]?this.longestTick[0].getComputedTextLength()+5:0}draw(){this.tickMargin=this.left?-5-this.tickPx1*this.tickScaling[1]:2-this.tickPx1*this.tickScaling[1];var e=super.draw(...arguments);return e+=this.getAdditionalWidth(),this.drawSpecifics(e),this.fullwidthlabel=e,e}equalizePosition(e){return this.placeLabel(this.left?-e:e),this.getLabel()?e+this.graph.options.fontSize:0}drawTick(e,t,i,r){let a,s,n;a=r||this.getPos(e);void 0==a||isNaN(a)||(s=this.nextTick(t,(e)=>{e.setAttribute('x1',(this.left?1:-1)*this.tickPx1*this.tickScaling[t]),e.setAttribute('x2',(this.left?1:-1)*this.tickPx2*this.tickScaling[t]),1==t?e.setAttribute('stroke',this.getPrimaryTicksColor()):e.setAttribute('stroke',this.getSecondaryTicksColor())}),s.setAttribute('y1',a),s.setAttribute('y2',a),this.nextGridLine(1==t,0,this.graph.getDrawingWidth(),a,a),1==t&&(n=this.nextTickLabel((e)=>{e.setAttribute('x',this.tickMargin+this.options.tickLabelOffset),'black'!==this.getTicksLabelColor()&&e.setAttribute('fill',this.getTicksLabelColor()),this.left?e.setAttribute('text-anchor','end'):e.setAttribute('text-anchor','start'),e.style.dominantBaseline='central'}),n.setAttribute('y',a),this.setTickContent(n,e,i),(n.textContent+'').length>=this.longestTick[1]&&(this.longestTick[0]=n,this.longestTick[1]=(n.textContent+'').length)))}drawLabel(){'black'!==this.getLabelColor()&&this.label.setAttribute('fill',this.getLabelColor()),this.label.setAttribute('dominant-baseline',this.left?'auto':'auto'),this.labelTspan.textContent=this.getLabel()}placeLabel(e){this.label.setAttribute('transform','translate('+e+', '+Math.abs(this.getMaxPx()+this.getMinPx())/2+') rotate(-90)')}drawSpecifics(){this.line.setAttribute('y1',this.getMinPx()),this.line.setAttribute('y2',this.getMaxPx()),this.line.setAttribute('x1',0),this.line.setAttribute('x2',0),this.line.setAttribute('stroke',this.getAxisColor());var e=this.getSpan();this.line.setAttribute('marker-start',this.options.splitMarks&&0!=e[0]?'url(#verticalsplit_'+this.graph.getId()+')':''),this.line.setAttribute('marker-end',this.options.splitMarks&&1!=e[1]?'url(#verticalsplit_'+this.graph.getId()+')':'')}setShift(e){if(this.shift=e,!this.shift||!this.graph.getWidth())return;let t=this.shift;t=this.floating?t:this.isLeft()?t:this.graph.getWidth()-this.graph.getPaddingRight()-this.graph.getPaddingLeft()-t,this.group.setAttribute('transform','translate( '+t+' 0 )'),this.drawLabel()}isLeft(){return this.left}isRight(){return!this.left}isFlipped(){return!this.options.flipped}_drawLine(e,t){let i=this.getPx(e);return t?t.setAttribute('display','initial'):t=document.createElementNS(this.graph.ns,'line'),t.setAttribute('y1',i),t.setAttribute('y2',i),t.setAttribute('x1',0),t.setAttribute('x2',this.graph.drawingSpaceWidth),t.setAttribute('stroke','black'),this.group.appendChild(t),t}_hideLine(e){e&&e.setAttribute('display','none')}handleMouseMoveLocal(e,t){t-=this.graph.getPaddingTop(),this.mouseVal=this.getVal(t)}scaleToFitAxis(e,t,r,a,s,n){e&&e.isX()||(e=this.graph.getXAxis()),isNaN(r)&&(r=e.getCurrentMin()),isNaN(a)&&(a=e.getCurrentMax()),s===void 0&&(s=!0),n===void 0&&(n=!0),'number'==typeof t&&(a=r,r=t,t=!1);for(var o=-Infinity,p=Infinity,d=0,g=0,i=this.graph.series.length;g<i;g++)this.graph.series[g].isShown()&&this.graph.series[g]!=t&&this.graph.series[g].getXAxis()==e&&this.graph.series[g].getYAxis()===this&&(d++,o=n?Math.max(o,this.graph.series[g].getMax(r,a)):0,p=s?Math.min(p,this.graph.series[g].getMin(r,a)):0);if(0==d)this.setMinMaxToFitSeries();else{p=s?p:this.getCurrentMin(),o=n?o:this.getCurrentMax();var l=o-p;p-=this.options.axisDataSpacing.min*l,o+=this.options.axisDataSpacing.max*l,this._doZoomVal(p,o)}return this}setMinMaxFlipped(){var e=this.maxPx-this.minPx;if(!isNaN(e)){var t=this.maxPx-e*this.options.span[0]-this.options.marginMin,i=this.maxPx-e*this.options.span[1]+this.options.marginMax;this.minPxFlipped=this.isFlipped()?t:i,this.maxPxFlipped=this.isFlipped()?i:t}}getZProj(e){return e*this.graph.options.zAxis.shiftY}}class AxisXBar extends AxisX{constructor(e,t,i={}){super(e,t,i)}set categories(e){return this._barCategories=e,this}draw(){var e=this,t=this._barCategories,r;if(this.forceMin(0),this.forceMax(1),this.cacheCurrentMin(),this.cacheCurrentMax(),this.cacheInterval(),!!t){Array.isArray(t)||(t=[t]);for(var a=0;a<=t.length;a++)this.drawTick(a/t.length,2),a<t.length&&(r=this.nextTickLabel(function(t){t.setAttribute('y',(e.top?-1:1)*((1==e.options.tickPosition?8:20)+(e.top?10:0))),t.setAttribute('text-anchor','middle'),'black'!==e.getTicksLabelColor()&&t.setAttribute('fill',e.getTicksLabelColor()),t.style.dominantBaseline='hanging'}),r.setAttribute('x',this.getPos((a+0.5)/t.length)),r.textContent=t[a].title);return this.drawSpecifics(),this}}autoSeries(){let e=[];for(let t of this.graph.series)t.getXAxis()==this&&e.push(t);return this.setSeries(...e),this}setSeries(){var e=this;return this.series=arguments,Array.prototype.map.call(this.series,function(t,i){'object'==typeof t||(t=e.graph.getSerie(t)),t.setCategoryConfig&&t.setCategoryConfig(i,e._barCategories,e.series.length)}),this._getUsedCategories(),this}_getUsedCategories(){let e={},t=0;Array.prototype.map.call(this.series,(i)=>{let r=i.getUsedCategories();for(let a of r)e.hasOwnProperty(a)||(e[a]=1,t+=1),e[a]++,t++});let r=0;for(let t in e){let i=e[t];e[t]=r,r+=i}let i={};Array.prototype.map.call(this.series,(r)=>{let a=r.getUsedCategories(),s={};a.forEach((r)=>{i[r]=i[r]||0.5,s[r]=(e[r]+i[r])/t,i[r]++}),r.setDataIndices(s,t)})}getType(){return'category'}}var axisFormat=[{threshold:20,increments:{1:{increment:1,unit:'i',format:'HH"h"MM (dd/mm/yy)'},2:{increment:1,unit:'s',format:'MM:ss"s"'}}},{threshold:50,increments:{1:{increment:1,unit:'i',format:'HH"h"MM (dd/mm/yy)'},2:{increment:2,unit:'s',format:'MM:ss"s"'}}},{threshold:100,increments:{1:{increment:1,unit:'i',format:'HH"h"MM (dd/mm/yy)'},2:{increment:5,unit:'s',format:'MM:ss"s"'}}},{threshold:600,increments:{1:{increment:10,unit:'i',format:'HH"h"MM (dd/mm/yy)'},2:{increment:30,unit:'s',format:'MM:ss"s"'}}},{threshold:1e3,increments:{1:{increment:1,unit:'h',format:'HH"h"MM (dd/mm/yy)'},2:{increment:10,unit:'i',format:'MM"min"'}}},{threshold:1500,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:1,unit:'i',format:'H"h"MM'}}},{threshold:3e3,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:2,unit:'i',format:'H"h"MM'}}},{threshold:8e3,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:10,unit:'i',format:'H"h"MM'}}},{threshold:26400,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:20,unit:'i',format:'H"h"MM'}}},{threshold:86400,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:1,unit:'h',format:'H"h"MM'}}},{threshold:2e5,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:2,unit:'h',format:'H"h"MM'}}},{threshold:4e5,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:6,unit:'h',format:'H"h"MM'}}},{threshold:1.4e6,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:12,unit:'h',format:'HH"h"MM'}}},{threshold:6.4e6,increments:{1:{increment:1,unit:'m',format:'mmmm yyyy'},2:{increment:1,unit:'d',format:'dd'}}},{threshold:1.24e7,increments:{1:{increment:1,unit:'m',format:'mmmm yyyy'},2:{increment:2,unit:'d',format:'dd'}}},{threshold:43200000,increments:{1:{increment:1,unit:'m',format:'mmmm yyyy'},2:{increment:7,unit:'d',format:'dd'}}},{threshold:69120000,increments:{1:{increment:1,unit:'m',format:'mmmm yyyy'},2:{increment:15,unit:'d',format:'dd'}}},{threshold:86400000,increments:{1:{increment:1,unit:'y',format:'yyyy'},2:{increment:3,unit:'m',format:'mm/yyyy'}}},{threshold:172800000,increments:{1:{increment:1,unit:'y',format:'yyyy'},2:{increment:4,unit:'m',format:'mm/yyyy'}}},{threshold:864000000,increments:{1:{increment:1,unit:'y',format:'yyyy'},2:{increment:6,unit:'m',format:'mm/yyyy'}}},{threshold:1036800000,increments:{1:{increment:1,unit:'y',format:'yyyy'},2:{increment:1,unit:'y',format:'yyyy'}}}],dateFormat=function(){var e=Math.abs,t=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[WLloSZ]|"[^"]*"|'[^']*'/g,i=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,r=/[^-+\dA-Z]/g,a=function(e,t){for(e+='',t=t||2;e.length<t;)e='0'+e;return e},n=function(e,t){var i=new Date(e[t+'FullYear'](),0,1);return Math.ceil(((e-i)/8.64e7+i[t+'Day']()+1)/7)};return function(l,p,g){var c=dateFormat;if(1!=arguments.length||'[object String]'!=Object.prototype.toString.call(l)||/\d/.test(l)||(p=l,l=void 0),l=l?new Date(l):new Date,isNaN(l))throw SyntaxError('invalid date:'+l);p=(c.masks[p]||p||c.masks.default)+'','UTC:'==p.slice(0,4)&&(p=p.slice(4),g=!0);var u=g?'getUTC':'get',h=l[u+'Date'](),x=l[u+'Day'](),b=l[u+'Month'](),m=l[u+'FullYear'](),A=l[u+'Hours'](),f=l[u+'Minutes'](),S=l[u+'Seconds'](),k=l[u+'Milliseconds'](),C=g?0:l.getTimezoneOffset(),o={d:h,dd:a(h),ddd:c.i18n.dayNames[x],dddd:c.i18n.dayNames[x+7],m:b+1,mm:a(b+1),mmm:c.i18n.monthNames[b],mmmm:c.i18n.monthNames[b+12],yy:(m+'').slice(2),yyyy:m,h:A%12||12,hh:a(A%12||12),H:A,HH:a(A),M:f,MM:a(f),s:S,ss:a(S),l:a(k,3),L:a(99<k?Math.round(k/10):k),t:12>A?'a':'p',tt:12>A?'am':'pm',T:12>A?'A':'P',TT:12>A?'AM':'PM',Z:g?'UTC':((l+'').match(i)||['']).pop().replace(r,''),o:(0<C?'-':'+')+a(100*Math.floor(e(C)/60)+e(C)%60,4),S:['th','st','nd','rd'][3<h%10?0:(10!=h%100-h%10)*h%10],W:n(l,u)};return p.replace(t,function(e){return e in o?o[e]:e.slice(1,e.length-1)})}}();dateFormat.masks={default:'ddd mmm dd yyyy HH:MM:ss',shortDate:'m/d/yy',mediumDate:'mmm d, yyyy',longDate:'mmmm d, yyyy',fullDate:'dddd, mmmm d, yyyy',shortTime:'h:MM TT',mediumTime:'h:MM:ss TT',longTime:'h:MM:ss TT Z',isoDate:'yyyy-mm-dd',isoTime:'HH:MM:ss',isoDateTime:'yyyy-mm-dd\'T\'HH:MM:ss',isoUtcDateTime:'UTC:yyyy-mm-dd\'T\'HH:MM:ss\'Z\''},dateFormat.i18n={dayNames:['Sun','Mon','Tue','Wed','Thu','Fri','Sat','Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],monthNames:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec','January','February','March','April','May','June','July','August','September','October','November','December']};function getClosestIncrement(e,t){return Math.round(e/t)*t}function roundDate(e,t){switch(t.unit){case's':e.setSeconds(getClosestIncrement(e.getSeconds(),t.increment)),e.setMilliseconds(0);break;case'i':e.setMinutes(getClosestIncrement(e.getMinutes(),t.increment)),e.setSeconds(0),e.setMilliseconds(0);break;case'h':e.setHours(getClosestIncrement(e.getHours(),t.increment)),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0);break;case'd':e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e.setHours(0),e.setDate(getClosestIncrement(e.getDate(),t.increment));break;case'm':e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e.setHours(0),e.setDate(1),e.setMonth(getClosestIncrement(e.getMonth(),t.increment));break;case'y':e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e.setHours(0),e.setDate(1),e.setMonth(0);break;default:throw new Error('Date format not recognized');}return e}function incrementDate(e,t){switch(t.unit){case's':e.setSeconds(e.getSeconds()+t.increment),e.setMilliseconds(0);break;case'i':e.setMinutes(e.getMinutes()+t.increment),e.setSeconds(0),e.setMilliseconds(0);break;case'h':e.setHours(e.getHours()+t.increment),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0);break;case'd':e.setDate(e.getDate()+t.increment),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e.setHours(0);break;case'm':e.setMonth(e.getMonth()+t.increment),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e.setHours(0),e.setDate(1);break;case'y':e.setFullYear(e.getFullYear()+t.increment),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e.setHours(0),e.setDate(1),e.setMonth(0);break;default:throw new Error('Date format not recognized');}return e}function getGroup(e,t,i){if(e.groups[t][i])return e.groups[t][i].group.setAttribute('display','block'),e.groups[t][i];var r={group:document.createElementNS(e.graph.ns,'g'),text:document.createElementNS(e.graph.ns,'text')},a=document.createElementNS(e.graph.ns,'line');switch(a.setAttribute('stroke','black'),a.setAttribute('y1',0),t){case 2:a.setAttribute('y2',6),r.text.setAttribute('y',15),r.line=a,r.group.appendChild(r.line);break;default:case 1:a.setAttribute('y2',20),r.text.setAttribute('y',10),r.line1=a,r.line2=a.cloneNode(),r.group.appendChild(r.line1),r.group.appendChild(r.line2);}return r.text.setAttribute('text-anchor','middle'),r.text.setAttribute('dominant-baseline','middle'),r.group.appendChild(r.text),e.getWrapper(t).appendChild(r.group),e.groups[t][i]=r}function hideGroups(e,t,i){for(;i<e.groups[t].length;i++)hideGroup(e.groups[t][i])}function hideGroup(e){e.group.setAttribute('display','none')}function getDateText(e,t){return dateFormat(e,t)}function renderGroup(e,t,i,r,a,s,n){var o=Math.max,l=Math.min;switch(e){case 2:if(s<r||s>a)return void hideGroup(t);t.line.setAttribute('x1',s),t.line.setAttribute('x2',s),t.text.setAttribute('x',s),t.text.textContent=i;break;default:case 1:var p=o(r,l(a,s)),d=o(r,l(a,n));if(isNaN(d)||isNaN(p))return;for(t.line1.setAttribute('x1',p),t.line2.setAttribute('x1',d),t.line1.setAttribute('x2',p),t.line2.setAttribute('x2',d),t.text.setAttribute('x',(p+d)/2);8*i.length>d-p;)if(i=i.substr(0,i.length-2)+'.',1==i.length){i='';break}t.text.textContent=i;}}class GraphTimeAxis extends Axis{constructor(){super(...arguments)}init(e,t){super.init(e,t),this.wrapper={1:document.createElementNS(e.ns,'g'),2:document.createElementNS(e.ns,'g')},this.groups={1:[],2:[]};var i=document.createElementNS(e.ns,'rect');i.setAttribute('fill','#c0c0c0'),i.setAttribute('stroke','#808080'),i.setAttribute('height','20'),i.setAttribute('x','0'),i.setAttribute('y','0'),this.rect=i,this.wrapper[1].appendChild(this.rect),this.group.appendChild(this.wrapper[1]),this.group.appendChild(this.wrapper[2]),this.wrapper[1].setAttribute('transform','translate( 0, 25 )'),this.wrapper[2].setAttribute('transform','translate( 0, 00 )')}draw(){this.cacheCurrentMax(),this.cacheCurrentMin(),(void 0==this.currentAxisMin||void 0==this.currentAxisMax)&&this.setMinMaxToFitSeries(!0),this.line.setAttribute('x1',this.getMinPx()),this.line.setAttribute('x2',this.getMaxPx()),this.line.setAttribute('y1',0),this.line.setAttribute('y2',0);var e=this.maxPx-this.minPx,t=this.getCurrentInterval(),r=this.getCurrentMax(),a=this.getCurrentMin();if(this.rect.setAttribute('width',e),this.rect.setAttribute('x',this.minPx),!r||!a)return 0;var s;for(u=0;u<axisFormat.length;u++)if(axisFormat[u].threshold>t/e){s=axisFormat[u];break}s||(s=axisFormat[axisFormat.length-1]);var n=0,o,l,p,d,g,c,u;for(n=1;2>=n;n++){if(!isNumeric$1(a)){hideGroups(this,n,0);break}p=new Date(a),d=roundDate(p,s.increments[n]),u=0;do if(g=getDateText(d,s.increments[n].format),c=getGroup(this,n,u),o=this.getPx(d.getTime()),d=incrementDate(d,s.increments[n]),l=this.getPx(d.getTime()),renderGroup(n,c,g,this.getMinPx(),this.getMaxPx(),o,l),u++,100<u)break;while(d.getTime()<r);hideGroups(this,n,u)}}isX(){return!0}getWrapper(e){return this.wrapper[e]}setShift(e){this.shift=e,this.group.setAttribute('transform','translate(0 '+(this.top?this.shift:this.graph.getDrawingHeight()-this.shift)+')')}getAxisPosition(){return 60}setMinMaxFlipped(){var e=this.maxPx-this.minPx,t=e*this.options.span[1]+this.minPx,i=e*this.options.span[0]+this.minPx;this.minPxFlipped=this.isFlipped()?t:i,this.maxPxFlipped=this.isFlipped()?i:t}}class Serie extends EventEmitter{static default(){return{redrawShapesAfterDraw:!1}}constructor(e,t,i){super(...arguments),this.graph=e,this.name=t,this.options=Object.assign({},Serie.default(),this.constructor.default(),i)}draw(){}beforeDraw(){}afterDraw(){this.options.redrawShapesAfterDraw&&this.graph.getShapesOfSerie(this).forEach((e)=>{e.redraw()}),this.emit('draw')}setData(e){if(e instanceof Waveform)return this.setWaveform(e);throw'Setting data other than waveforms in not supported by default. You must implemented this method in the inherited class.'}_addData(){return[]}clearData(){return this.setData(new Waveform),this}getData(){return this.data}setOptions(e){this.options=e||{}}setOption(e,t){this.options[e]=t}kill(e){return this.graph.removeSerieFromDom(this),this.graph._removeSerie(this),this.graph.legend&&!e&&this.graph.legend.update(),this.graph=void 0,this}hide(e,t=!1){if(this.hidden=!0,this.groupMain.setAttribute('display','none'),this.getSymbolForLegend().setAttribute('opacity',0.5),this.getTextForLegend().setAttribute('opacity',0.5),this.hideImpl(),e)for(var r=this.graph.getShapesOfSerie(this),a=0,i=r.length;a<i;a++)r[a].hide();return t||this.emit('hide'),(this.getXAxis().doesHideWhenNoSeriesShown()||this.getYAxis().doesHideWhenNoSeriesShown())&&this.graph.draw(!0),this}show(e,t=!1){if(this.hidden=!1,this.groupMain.setAttribute('display','block'),this.getSymbolForLegend().setAttribute('opacity',1),this.getTextForLegend().setAttribute('opacity',1),this.showImpl(),this.draw(!0),e)for(var r=this.graph.getShapesOfSerie(this),a=0,i=r.length;a<i;a++)r[a].show();return t||this.emit('show'),(this.getXAxis().doesHideWhenNoSeriesShown()||this.getYAxis().doesHideWhenNoSeriesShown())&&this.graph.draw(!0),this}hideImpl(){}showImpl(){}toggleDisplay(){return this.isShown()?this.hide():this.show(),this}isShown(){return!this.hidden}axisCheck(){if(!this.getXAxis()||!this.getYAxis())throw'No axis exist for this serie. Check that they were properly assigned';if(isNaN(this.getXAxis().getCurrentMin())||isNaN(this.getXAxis().getCurrentMax())||isNaN(this.getYAxis().getCurrentMin())||isNaN(this.getYAxis().getCurrentMax()))throw'Axis min and max values are not defined. Try autoscaling'}getX(e){return(e=this.getXAxis().getPx(e))-e%0.2}getY(e){return(e=this.getYAxis().getPx(e))-e%0.2}isSelected(){return this.selected||'unselected'!==this.selectionType}_checkX(e){this.minX=Math.min(this.minX,e),this.maxX=Math.max(this.maxX,e)}_checkY(e){this.minY=Math.min(this.minY,e),this.maxY=Math.max(this.maxY,e)}getName(){return this.name}autoAxis(){return this.isFlipped()?(this.setXAxis(this.graph.getYAxis()),this.setYAxis(this.graph.getXAxis())):(this.setXAxis(this.graph.getXAxis()),this.setYAxis(this.graph.getYAxis())),this.graph.updateDataMinMaxAxes(),this}autoAxes(){return this.autoAxis(...arguments)}setXAxis(e){return this.xaxis='number'==typeof e?this.isFlipped()?this.graph.getYAxis(e):this.graph.getXAxis(e):e,this.graph.updateDataMinMaxAxes(),this}setYAxis(e){return'number'==typeof e?this.xaxis=this.isFlipped()?this.graph.getXAxis(e):this.graph.getYAxis(e):this.yaxis=e,this.graph.updateDataMinMaxAxes(),this}setAxes(){for(var e=0;2>e;e++)arguments[e]&&this[arguments[e].isX()?'setXAxis':'setYAxis'](arguments[e]);return this.graph.updateDataMinMaxAxes(),this}getXAxis(){return this.xaxis}getYAxis(){return this.yaxis}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getWaveform(){return this.waveform}getWaveforms(){return[this.waveform]}setWaveform(e){if(!(e instanceof Waveform))throw console.trace(),console.error(e),new Error('Cannot assign waveform to serie. Waveform is not of the proper Waveform instance');return this.waveform=e,this.minX=this.waveform.getXMin(),this.maxX=this.waveform.getXMax(),this.minY=this.waveform.getMin(),this.maxY=this.waveform.getMax(),this.graph.updateDataMinMaxAxes(),this.dataHasChanged(),this}getSymbolForLegend(){if(!this.lineForLegend){var e=document.createElementNS(this.graph.ns,'line');this.applyLineStyle(e),e.setAttribute('x1',5),e.setAttribute('x2',25),e.setAttribute('y1',0),e.setAttribute('y2',0),e.setAttribute('cursor','pointer'),this.lineForLegend=e}return this.lineForLegend}setLegendSymbolStyle(){this.applyLineStyle(this.getSymbolForLegend())}updateStyle(){this.setLegendSymbolStyle(),this.graph.updateLegend()}getTextForLegend(){if(!this.textForLegend){var e=document.createElementNS(this.graph.ns,'text');e.setAttribute('cursor','pointer'),e.textContent=this.getLabel(),this.textForLegend=e}return this.textForLegend}getIndex(){return this.graph.series.indexOf(this)}getLabel(){return this.options.label||this.name}setLabel(e){return this.options.label=e,this.textForLegend&&(this.textForLegend.textContent=e),this.graph.requireLegendUpdate(),this}setFlip(e){return this.options.flip=e,this}getFlip(){return this.options.flip}isFlipped(){return this.options.flip}setLayer(e){let t=parseInt(e)||1;return t!==this.options.layer&&(this.options.layer=t,this.graph.appendSerieToDom(this)),this}getLayer(){return this.options.layer||1}setStyle(e,t='unselected'){this.styles[t]=e,this.styleHasChanged(t)}styleHasChanged(e='unselected'){if(this._changedStyles=this._changedStyles||{},!1===e)for(var t in this._changedStyles)this._changedStyles[t]=!1;else this._changedStyles[e||'unselected']=!0;return this.graph.requireLegendUpdate(),this}hasStyleChanged(e){return this._changedStyles=this._changedStyles||{},this._changedStyles[e||'unselected']}dataHasChanged(e){return this._dataHasChanged=void 0===e||e,this}hasDataChanged(){return this._dataHasChanged}setInfo(e,t){return this.infos=this.infos||{},this.infos[e]=t,this}getInfo(e){return(this.infos||{})[e]}setAdditionalData(e){return this.additionalData=e,this}getAdditionalData(){return this.additionalData}select(){return this.selected=!0,this}unselect(){return this.selected=!1,this}enableTracking(e,t){return this._tracker=!0,this._trackingCallback=e,this._trackingOutCallback=t,this}disableTracking(){return this._trackerDom&&(this._trackerDom.remove(),this._trackerDom=null),this._tracker=!1,this._trackingCallback=null,this}allowTrackingLine(e){e=e||{},this.graph.addSerieToTrackingLine(this,e)}getMarkerForLegend(){return!1}get type(){return this._type}getType(){return this._type}set excludedFromLegend(e){this._excludedFromLegend=e}get excludedFromLegend(){return!!this._excludedFromLegend}setDataIndices(e,t){this.categoryIndices=e,this.nbCategories=t}hasErrors(){return!!this.waveform&&this.waveform.hasErrorBars()}}var ErrorBarMixin={makeBarY:function(e,t,i){if(e&&void 0!==i){var r=isNumeric$1(i.width)?i.width:10;return' V '+e+' m -'+r/2+' 0 h '+r+' m -'+r/2+' 0 V '+t+' '}},makeBoxY:function(e,t,i){return e&&void 0!==i?' m 5 0 V '+e+' h -10 V '+t+' m 5 0 ':void 0},makeBarX:function(e,t,i){if(e&&void 0!==i){var r=isNumeric$1(i.width)?i.width:10;return' H '+e+' m 0 -'+r/2+' v '+r+' m 0 -'+r/2+' H '+t+' '}},makeBoxX:function(e,t,i){return e&&void 0!==i?' v 5 H '+e+' v -10 H '+t+' v 5 ':void 0},setErrorBarStyle:function(e){return this.errorbarStyle=this._setErrorStyle(e),this},setErrorBoxStyle:function(e){return this.errorboxStyle=this._setErrorStyle(e),this},_setErrorStyle(e={}){var t=[],i=[['y','top','bottom'],['x','left','right']],r=(e)=>{e.dom=document.createElementNS(this.graph.ns,'path'),e.dom.setAttribute('fill',e.fillColor||'none'),e.dom.setAttribute('stroke',e.strokeColor||'black'),e.dom.setAttribute('stroke-opacity',e.strokeOpacity||1),e.dom.setAttribute('fill-opacity',e.fillOpacity||1),e.dom.setAttribute('stroke-width',e.strokeWidth||1),this.groupMain.appendChild(e.dom)},t={};'string'==typeof e&&(e={});for(var a=0,s=i.length;a<s;a++){e.all&&(e[i[a][1]]=extend(!0,{},e.all),e[i[a][2]]=extend(!0,{},e.all)),e[i[a][0]]&&(e[i[a][1]]=extend(!0,{},e[i[a][0]]),e[i[a][2]]=extend(!0,{},e[i[a][0]]));for(var n=1;2>=n;n++)e[i[a][n]]&&(t[i[a][n]]=e[i[a][n]],r(t[i[a][n]]))}return t},errorDrawInit:function(){this.errorboxStyle&&(this.errorboxStyle.paths={top:'',bottom:'',left:'',right:''}),this.errorbarStyle&&(this.errorbarStyle.paths={top:'',bottom:'',left:'',right:''})},errorAddPoint:function(e,t,i,r,a){let s;(s=this.waveform.getErrorBarXBelow(e))&&(this.errorbarStyle.paths.left+=' M '+r+' '+a,this.errorbarStyle.paths.left+=this.makeBarX(this.getX(t-s),r,this.errorbarStyle.left)),(s=this.waveform.getErrorBarXAbove(e))&&(this.errorbarStyle.paths.right+=' M '+r+' '+a,this.errorbarStyle.paths.right+=this.makeBarX(this.getX(t+s),r,this.errorbarStyle.right)),(s=this.waveform.getErrorBarYBelow(e))&&(this.errorbarStyle.paths.bottom+=' M '+r+' '+a,this.errorbarStyle.paths.bottom+=this.makeBarY(this.getY(i-s),a,this.errorbarStyle.bottom)),(s=this.waveform.getErrorBarYAbove(e))&&(this.errorbarStyle.paths.top+=' M '+r+' '+a,this.errorbarStyle.paths.top+=this.makeBarY(this.getY(i+s),a,this.errorbarStyle.top)),(s=this.waveform.getErrorBoxXBelow(e))&&(this.errorboxStyle.paths.left+=' M '+r+' '+a,this.errorboxStyle.paths.left+=this.makeBoxX(this.getX(t-s),r,this.errorboxStyle.left)),(s=this.waveform.getErrorBoxXAbove(e))&&(this.errorboxStyle.paths.right+=' M '+r+' '+a,this.errorboxStyle.paths.right+=this.makeBoxX(this.getX(t+s),r,this.errorboxStyle.right)),(s=this.waveform.getErrorBoxYBelow(e))&&(this.errorboxStyle.paths.bottom+=' M '+r+' '+a,this.errorboxStyle.paths.bottom+=this.makeBoxY(this.getY(i-s),a,this.errorboxStyle.bottom)),(s=this.waveform.getErrorBoxYAbove(e))&&(this.errorboxStyle.paths.top+=' M '+r+' '+a,this.errorboxStyle.paths.top+=this.makeBoxY(this.getY(i+s),a,this.errorboxStyle.top))},errorAddPointBarChart:function(e,t,i,r){var a;this.error&&(a=this.error[e])&&this.doErrorDraw('y',a,t,r,i,r)},errorDraw:function(){if(this.errorbarStyle)for(var e in this.errorbarStyle.paths)this.errorbarStyle[e]&&this.errorbarStyle[e].dom&&this.errorbarStyle[e].dom.setAttribute('d',this.errorbarStyle.paths[e]);if(this.errorboxStyle)for(var e in this.errorboxStyle.paths)this.errorboxStyle[e]&&this.errorboxStyle[e].dom&&this.errorboxStyle[e].dom.setAttribute('d',this.errorboxStyle.paths[e])}};class SerieLine extends Serie{static default(){return{lineColor:'black',lineStyle:1,flip:!1,label:'',lineWidth:1,markers:!1,trackMouse:!1,trackMouseLabel:!1,trackMouseLabelRouding:1,lineToZero:!1,selectableOnClick:!1,markersIndependant:!1,overflowX:!1,overflowY:!1}}constructor(){super(...arguments),this.selectionType='unselected',this.markerFamilies={},mapEventEmission(this.options,this),this.styles={},this.styles.unselected={lineColor:this.options.lineColor,lineStyle:this.options.lineStyle,lineWidth:this.options.lineWidth,markers:this.options.markers},this.styles.selected={lineWidth:3},this.extendStyles(),this.markersDom=new Map,this.shown=!0,this.data=[],this._isMinOrMax={x:{min:!1,max:!1},y:{min:!1,max:!1}},this.groupLines=document.createElementNS(this.graph.ns,'g'),this.domMarker=document.createElementNS(this.graph.ns,'path'),this.domMarker.style.cursor='pointer',this.groupMain=document.createElementNS(this.graph.ns,'g'),this.additionalData={},this.marker=document.createElementNS(this.graph.ns,'circle'),this.marker.setAttribute('fill','black'),this.marker.setAttribute('r',3),this.marker.setAttribute('display','none'),this.markerLabel=document.createElementNS(this.graph.ns,'text'),this.markerLabelSquare=document.createElementNS(this.graph.ns,'rect'),this.markerLabelSquare.setAttribute('fill','white'),this.domMarkerHover={},this.domMarkerSelect={},this.markerHovered=0,this.groupMarkerSelected=document.createElementNS(this.graph.ns,'g'),this.markerPoints={},this.lines=[],this.groupMain.appendChild(this.groupLines),this.groupMain.appendChild(this.marker),this.groupMain.appendChild(this.groupMarkerSelected),this.groupMain.appendChild(this.markerLabelSquare),this.groupMain.appendChild(this.markerLabel),this.groupMarkers=document.createElementNS(this.graph.ns,'g'),this.groupMain.appendChild(this.groupMarkers),this.independantMarkers=[],this.initExtended1&&this.initExtended1(),this.groupLines.addEventListener('click',()=>{this.options.selectableOnClick&&(this.isSelected()?this.graph.unselectSerie(this):this.graph.selectSerie(this))}),this.options.markers&&this.setMarkers(this.options.markers,'unselected')}setOptions(e){return this.options=extend(!0,{},SerieLine.prototype.defaults,e||{}),this.styles.unselected={lineColor:this.options.lineColor,lineStyle:this.options.lineStyle,markers:this.options.markers},this.applyLineStyles(),this}onMouseOverMarker(t,e){this.toggleMarker(e,!0,!0);this.options.onMouseOverMarker&&this.options.onMouseOverMarker(e,!!this.infos&&(this.infos[e]||!1),[this.waveform.getX(e),this.waveform.getY(e)])}onMouseOutMarker(t,e){this.markersOffHover(),this.options.onMouseOutMarker&&this.options.onMouseOutMarker(e,!!this.infos&&(this.infos[e]||!1),[this.waveform.getX(e),this.waveform.getY(e)])}toggleMarker(e,t,r){let a=e;var i;'undefined'==typeof t&&(i=r?!this.domMarkerHover[e]:!this.domMarkerSelect[e]);var s=this['domMarker'+(r?'Hover':'Select')];if(i||!0===t){if(!s[e]){var n=document.createElementNS(this.graph.ns,'path');this.setMarkerStyleTo(n,this.markerFamilies[this.selectionType][this.getMarkerCurrentFamily(a)]),this['domMarker'+(r?'Hover':'Select')][e]=n,this.groupMarkerSelected.appendChild(n)}else n=s[e];let t=this.getX(this.waveform.getX(a)),i=this.getY(this.waveform.getY(a));n.setAttribute('d','M '+t+' '+i+' '+this.getMarkerPath(this.markerFamilies[this.selectionType][this.getMarkerCurrentFamily(a)],1)),r&&this.markerHovered++}else if((!i||!1===t)&&(r&&this.domMarkerHover[e]&&!this.domMarkerSelect[e]||this.domMarkerSelect[e])){if(!s[e])return;this.groupMarkerSelected.removeChild(s[e]),delete s[e],r&&this.markerHovered--}return i}markersOffHover(){for(var e in this.domMarkerHover)this.toggleMarker(e.split(','),!1,!0);return this}markersOffSelect(){for(var e in this.domMarkerSelect)this.toggleMarker(e.split(','),!1,!1);return this}onClickOnMarker(t,e){var i=this.toggleMarker(e);i&&this.options.onSelectMarker&&this.options.onSelectMarker(e,!!this.infos&&(this.infos[e[0]]||!1)),!i&&this.options.onUnselectMarker&&this.options.onUnselectMarker(e,!!this.infos&&(this.infos[e[0]]||!1)),this.options.onToggleMarker&&this.options.onToggleMarker(e,!!this.infos&&(this.infos[e[0]]||!1),i)}_getMarkerIndexFromEvent(t){var e=this.graph._getXY(t);return this.searchIndexByPxXY(e.x-this.graph.getPaddingLeft(),e.y-this.graph.getPaddingTop())}onMouseWheel(){}empty(){for(var e=0,t=this.lines.length;e<t;e++)this.groupLines.removeChild(this.lines[e]);return this.lines=[],this}select(e){return e=e||'selected',this.selected='unselected'!==e,this.areMarkersShown()||this.areMarkersShown(e)?(this.selectionType=e,this.draw(!0),this.applyLineStyles()):(this.selectionType=e,this.applyLineStyles()),this.applyLineStyle(this.getSymbolForLegend()),this}unselect(){return this.selected=!1,this.select('unselected')}degrade(e){return this.degradationPx=e,this}drawInit(e){try{this.axisCheck()}catch(t){return console.warn(t),!1}if(this.currentLineId=0,this.counter=0,this._drawn=!0,this.currentLine='',!this.waveform)this._dataToUse=this.data,this._xDataToUse=this.xData;else if(this.degradationPx)this.waveform.resampleForDisplay({resampleToPx:this.degradationPx,xPosition:this.getXAxis().getPx.bind(this.getXAxis()),minX:this.getXAxis().getCurrentMin(),maxX:this.getXAxis().getCurrentMax()}),this._dataToUse=[this.waveform.getDataToUseFlat()];else if(this.waveform.hasAggregation()){let t=this.getXAxis(),i=this.graph.getDrawingWidth()*(t.getDataMax()-t.getDataMin())/(t.getCurrentMax()-t.getCurrentMin()),r=this.waveform.selectAggregatedData(i);if(r instanceof Promise)return r.then(()=>{this.draw(e)}),!1;if(!1===r)return!1;this._dataToUse=this.waveform.getDataToUseFlat()}return!0}removeLinesGroup(){this._afterLinesGroup=this.groupLines.nextSibling,this.groupMain.removeChild(this.groupLines)}insertLinesGroup(){if(!this._afterLinesGroup)throw'Could not find group after lines to insertion.';this.groupMain.insertBefore(this.groupLines,this._afterLinesGroup),this._afterLinesGroup=!1}removeExtraLines(){for(var e=this.currentLineId,t=this.lines.length;e<t;e++)this.groupLines.removeChild(this.lines[e]);this.lines.splice(this.currentLineId,t-this.currentLineId),this.currentLineId=0}draw(e){if(super.draw(...arguments),!this.getXAxis()||!this.getYAxis())throw'No axes were defined for this serie';if(e||this.hasDataChanged()){if(!this.drawInit(e))return;var t=this._dataToUse,r=this._xDataToUse,a=this._slotToUse;this.removeLinesGroup(),this.eraseMarkers(),this.lookForMaxima=!0,this.lookForMinima=!1,this.markerFamily=this.markerFamilies[this.selectionType||'unselected'],this.pos0=this.getYAxis().getPos(0),this.hasErrors()&&this.errorDrawInit(),this._draw(),this.hasErrors()&&this.errorDraw(),this.removeExtraLines(),this.insertMarkers(),this.insertLinesGroup()}for(var s in this.domMarkerHover)this.toggleMarker(s.split(','),!1,!0);for(var s in this.domMarkerSelect)this.toggleMarker(s.split(','),!1,!1);this.applyLineStyle(this.getSymbolForLegend()),this.hasStyleChanged(this.selectionType)&&this.updateStyle(),this.dataHasChanged(!1),super.afterDraw()}_draw(){let e=this,t=this.waveform,r=!1,a=!1,s=this.getXAxis(),n=this.getYAxis(),o=s.getCurrentMin(),p=n.getCurrentMin(),d=s.getCurrentMax(),g=n.getCurrentMax(),c,u,h,x,m,y,b;if(!t)return;c=t.getData(!0);let A=t.getShift(),f=t.getScale(),S=!1,k=!1,M=this.isMonotoneous(),C=this.markersShown(),v=0,i=t.getLength(),l,_,L,P,w,E,X,T,Y;if(this.currentLine='',t.isXMonotoneous()){if(t.isXMonotoneousAscending())try{v=t.getIndexFromX(o,!0)||0,i=t.getIndexFromX(d,!0)}catch(r){i=t.getLength()}else try{v=t.getIndexFromX(d,!0)||0,i=t.getIndexFromX(o,!0)}catch(r){i=t.getLength()}i+=2,i>c.length&&(i=c.length)}for(;v<i;v+=1){if(u=t.getX(v,!0),h=c[v]*f+A,u!=u||h!=h){this._createLine();continue}if(!this.options.overflowX&&u<o&&r<o||!this.options.overflowX&&u>d&&r>d||(!this.options.overflowY&&h<p&&a<p||!this.options.overflowY&&h>g&&a>g)&&!this.options.lineToZero){r=u,a=h,k=!0;continue}if(this.counter2=v,C&&this.getMarkerCurrentFamily(this.counter2),y=this.getX(u),b=this.getY(h),y!=x||b!=m){if(y!=y||b!=b){0<this.counter&&this._createLine();continue}if(S=M?!this.options.overflowY&&(h<p||h>g):!this.options.overflowX&&(u<o||u>d)||!this.options.overflowY&&(h<p||h>g),this.options.lineToZero){if(S=u<o||u>d,S)continue;}else if(S||k){!1!==r&&!1!==a||k?(Y=[],l=(u-o)/(u-r),_=h-l*(h-a),L=(u-d)/(u-r),P=h-L*(h-a),w=(h-p)/(h-a),E=u-w*(u-r),X=(h-g)/(h-a),T=u-X*(u-r),1>l&&0<l&&!1!==_&&_<g&&_>p&&Y.push([o,_]),1>L&&0<L&&!1!==P&&P<g&&P>p&&Y.push([d,P]),1>w&&0<w&&!1!==E&&E<d&&E>o&&Y.push([E,p]),1>X&&0<X&&!1!==T&&T<d&&T>o&&Y.push([T,g]),0<Y.length?S?k?2==Y.length&&(this._createLine(),this._addPoint(this.getX(Y[0][0]),this.getY(Y[0][1]),Y[0][0],Y[0][1],!1,!1,!1),this._addPoint(this.getX(Y[1][0]),this.getY(Y[1][1]),Y[0][0],Y[0][1],!1,!1,!1)):(1<Y.length&&(console.error('Programmation error. Please e-mail me.'),console.log(Y,T,E,P,_,h,p,g,a)),this._addPoint(this.getX(Y[0][0]),this.getY(Y[0][1]),Y[0][0],Y[0][1],!1,!1,!1)):(1<Y.length&&(console.error('Programmation error. Please e-mail me.'),console.log(Y,T,E,P,_,h,p,g,a)),this._createLine(),this._addPoint(this.getX(Y[0][0]),this.getY(Y[0][1]),Y[0][0],Y[0][1],!1,!1,!1),this._addPoint(y,b,r,a,!1,!1,!0)):!S&&this._addPoint(y,b,r,a,v,!1,!1)):(x=y,m=b,r=u,a=h),x=y,m=b,r=u,a=h,k=S;continue}this._addPoint(y,b,u,h,v,!1,!0),x=y,m=b,r=u,a=h}}if(this._createLine(),this._tracker){this._trackerDom&&this._trackerDom.remove();var I=this.groupLines.cloneNode(!0);for(this.groupMain.appendChild(I),v=0,i=I.children.length;v<i;v++)I.children[v].setAttribute('stroke','transparent'),I.children[v].setAttribute('stroke-width','25px'),I.children[v].setAttribute('pointer-events','stroke');this._trackerDom=I,this.groupMain.addEventListener('mousemove',(t)=>{var e=this.graph._getXY(t),i=this.handleMouseMove(!1,!1);this._trackingCallback(this,i,e.x,e.y)}),this.groupMain.addEventListener('mouseleave',()=>{this._trackingOutCallback(this)})}return this}kill(){super.kill()}getMarkerCurrentFamily(e){if(this.markerPoints&&this.markerPoints[this.selectionType]){for(var t=0,i;t<this.markerPoints[this.selectionType].length&&this.markerPoints[this.selectionType][t][0]<=e;t++)this.markerPoints[this.selectionType][t][1]>=e&&(this.markerCurrentFamily=this.markerPoints[this.selectionType][t][2],i=this.markerFamilies[this.selectionType][this.markerCurrentFamily]);return!!i&&(this.getMarkerDom(i),this.markerCurrentFamily)}}setMarkerStyleTo(e,t){if(!e||!t)throw console.trace(),'Cannot set marker style. DOM does not exist.';e.setAttribute('fill',t.fillColor||'transparent'),e.setAttribute('stroke',t.strokeColor||this.getLineColor()),e.setAttribute('stroke-width',t.strokeWidth||1)}hideTrackingMarker(){this.marker.setAttribute('display','none'),this.markerLabel.setAttribute('display','none'),this.markerLabelSquare.setAttribute('display','none')}_addPoint(e,t,i,r,a,s,n){if(e===e&&t===t)return 0==this.counter?this.currentLine='M ':this.options.lineToZero||s?this.currentLine+='M ':this.currentLine+='L ',this.currentLine+=e,this.currentLine+=' ',this.currentLine+=t,this.currentLine+=' ',this.options.lineToZero&&void 0!==this.pos0&&(this.currentLine+='L ',this.currentLine+=e,this.currentLine+=' ',this.currentLine+=this.pos0,this.currentLine+=' '),this.hasErrors()&&this.errorAddPoint(a,i,r,e,t),this.markerPoints?void(this.markersShown()&&!1!==n&&this.markerFamily&&drawMarkerXY(this,this.markerFamily[this.markerCurrentFamily],e,t,this.markersDom.get(this.markerFamily[this.markerCurrentFamily])),this.counter++):void this.counter++}_createLine(){var e=this.currentLineId++,t;return this.lines[e]?t=this.lines[e]:(t=document.createElementNS(this.graph.ns,'path'),this.applyLineStyle(t),this.groupLines.appendChild(t),this.lines[e]=t),0==this.counter?t.setAttribute('d',''):t.setAttribute('d',this.currentLine),this.currentLine='M ',this.counter=0,t}applyLineStyles(){for(var e=0;e<this.lines.length;e++)this.applyLineStyle(this.lines[e])}applyLineStyle(e){e.setAttribute('stroke',this.getLineColor()),e.setAttribute('stroke-width',this.getLineWidth()),this.getLineDashArray()?e.setAttribute('stroke-dasharray',this.getLineDashArray()):e.removeAttribute('stroke-dasharray'),e.setAttribute('fill','none')}updateStyle(){this.applyLineStyles(),this.setLegendSymbolStyle(),this.styleHasChanged(!1)}getMarkerPath(e,t){var r=e.zoom||1,t=t||0,a=[];switch(e.type){case 2:a=['m',-2,-2,'l',4,4,'m',-4,0,'l',4,-4];break;case 3:a=['m',-2,0,'l',4,0,'m',-2,-2,'l',0,4];break;case 4:a=['m',-1,-1,'l',2,0,'l',-1,2,'z'];break;default:case 1:a=['m',-2,-2,'l',4,0,'l',0,4,'l',-4,0,'z'];}if((1==r||!r)&&!t)return a.join(' ');if(a){for(var s=0,i=a.length;s<i;s++)typeof a[s]=='number'&&(a[s]*=r+t);return a.join(' ')}}getMarkerDom(e){var t=this;if(!this.markersDom.has(e)){var i=document.createElementNS(this.graph.ns,'path');this.setMarkerStyleTo(i,e),this.markersDom.set(e,{dom:i,path:''}),i.addEventListener('mouseover',function(i){var e=t._getMarkerIndexFromEvent(i);t.onMouseOverMarker(i,e)}),i.addEventListener('mouseout',function(i){var e=t._getMarkerIndexFromEvent(i);t.onMouseOutMarker(i,e)}),i.addEventListener('click',function(i){var e=t._getMarkerIndexFromEvent(i);t.onClickOnMarker(i,e)})}return e.dom}getMarkerDomIndependent(t,e){if(!this.independantMarkers[t]){var i=document.createElementNS(this.graph.ns,'path');this.setMarkerStyleTo(i,e),i.addEventListener('mouseover',(i)=>{this.onMouseOverMarker(i,t)}),i.addEventListener('mouseout',(i)=>{this.onMouseOutMarker(i,t)}),i.addEventListener('click',(i)=>{this.onClickOnMarker(i,t)}),this.independantMarkers[t]=i}return this.groupMarkers.appendChild(this.independantMarkers[t]),this.independantMarkers[t]}searchIndexByPxXY(e,t){for(var i=Math.pow,r=!1,a=!1,s=this._xDataToUse,n=0,o=this.waveform.getLength(),l,p,d;n<o;n+=1)p=this.waveform.getX(n),d=this.waveform.getY(n),l=i(this.getX(p)-e,2)+i(this.getY(d)-t,2),(!r||l<r)&&(r=l,a=n);return a}searchClosestValue(e,t){if(this.waveform){let i;try{i=this.waveform.getIndexFromXY(e,t,void 0,void 0,this.getXAxis().getRelPx(1),this.getYAxis().getRelPx(1))}catch(t){throw console.log(t),new Error(`Error while finding the closest index`)}let r={},a;return a=e>this.waveform.getX(i)?-1:0,Object.assign(r,{indexMin:i+a,indexMax:i+a+1,indexClosest:i,xMin:this.waveform.getX(i+a),xMax:this.waveform.getX(i+a+1),yMin:this.waveform.getY(i+a),yMax:this.waveform.getY(i+a+1),xClosest:this.waveform.getX(i),yClosest:this.waveform.getY(i),xExact:e}),r}}handleMouseMove(e,t,i){var r=e||this.getXAxis().getMouseVal(),a=i||this.getYAxis().getMouseVal(),s=this.searchClosestValue(r,a);if(s){var n;if(s.xMax==s.xMin&&(n=s.yMin),t&&this.options.trackMouse){if(void 0==s.xMin)return!1;if(!this.marker)return;var o=this.getX(this.getFlip()?s.yClosest:s.xClosest),l=this.getY(this.getFlip()?s.xClosest:s.yClosest);if(isNaN(o)||isNaN(l))return;switch(this.marker.setAttribute('display','block'),this.marker.setAttribute('cx',o),this.marker.setAttribute('cy',l),this.markerLabel.setAttribute('display','block'),this.markerLabelSquare.setAttribute('display','block'),this.options.trackMouseLabel){case!1:break;default:this.markerLabel.textContent=this.options.trackMouseLabel.replace('<x>',r.toFixed(this.options.trackMouseLabelRouding)).replace('<y>',n.toFixed(this.options.trackMouseLabelRouding));}this.markerLabel.setAttribute('x',o+5),this.markerLabel.setAttribute('y',l-5),this.markerLabelSquare.setAttribute('x',o+5),this.markerLabelSquare.setAttribute('y',l-5-this.graph.options.fontSize),this.markerLabelSquare.setAttribute('width',this.markerLabel.getComputedTextLength()+2),this.markerLabelSquare.setAttribute('height',this.graph.options.fontSize+2)}return{xBefore:s.xMin,xAfter:s.xMax,yBefore:s.yMin,yAfter:s.yMax,trueX:s.xExact,indexClosest:s.indexClosest,interpolatedY:n,xClosest:s.xClosest,yClosest:s.yClosest}}}getMax(e,t){var r=Math.max,a=Math.min(e,t),s=r(e,t),n=this.searchClosestValue(a),o=this.searchClosestValue(s),l=-Infinity,p,i,d,g;if(n||(a=this.minX,n=this.searchClosestValue(a)),o||(s=this.maxX,o=this.searchClosestValue(s)),!n||!o)return-Infinity;for(p=n.dataIndex;p<=o.dataIndex;p++)for(d=p==n.dataIndex?n.xBeforeIndexArr:0,g=p==o.dataIndex?o.xBeforeIndexArr:this.data[p].length,i=d;i<=g;i+=2)l=r(l,this.data[p][i+1]);return l}getMin(e,t){var r=Math.min,a=r(e,t),s=Math.max(e,t),n=this.searchClosestValue(a),o=this.searchClosestValue(s),l=Infinity,p,i,d,g;if(n||(a=this.minX,n=this.searchClosestValue(a)),o||(s=this.maxX,o=this.searchClosestValue(s)),!n||!o)return Infinity;for(p=n.dataIndex;p<=o.dataIndex;p++)for(d=p==n.dataIndex?n.xBeforeIndexArr:0,g=p==o.dataIndex?o.xBeforeIndexArr:this.data[p].length,i=d;i<=g;i+=2)l=r(l,this.data[p][i+1]);return l}setStyle(e,t='unselected'){this.styles[t]=e,this.styleHasChanged(t)}setLineStyle(e,t='unselected',i){return this.styles[t]=this.styles[t]||{},this.styles[t].lineStyle=e,i&&this.setLineStyle(e,'selected'),this.styleHasChanged(t),this}getLineStyle(e){return this.getStyle(e).lineStyle}getLineDashArray(e=this.selectionType||'unselected'){switch(this.getStyle(e).lineStyle){case 2:return'1, 1';break;case 3:return'2, 2';break;case 4:return'3, 3';break;case 5:return'4, 4';break;case 6:return'5, 5';break;case 7:return'5 2';break;case 8:return'2 5';break;case 9:return'4 2 4 4';break;case 10:return'1,3,1';break;case 11:return'9 2';break;case 12:return'2 9';break;case 1:case!1:return!1;break;default:return this.styles[e].lineStyle;}this.styleHasChanged(e)}getStyle(e=this.selectionType||'unselected'){return this.styles[e]}extendStyles(){for(var e in this.styles){var t=this.styles[e];t&&(this.styles[e]=extend(!0,{},this.styles.unselected,t))}}extendStyle(e,t){var i=this.styles[e];this.styles[e]=extend(!0,{},this.styles[t||'unselected'],i||{}),this.styles[e].markers.map(function(e){e.dom&&(e.dom='')}),this._recalculateMarkerPoints(e,this.styles[e].markers),this.styleHasChanged(e)}setLineWidth(e,t,i){return t=t||'unselected',this.styles[t]=this.styles[t]||{},this.styles[t].lineWidth=e,i&&this.setLineWidth(e,'selected'),this.styleHasChanged(t),this}getLineWidth(e){return this.getStyle(e).lineWidth||1}setLineColor(e,t,i){return t=t||'unselected',this.styles[t]=this.styles[t]||{},this.styles[t].lineColor=e,i&&this.setLineColor(e,'selected'),this.styleHasChanged(t),this}getLineColor(e){return this.getStyle(e).lineColor||'black'}showMarkers(e,t){return e=e||'unselected',this.styles[e]=this.styles[e]||{},this.styles[e].showMarkers=!0,t&&this._drawn?this.draw(!0):this.styleHasChanged(e),this}hideMarkers(e,t){return e=e||'unselected',this.styles[e].showMarkers=!1,t&&this._drawn?this.draw(!0):this.styleHasChanged(e),this}markersShown(e){return!1!==this.getStyle(e).showMarkers}areMarkersShown(){return this.markersShown.apply(this,arguments)}isMarkersShown(){return this.markersShown.apply(this,arguments)}setMarkers(e,t,i){return this.styles[t||'unselected']=this.styles[t||'unselected']||{},this.showMarkers(t,!1),Array.isArray(e)||'object'!=typeof e?!e&&(e=[{type:1,zoom:1,points:'all'}]):e=[e],this.styles[t||'unselected'].markers=e,i&&(this.styles.selected.markers=extend(!0,{},e)),this._recalculateMarkerPoints(t,e),this.styleHasChanged(t),this.dataHasChanged(!0),this}setMarkersPoints(e,t,i){this._extendMarkers('points',e,t,i,!0)}setMarkersColor(e,t,i){this._extendMarkers('color',e,t,i)}setMarkersType(e,t,i){this._extendMarkers('type',e,t,i)}setMarkersZoom(e,t,i){this._extendMarkers('zoom',e,t,i)}setMarkersStrokeColor(e,t,i){this._extendMarkers('strokeColor',e,t,i)}setMarkersStrokeWidth(e,t,i){this._extendMarkers('strokeWidth',e,t,i)}setMarkersFillColor(e,t,i){this._extendMarkers('fillColor',e,t,i)}_extendMarkers(e,t,i,r,a){(i=i||0,r=r||'unselected',this.styles[r]&&this.styles[r].markers)&&(this.styles[r].markers[i][e]=t,a&&this._recalculateMarkerPoints(r,this.styles[r].markers),this.markersDom[this.styles[r].markers[i]]&&this.setMarkerStyleTo(this.markersDom[this.styles[r].markers[i]].dom,this.styles[r].markers[i]))}_recalculateMarkerPoints(e,t){for(var r=[[0,Infinity,null]],a=0,i=t.length;a<i;a++){t[a].markerPath=this.getMarkerPath(t[a]),t[a].points||(t[a].points='all'),Array.isArray(t[a].points)||(t[a].points=[t[a].points]);for(var s=0,n=t[a].points.length;s<n;s++)'all'==t[a].points[s]?r.push([0,Infinity,a]):Array.isArray(t[a].points[s])?r.push([t[a].points[s][0],t[a].points[s][1],a]):r.push([t[a].points[s],t[a].points[s],a])}this.markerFamilies[e||'unselected']=t,r.sort(function(e,t){return e[0]-t[0]||(null==e[2]?-1:1)}),this.markerPoints[e||'unselected']=r}insertMarkers(e){if(this.markerFamilies&&this.markerFamilies[e||this.selectionType]&&!this.options.markersIndependant)for(var t=0,i=this.markerFamilies[e||this.selectionType].length;t<i;t++){if(!this.markersDom.has(this.markerFamilies[e||this.selectionType][t]))continue;let i=this.markersDom.get(this.markerFamilies[e||this.selectionType][t]);i.dom.setAttribute('d',i.path),this.groupMarkers.appendChild(i.dom),this.currentMarkersSelectionType=this.selectionType}}getMarkerForLegend(){if(this.markerPoints&&this.markerPoints[this.selectionType]){if(!this.markerForLegend){var e=document.createElementNS(this.graph.ns,'path');this.setMarkerStyleTo(e,this.markerFamilies[this.selectionType][0]),e.setAttribute('d','M 14 0 '+this.getMarkerPath(this.markerFamilies[this.selectionType][0])),this.markerForLegend=e}return this.markerForLegend}}eraseMarkers(){var e=this;if(this.options.markersIndependant){for(var t in this.independantMarkers)e.groupMarkers.removeChild(this.independantMarkers[t]);this.independantMarkers={}}else this.currentMarkersSelectionType&&(this.markersDom.forEach(function(t){t.dom&&t.dom.parentNode===e.groupMarkers&&(e.groupMarkers.removeChild(t.dom),t.path='')}),this.currentMarkersSelectionType=!1)}isMonotoneous(){return this.waveform?this.waveform.isMonotoneous():!!this.xmonotoneous}findLocalMinMax(e,t,i){return!!this.waveform&&this.waveform.findLocalMinMax(e,t,i)}}function drawMarkerXY(e,t,i,r,a){if(t){if(e.options.markersIndependant){var s=e.getMarkerDomIndependent(e.counter2,t),n='M '+i+' '+r+' ';n+=t.markerPath+' ',s.setAttribute('d',n)}a.path=a.path||'',a.path+='M '+i+' '+r+' ',a.path+=t.markerPath+' '}}mix(SerieLine,ErrorBarMixin);var Serie3DMixin={getX:function(e){return(e=this.getXAxis().getPx(e))-e%0.2+this.getXAxis().getZProj(this.options.zpos)},getY:function(e){return(e=this.getYAxis().getPx(e))-e%0.2+this.getYAxis().getZProj(this.options.zpos)},getZPos:function(){return this.options.zpos},getMinX:function(e){return e?getZCorrectedValue(this,!0,!0):this.minX},getMaxX:function(e){return e?getZCorrectedValue(this,!0,!1):this.maxX},getMinY:function(e){return e?getZCorrectedValue(this,!1,!0):this.minY},getMaxY:function(e){return e?getZCorrectedValue(this,!1,!1):this.maxY}};function getZCorrectedValue(e,t,r){let a=e.getWaveforms(),s,i,n,o,l;for(let p of a)for(s=0,i=p.getLength(),n=p.getData();s<i;s+=1)o=t?e.getXAxis().getVal(e.getX(p.getX(s,!0))):e.getYAxis().getVal(e.getY(n[s])),l=0==s?o:r?Math.min(l,o):Math.max(l,o);return l}class SerieLine3D extends SerieLine{static defaults(){return{zpos:0}}constructor(){super(...arguments)}setZPos(e){return this.options.zpos=e,this}setz(){return this.setZPos(...arguments)}}mix(SerieLine3D,Serie3DMixin);class SerieBar extends SerieLine{constructor(){super(...arguments),this.groupMain=document.createElementNS(this.graph.ns,'g'),this.pathDom=document.createElementNS(this.graph.ns,'path'),this.groupMain.appendChild(this.pathDom),this.styles={},this.styles.unselected={lineColor:this.options.lineColor,lineStyle:this.options.lineStyle,lineWidth:this.options.lineWidth,fillColor:this.options.fillColor,fillOpacity:this.options.fillOpacity,markers:this.options.markers}}setData(e){for(var t in this.data=e,this.minY=Number.MAX_SAFE_INTEGER,this.maxY=Number.MIN_SAFE_INTEGER,this.data)this._checkY(this.data[t]);return this}setFillColor(e,t,i){return t=t||'unselected',this.styles[t]=this.styles[t]||{},this.styles[t].fillColor=e,i&&this.setFillColor(e,'selected'),this.styleHasChanged(t),this}getFillColor(e){return this.getStyle(e).fillColor}setFillOpacity(e,t,i){return t=t||'unselected',this.styles[t]=this.styles[t]||{},this.styles[t].fillOpacity=e,i&&this.setLineWidth(e,'selected'),this.styleHasChanged(t),this}getFillOpacity(e){return this.getStyle(e).fillOpacity||1}applyLineStyles(){this.applyLineStyle(this.pathDom)}applyLineStyle(e){e.setAttribute('stroke',this.getLineColor()),e.setAttribute('stroke-width',this.getLineWidth()),this.getLineDashArray()?e.setAttribute('stroke-dasharray',this.getLineDashArray()):e.removeAttribute('stroke-dasharray'),e.setAttribute('fill',this.getFillColor()),e.setAttribute('fill-opacity',this.getFillOpacity()||1)}draw(){var e='';for(var t in this.error&&this.errorDrawInit(),this.data)this.categoryIndices[t]&&(e+='M '+this.getXAxis().getPos(this.categoryIndices[t])+' '+this.getYAxis().getPos(0)+' V '+this.getYAxis().getPos(this.data[t])+' h '+this.getXAxis().getDeltaPx(1/this.nbCategories)+' V '+this.getYAxis().getPos(0),this.error&&this.errorAddPointBarChart(t,this.data[t],this.getXAxis().getPos(this.categoryIndices[t]+0.5/this.nbCategories),this.getYAxis().getPos(this.data[t])));this.error&&this.errorDraw(),this.pathDom.setAttribute('d',e),this.applyLineStyles()}setMarkers(){}getUsedCategories(){return Object.keys(this.data)}}class SerieBox extends Serie{static default(){return{orientation:'y',maxBoxWidth:20,defaultStyle:{meanLineColor:'rgb( 100, 0, 0 )',meanLineWidth:2,boxAboveLineWidth:1,boxAboveLineColor:'rgb( 0, 0, 0 )',boxAboveFillColor:'transparent',boxAboveFillOpacity:1,boxBelowLineWidth:1,boxBelowLineColor:'rgb( 0, 0, 0 )',boxBelowFillColor:'transparent',boxBelowFillOpacity:1,barAboveLineColor:'rgba( 0, 0, 0, 1 )',barAboveLineWidth:1,barBelowLineColor:'rgba( 0, 0, 0, 1 )',barBelowLineWidth:1,outlierLineWidth:1,outlierLineColor:'rgb( 255, 255, 255 )',outlierFillColor:'rgb( 0, 0, 0 )',outlierFillOpacity:1}}}constructor(){super(...arguments),this.groupMain=document.createElementNS(this.graph.ns,'g'),this.pathDom=document.createElementNS(this.graph.ns,'path'),this.groupMain.appendChild(this.pathDom),this.styles={},this.styles.unselected=this.options.defaultStyle}setData(e,t){if(this.data=e,!Array.isArray(e))return;let r,a,s,n,o;for(var l in'y'==this.options.orientation?(r=this.getXAxis(),a=this.getYAxis(),s=this._checkX.bind(this),n=this._checkY.bind(this),o=!0,this.minY=e[0].Q2,this.maxY=e[0].Q2,this.maxX=e[0].x,this.minX=e[0].x):(r=this.getYAxis(),a=this.getXAxis(),s=this._checkY.bind(this),n=this._checkX.bind(this),o=!1,this.minX=e[0].Q2,this.maxX=e[0].Q2,this.maxY=e[0].y,this.minY=e[0].y),t&&(s=function(){},n=function(){}),r&&a||throwError('Error in setting data of the box serie. The X and Y axes must be set beforehand'),this.data)o?(s(this.data[l].x),this.data[l].pos=this.data[l].x):(s(this.data[l].y),this.data[l].pos=this.data[l].y),this.data[l].Q3&&n(this.data[l].Q3),this.data[l].Q1&&n(this.data[l].Q1),this.data[l].whiskers?Array.isArray(this.data[l].whiskers)?(0<this.data[l].whiskers.length&&n(this.data[l].whiskers[0]),1<this.data[l].whiskers.length&&n(this.data[l].whiskers[1])):(n(this.data[l].whiskers),this.data[l].whiskers=[this.data[l].whiskers]):this.data[l].whiskers=[],Array.isArray(this.data[l].outliers)?this.data[l].outliers.map((e)=>n(e)):this.data[l].outliers=[];return this.dataHasChanged(),this.graph.updateDataMinMaxAxes(),this}_style(e,t,i='unselected',r=!1){return this.styles[i]=this.styles[i]||{},this.styles[i][e]=t,r&&this._set(e,t,'selected'),this.styleHasChanged(i),this}_gstyle(e,t){return this.getStyle(t)[e]}getStyle(e='unselected'){return this.styles[e]||{}}setMeanLineColor(){return this._style('meanLineColor',...arguments)}getMeanLineColor(){return this._gstyle('meanLineColor',...arguments)}setStyle(e,t='unselected'){this.styles[t]=extend({},this.default().defaultStyle,this.styles.unselected,e),this.styleHasChanged(t)}setMeanLineWidth(){return this._style('meanLineWidth',...arguments)}getMeanLineWidth(){return this._gstyle('meanLineWidth',...arguments)}setBoxAboveLineColor(){return this._style('boxAboveLineColor',...arguments)}getBoxAboveLineColor(){return this._gstyle('boxAboveLineColor',...arguments)}setBoxBelowLineColor(){return this._style('boxBelowLineColor',...arguments)}getBoxBelowLineColor(){return this._gstyle('boxBelowLineColor',...arguments)}setBoxAboveLineWidth(){return this._style('boxAboveLineWidth',...arguments)}getBoxAboveLineWidth(){return this._gstyle('boxAboveLineWidth',...arguments)}setBoxBelowLineWidth(){return this._style('boxBelowLineWidth',...arguments)}getBoxBelowLineWidth(){return this._gstyle('boxBelowLineWidth',...arguments)}setBoxAboveFillColor(){return this._style('boxAboveFillColor',...arguments)}getBoxAboveFillColor(){return this._gstyle('boxAboveFillColor',...arguments)}setBoxBelowFillColor(){return this._style('boxBelowFillColor',...arguments)}getBoxBelowFillColor(){return this._gstyle('boxBelowFillColor',...arguments)}setBoxAboveFillOpacity(){return this._style('boxAboveFillOpacity',...arguments)}getBoxAboveFillOpacity(){return this._gstyle('boxAboveFillOpacity',...arguments)}setBoxBelowFillOpacity(){return this._style('boxBelowFillOpacity',...arguments)}getBoxBelowFillOpacity(){return this._gstyle('boxBelowFillOpacity',...arguments)}setBarAboveLineColor(){return this._style('barAboveLineColor',...arguments)}getBarAboveLineColor(){return this._gstyle('barAboveLineColor',...arguments)}setBarBelowLineColor(){return this._style('barBelowLineColor',...arguments)}getBarBelowLineColor(){return this._gstyle('barBelowLineColor',...arguments)}setBarAboveLineWidth(){return this._style('barAboveLineWidth',...arguments)}getBarAboveLineWidth(){return this._gstyle('barAboveLineWidth',...arguments)}setBarBelowLineWidth(){return this._style('barBelowLineWidth',...arguments)}getBarBelowLineWidth(){return this._gstyle('barBelowLineWidth',...arguments)}setOutlierLineColor(){return this._style('outlierLineColor',...arguments)}getOutlierLineColor(){return this._gstyle('outlierLineColor',...arguments)}setOutlierLineWidth(){return this._style('outlierLineWidth',...arguments)}getOutlierLineWidth(){return this._gstyle('outlierLineWidth',...arguments)}setOutlierFillColor(){return this._style('outlierFillColor',...arguments)}getOutlierFillColor(){return this._gstyle('outlierFillColor',...arguments)}setOutlierFillOpacity(){return this._style('outlierFillOpacity',...arguments)}getOutlierFillOpacity(){return this._gstyle('outlierFillOpacity',...arguments)}applyLineStyles(){this.applyLineStyle(this.pathDom)}applyLineStyle(e){e.setAttribute('stroke',this.getLineColor()),e.setAttribute('stroke-width',this.getLineWidth()),e.removeAttribute('stroke-dasharray'),e.setAttribute('fill',this.getFillColor()),e.setAttribute('fill-opacity',this.getFillOpacity()||1)}draw(){if(!this.data)return;let e='y'==this.options.orientation?this.getYAxis():this.getXAxis(),t='y'==this.options.orientation?this.getXAxis():this.getYAxis(),r,a,s,n,o,p,d,g;if(emptyDom(this.groupMain),'category'==t.getType())a=t.getRelPx(0.8/this.nbCategories);else{a=this.options.maxBoxWidth;for(var c=0,i=this.data.length;c<i-1;c++)a=Math.min(a,Math.abs(t.getPx(this.data[c+1].pos)-t.getPx(this.data[c].pos)))}for(var c=0,i=this.data.length;c<i;c++){if('category'==t.getType()){let i='y'==this.options.orientation?this.data[c].x:this.data[c].y;if(!!this.categoryIndices.hasOwnProperty(i))r=[t.getPos(this.categoryIndices[i])+1.2*a/2];else if(Array.isArray(this._linkedToScatterSeries))for(let s of this._linkedToScatterSeries)if(s.categoryIndices.hasOwnProperty(i)){r=[t.getPos(s.categoryIndices[i])+1.2*a/2],e='y'==this.options.orientation?s.getYAxis():s.getXAxis();break}}else r=[t.getPos('y'==this.options.orientation?this.data[c].x:this.data[c].y),a];s=e.getPos(this.data[c].Q2),n=e.getPos(this.data[c].Q3),o=e.getPos(this.data[c].Q1),this.data[c].whiskers.map((t)=>{t<this.data[c].Q1?d=e.getPos(t):p=e.getPos(t)}),g=this.data[c].outliers.map((t)=>e.getPos(t));var l=document.createElementNS(this.graph.ns,'line');this.applyMeanStyle(l);var u=document.createElementNS(this.graph.ns,'rect'),h=document.createElementNS(this.graph.ns,'rect');'y'==this.options.orientation?(u.setAttribute('width',a),u.setAttribute('x',r[0]-a/2),h.setAttribute('width',a),h.setAttribute('x',r[0]-a/2),l.setAttribute('x1',r[0]-a/2),l.setAttribute('x2',r[0]+a/2),l.setAttribute('y1',s),l.setAttribute('y2',s)):(u.setAttribute('height',a),u.setAttribute('y',r[0]-a/2),h.setAttribute('height',a),h.setAttribute('y',r[0]-a/2),l.setAttribute('y1',r[0]-a/2),l.setAttribute('y2',r[0]+a/2),l.setAttribute('x1',s),l.setAttribute('x2',s)),this.boxPos(u,s,n,'x'==this.options.orientation),this.boxPos(h,s,o,'x'==this.options.orientation),this.applyBoxStyle(u,h);var x=document.createElementNS(this.graph.ns,'line'),m=document.createElementNS(this.graph.ns,'line');'y'==this.options.orientation?(void 0!==p&&(x.setAttribute('y1',n),x.setAttribute('y2',p),x.setAttribute('x1',r[0]),x.setAttribute('x2',r[0])),void 0!==d&&(m.setAttribute('y1',o),m.setAttribute('y2',d),m.setAttribute('x1',r[0]),m.setAttribute('x2',r[0]))):(void 0!==p&&(x.setAttribute('x1',n),x.setAttribute('x2',p),x.setAttribute('y1',r[0]),x.setAttribute('y2',r[0])),void 0!==d&&(m.setAttribute('x1',o),m.setAttribute('x2',d),m.setAttribute('y1',r[0]),m.setAttribute('y2',r[0]))),g.map((e)=>{let t=document.createElementNS(this.graph.ns,'circle');t.setAttribute('r',2),'y'==this.options.orientation?(t.setAttribute('cx',r[0]),t.setAttribute('cy',e)):(t.setAttribute('cy',r[0]),t.setAttribute('cx',e)),this.setOutlierStyle(t),this.groupMain.appendChild(t)}),void 0!==p&&this.groupMain.appendChild(x),void 0!==d&&this.groupMain.appendChild(m),void 0!==n&&this.groupMain.appendChild(u),void 0!==o&&this.groupMain.appendChild(h),this.groupMain.appendChild(l),this.applyWhiskerStyle(x,m)}}applyBoxStyle(e,t){e.setAttribute('stroke',this.getBoxAboveLineColor()),e.setAttribute('stroke-width',this.getBoxAboveLineWidth()),this.getBoxAboveFillColor()!==void 0&&e.setAttribute('fill',this.getBoxAboveFillColor()),this.getBoxAboveFillOpacity()!==void 0&&e.setAttribute('fill-opacity',this.getBoxAboveFillOpacity()),t.setAttribute('stroke',this.getBoxBelowLineColor()),t.setAttribute('stroke-width',this.getBoxBelowLineWidth()),this.getBoxBelowFillColor()!==void 0&&t.setAttribute('fill',this.getBoxBelowFillColor()),this.getBoxAboveFillOpacity()!==void 0&&t.setAttribute('fill-opacity',this.getBoxBelowFillOpacity())}applyWhiskerStyle(e,t){e.setAttribute('stroke',this.getBarAboveLineColor()),e.setAttribute('stroke-width',this.getBarAboveLineWidth()),t.setAttribute('stroke',this.getBarBelowLineColor()),t.setAttribute('stroke-width',this.getBarBelowLineWidth())}applyMeanStyle(e){e.setAttribute('stroke',this.getMeanLineColor()),e.setAttribute('stroke-width',this.getMeanLineWidth())}setOutlierStyle(e){e.setAttribute('stroke',this.getOutlierLineColor()),e.setAttribute('stroke-width',this.getOutlierLineWidth()),this.getBoxBelowFillColor()!==void 0&&e.setAttribute('fill',this.getOutlierFillColor()),this.getBoxAboveFillOpacity()!==void 0&&e.setAttribute('fill-opacity',this.getOutlierFillOpacity())}getCategoryIndex(e){if(!this.categories)throw new Error('No categories were defined. Probably axis.setSeries was not called');for(var t=0;t<this.categories.length;t++)if(this.categories[t].name==e)return t;return!1}setMarkers(){}boxPos(e,t,i,r){t>i?(e.setAttribute(r?'x':'y',i),e.setAttribute(r?'width':'height',t-i)):(e.setAttribute(r?'x':'y',t),e.setAttribute(r?'width':'height',i-t))}getUsedCategories(){let e='y'==this.options.orientation?'x':'y',t=this.data.map((t)=>t[e]);return Array.isArray(this._linkedToScatterSeries)&&this._linkedToScatterSeries.map((e)=>{e.getUsedCategories().map((e)=>{let i;-1<(i=t.indexOf(e))&&t.splice(i,1)})}),t}linkToScatterSerie(...e){this._linkedToScatterSeries=e}}class SerieLineColor extends SerieLine{constructor(){super(...arguments),this.lines=this.lines||{}}setColors(e){this.colors=e}_draw(){var t=this,e=this._dataToUse,r=0,i=!1,a=!1,s=this.getXAxis(),n=this.getYAxis(),o=s.getCurrentMin(),p=n.getCurrentMin(),d=s.getCurrentMax(),g=n.getCurrentMax(),c,u,h,m,x,u,y,b,A,f;for(this.eraseLines(),this.isFlipped(),this.currentLine='',h=this.waveform.getLength(),c=0;c<h;c+=2){if(m=this.waveform.getX(c),x=this.waveform.getY(c),m<o&&i<o||m>d&&i>d||(x<p&&a<p||x>g&&a>g)&&!this.options.lineToZero){i=m,a=x;continue}if(this.counter2=c,this.markersShown()&&this.getMarkerCurrentFamily(this.counter2),A=this.getX(m),f=this.getY(x),A!=y||f!=b){if(isNaN(A)||isNaN(f)){0<this.counter;continue}var S=this.colors[c];this._addPoint(A,f,m,x,y,b,i,a,c,S,!1,!0),y=A,b=f,i=m,a=x}}if(this.latchLines(),this._tracker){this._trackerDom&&this._trackerDom.remove();var k=this.groupLines.cloneNode(!0);this.groupMain.appendChild(k);for(var r=0,M=k.children.length;r<M;r++)k.children[r].setAttribute('stroke','transparent'),k.children[r].setAttribute('stroke-width','25px'),k.children[r].setAttribute('pointer-events','stroke');t._trackerDom=k,t.groupMain.addEventListener('mousemove',function(i){var e=t.graph._getXY(i),r=t.handleMouseMove(!1,!1);t._trackingCallback(t,r,e.x,e.y)}),t.groupMain.addEventListener('mouseleave',function(){t._trackingOutCallback(t)})}return this}_addPoint(e,t,i,r,a,s,n,o,l,p){if(void 0!==a&&void 0!==s&&!(isNaN(e)||isNaN(t))){p._rgb&&(p='rgba('+p._rgb[0]+','+p._rgb[1]+','+p._rgb[2]+','+(p._rgb[3]||1)+')');var d=this.lines[p];d||(d=this.lines[p]={object:document.createElementNS(this.graph.ns,'path'),path:'',color:p},d.object.setAttribute('stroke',p),d.color=p,this.groupLines.appendChild(d.object)),d.path+='M '+a+' '+s+' L '+e+' '+t,this.hasErrors()&&this.errorAddPoint(l,i,r,e,t)}}removeExtraLines(){}latchLines(){for(var e in this.lines)this.lines[e].object.setAttribute('d',this.lines[e].path)}eraseLines(){for(var e in this.lines)this.lines[e].path='',this.lines[e].object.setAttribute('d','')}applyLineStyle(e){e.setAttribute('stroke-width',this.getLineWidth()),this.getLineDashArray()?e.setAttribute('stroke-dasharray',this.getLineDashArray()):e.removeAttribute('stroke-dasharray'),e.setAttribute('fill','none')}}var type='scatter';class SerieScatter extends Serie{constructor(){var e=Number.MIN_VALUE,t=Number.MAX_VALUE;super(...arguments),this.id=Math.random()+Date.now(),this.shapes=[],this.shown=!0,this.data=[],this.shapesDetails=[],this.shapes=[],this._type=type,mapEventEmission(this.options,this),this._isMinOrMax={x:{min:!1,max:!1},y:{min:!1,max:!1}},this.groupPoints=document.createElementNS(this.graph.ns,'g'),this.groupMain=document.createElementNS(this.graph.ns,'g'),this.additionalData={},this.selectedStyleGeneral={},this.selectedStyleModifiers={},this.groupPoints.addEventListener('mouseover',(t)=>{var e=parseInt(t.target.parentElement.getAttribute('data-shapeid'));this.emit('mouseover',e,this.waveform.getX(e),this.waveform.getY(e))}),this.groupPoints.addEventListener('mouseout',(t)=>{var e=parseInt(t.target.parentElement.getAttribute('data-shapeid'));this.emit('mouseout',e,this.waveform.getX(e),this.waveform.getY(e))}),this.minX=t,this.minY=t,this.maxX=e,this.maxY=e,this.groupMain.appendChild(this.groupPoints),this.currentAction=!1,this.initExtended1&&this.initExtended1(),this.styles={},this.styles.unselected={},this.styles.selected={},this.styles.unselected.default={shape:'circle',cx:0,cy:0,r:3,stroke:'transparent',fill:'black'},this.styles.selected.default={shape:'circle',cx:0,cy:0,r:4,stroke:'transparent',fill:'black'}}setDataCategory(e){for(let t of e)this._checkY(t.y.getMaxY()),this._checkY(t.y.getMinY());return this.data=e,this.dataHasChanged(),this.graph.updateDataMinMaxAxes(),this}empty(){for(;this.groupPoints.firstChild;)this.groupPoints.removeChild(this.groupPoints.firstChild)}getSymbolForLegend(){if(this.symbol)return this.symbol;var e=document.createElementNS(this.graph.ns,'g');e.setAttribute('data-shapeid',-1);var t=this.doShape(e,this.styles.unselected.default),r=this.getStyle('unselected',-1,!0);for(var a in r[-1])'shape'!=a&&t.setAttribute(a,r[-1][a]);return e}setStyle(e,t,i='unselected'){return'string'==typeof t&&(i=t,t=!1),this.styles[i]=this.styles[i]||{},this.styles[i].all=e,this.styles[i].modifiers=t,this.styleHasChanged(i),this}draw(e){if(e||this.hasDataChanged()||this.hasStyleChanged('unselected')){var t=0,i='category'==this.getXAxis().getType(),r,a;this._drawn=!0,this.dataHasChanged(!1),this.styleHasChanged(!1),this.groupMain.removeChild(this.groupPoints);var s=[];if(t=0,this.hasErrors()&&this.errorDrawInit(),i){for(let e=0;t<this.data.length;t++)if(this.categoryIndices.hasOwnProperty(this.data[t].x)){this.error;for(var o=0,n=this.data[t].y.getLength();o<n;o++)a=this.getY(this.data[t].y.getY(o)),r=this.getX(o/(n-1)*(0.8/this.nbCategories)+this.categoryIndices[this.data[t].x]+0.1/this.nbCategories),o++,this.shapesDetails[e]=this.shapesDetails[e]||[],this.shapesDetails[e][0]=r,this.shapesDetails[e][1]=a,s.push(e),e++}}else for(;t<this.waveform.getLength();t++){if(this.waveform.getX(t)<this.getXAxis().getCurrentMin()||this.waveform.getX(t)>this.getXAxis().getCurrentMax()||this.waveform.getY(t)<this.getYAxis().getCurrentMin()||this.waveform.getY(t)>this.getYAxis().getCurrentMax()){this.shapes[t]&&this.shapes[t].setAttribute('display','none');continue}this.shapes[t]&&this.shapes[t].setAttribute('display','initial'),r=this.getX(this.waveform.getX(t)),a=this.getY(this.waveform.getY(t)),this.hasErrors()&&this.errorAddPoint(t,this.waveform.getX(t),this.waveform.getY(t),r,a),this.shapesDetails[t]=this.shapesDetails[t]||[],this.shapesDetails[t][0]=r,this.shapesDetails[t][1]=a,s.push(t)}this.hasErrors()&&this.errorDraw(),this.applyStyle('unselected',s),this.groupMain.appendChild(this.groupPoints)}}_addPoint(e,t,i){let r=document.createElementNS(this.graph.ns,'g'),a;r.setAttribute('transform','translate('+e+', '+t+')'),r.setAttribute('data-shapeid',i),a=this.extraStyle&&this.extraStyle[i]?this.doShape(r,this.extraStyle[i]):this.stdStylePerso?this.doShape(r,this.stdStylePerso):this.doShape(r,this.stdStyle),this.shapes[i]=a,this.groupPoints.appendChild(r)}doShape(e,t){var i=document.createElementNS(this.graph.ns,t.shape);return e.appendChild(i),i}getStyle(e,t,r){var e=e||'unselected',a={},s;'number'==typeof t?s=[t]:Array.isArray(t)&&(s=t);var n,t,o,p,d;this.styles[e].all!==void 0&&(d=this.styles[e].all,'function'==typeof d?d=d():!1===d&&(d={}));for(var c=0,i=s.length;c<i;c++){if(t=s[c],n=this.shapes[t],(o=this.styles[e].modifiers)&&('function'==typeof o||o[t])?('function'==typeof o?p=o(t,n):o[t]&&(p=o[t]),a[t]=Object.assign({},d,p)):void 0===d?a[t]=this.styles[e].default:a[t]=d,a[t]||(a[t]=d),!n){if(!a[t].shape)throw console.error(p),'No shape was defined with this style.';var l=document.createElementNS(this.graph.ns,'g');l.setAttribute('data-shapeid',t),this.shapes[t]=this.doShape(l,a[t]),this.groupPoints.appendChild(l),n=this.shapes[t]}r||n.parentNode.setAttribute('transform','translate('+this.shapesDetails[t][0]+', '+this.shapesDetails[t][1]+')')}return a}applyStyle(e,t,r){var a=this.getStyle(e,t,r),s,i;for(s in a)for(i in a[s])'shape'!==i&&(a[s][i]?this.shapes[s].setAttribute(i,a[s][i]):this.shapes[s].removeAttribute(i))}unselectPoint(e){this.selectPoint(e,!1)}selectPoint(e,t,r){if(!(this.shapesDetails[e][2]&&this.shapesDetails[e][2]==r)){if('string'==typeof t&&(r=t,t=void 0),Array.isArray(e))return this.selectPoints(e);if(this.shapes[e]&&this.shapesDetails[e])if((this.shapesDetails[e][2]||!1===t)&&!0!==t){var a=this.shapesDetails[e][2];this.shapesDetails[e][2]=!1;var s=this.getStyle(a,e,!0);for(var n in s[e])this.shapes[e].removeAttribute(n);this.applyStyle('unselected',e,!0)}else r=r||'selected',this.shapesDetails[e][2]=r,this.applyStyle(r,e,!0)}}getUsedCategories(){return'object'==typeof this.data[0]?this.data.map((e)=>e.x):[]}}mix(SerieScatter,ErrorBarMixin);class SerieZone extends Serie{static default(){return{fillColor:'rgba( 0, 0, 0, 0.1 )',lineColor:'rgba( 0, 0, 0, 1 )',lineWidth:'1px'}}constructor(){super(...arguments),this.selectionType='unselected',this.id=guid(),this.groupZones=document.createElementNS(this.graph.ns,'g'),this.groupMain=document.createElementNS(this.graph.ns,'g'),this.lineZone=document.createElementNS(this.graph.ns,'path'),this.lineZone.setAttribute('stroke','black'),this.lineZone.setAttribute('stroke-width','1px'),this.groupMain.appendChild(this.groupZones),this.groupZones.appendChild(this.lineZone),this.applyLineStyle(this.lineZone),this.styleHasChanged(),this.clip=document.createElementNS(this.graph.ns,'clipPath'),this.clipId=guid(),this.clip.setAttribute('id',this.clipId),this.graph.defs.appendChild(this.clip)}setWaveform(...e){var t=Math.max,i=Math.min;return this.waveforms=e,this.waveforms=this.waveforms.map((e)=>e instanceof Waveform?e:new Waveform(e)),this.minX=this.waveforms[0].getXMin(),this.maxX=this.waveforms[0].getXMax(),this.minY=this.waveforms[0].getMin(),this.maxY=this.waveforms[0].getMax(),this.waveforms.map((e)=>{this.minX=i(e.getXMin(),this.minX),this.maxX=t(e.getXMin(),this.maxX),this.minY=i(e.getMin(),this.minY),this.maxY=t(e.getMax(),this.maxY)}),this.graph.updateDataMinMaxAxes(),this.dataHasChanged(),this}setWaveforms(){return this.setWaveform(...arguments)}getWaveforms(){return this.waveforms}setMinMaxWaveforms(e,t){return this.waveforms=[e,t.reverse()],this}empty(){for(;this.group.firstChild;)this.group.removeChild(this.group.firstChild)}draw(e){if(e||this.hasDataChanged()){if(!this.waveforms)return;let e=0,t=0,i=0,r=0,a=0,s='',n=!1,o;const l=this.getXAxis().getMinPx(),p=this.getXAxis().getMaxPx(),d=this.getYAxis().getMinPx(),g=this.getYAxis().getMaxPx(),c=this.getXAxis().getCurrentMin(),u=this.getXAxis().getCurrentMax(),h=this.getYAxis().getCurrentMin(),x=this.getYAxis().getCurrentMax();this.groupMain.removeChild(this.groupZones);for(let l of this.waveforms)for(a=0;a<l.getLength();a+=1)if(e=l.getX(a,!0),t=l.getY(a,!0),t[a]<h?r=this.getY(h):t[a]>x&&(r=this.getY(x)),e===e){if(t!==t){if(0==s.length)continue;s+='L '+i+', '+this.getY(l.getMinY()),n=!0;continue}if(r=this.getY(t),i=this.getX(e),e<c||e>u){o=[e,t[a],i,r];continue}n&&(s+=' M '+i+', '+this.getY(l.getMinY())+' ',n=!1),0<s.length&&(s+=' L '),o?(s+=o[2]+','+o[3]+' ',o=!1):s+=i+','+r+' '}''==s?this.lineZone.setAttribute('d',''):this.lineZone.setAttribute('d','M '+s+' z'),this.groupMain.appendChild(this.groupZones)}this.hasStyleChanged(this.selectionType)&&(this.applyLineStyle(this.lineZone),this.styleHasChanged(!1))}applyLineStyle(e){e.setAttribute('stroke',this.getLineColor()),e.setAttribute('stroke-width',this.getLineWidth()),e.setAttribute('fill',this.getFillColor()),e.setAttribute('fill-opacity',this.getFillOpacity()),e.setAttribute('stroke-opacity',this.getLineOpacity())}setLineWidth(e){return this.options.lineWidth=e,this.styleHasChanged(),this}getLineWidth(){return this.options.lineWidth}setLineOpacity(e){return this.options.lineOpacity=e,this.styleHasChanged(),this}getLineOpacity(){return this.options.lineOpacity}setLineColor(e){return this.options.lineColor=e,this.styleHasChanged(),this}getLineColor(){return this.options.lineColor}setFillOpacity(e){return this.options.fillOpacity=e,this.styleHasChanged(),this}getFillOpacity(){return this.options.fillOpacity}setFillColor(e){return this.options.fillColor=e,this.styleHasChanged(),this}getFillColor(){return this.options.fillColor}}class SerieZone3D extends SerieZone{static default(){return{zpos:0}}constructor(){super(...arguments)}setZPos(e){return this.options.zpos=e,this}setz(){return this.setZPos(...arguments)}}mix(SerieZone3D,Serie3DMixin);class SerieDensityMap extends Serie{constructor(){super(...arguments),mapEventEmission(this.options,this),this.groupMain=document.createElementNS(this.graph.ns,'g'),this.rects=[],this.paths=[],this.recalculateBinsOnDraw=!1}setData(e){var t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;this.minX=this.maxX=this.minY=this.maxY=0;var a=0,i=e.length;for(this.data=e,this.minX=t,this.minY=t,this.maxX=r,this.maxY=r,a=0;a<i;a++)this._checkX(e[a][0]),this._checkY(e[a][1]);return this.dataHasChanged(),this.graph.updateDataMinMaxAxes(),this}calculateDensity(e,t,r,a,s,n){var o=[],p=this.data.length,l=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,g,i,c;for(g=0;g<p;g++)(i=~~((this.data[g][0]-e)/t),c=~~((this.data[g][1]-a)/s),!(i>r||c>n||0>i||0>c))&&(o[i]=o[i]||[],o[i][c]=o[i][c]+1||1,l=o[i][c]<l?o[i][c]:l,d=o[i][c]>d?o[i][c]:d);return this.maxIndexX=r,this.maxIndexY=n,this.binMin=l,this.binMax=d,this.deltaX=t,this.deltaY=s,this.fromX=e,this.fromY=a,this.numX=r,this.numY=n,this.densitymap=o,o}setDensityMap(e,t,r,a,s){var n=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,l,i;for(l=0;l<e.length;l++)for(i=0;i<e[l].length;i++)n=e[l][i]<n?e[l][i]:n,o=e[l][i]>o?e[l][i]:o;return this.maxIndexX=e.length,this.maxIndexY=e[0].length,console.log(e),this.binMin=n,this.binMax=o,this.deltaX=r,this.deltaY=s,this.fromX=t,this.fromY=a,this.numX=this.maxIndexX,this.numY=this.maxIndexY,this.densitymap=e,e}calculateDensityWeighted(e,t,r,a,s,n){var o=Math.floor,p=[],d=this.data.length,l=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,c,i,u,h,x,m,y,b,A,f,S;for(c=0;c<d;c++)(m=(this.data[c][0]-e)/t-0.5,y=(this.data[c][1]-a)/s-0.5,i=o(m),u=o(y),b=i,f=u,A=i+1,S=u+1,h=1-(m-i),x=1-(y-u),!(i>r||u>n||0>i||0>u))&&(p[b]=p[b]||[],p[A]=p[A]||[],p[b][f]=p[b][f]||0,p[A][f]=p[A][f]||0,p[b][S]=p[b][S]||0,p[A][S]=p[A][S]||0,p[b][f]+=h*x,p[A][f]+=(1-h)*x,p[b][S]+=h*(1-x),p[A][S]+=(1-h)*(1-x),l=p[b][f]<l?p[b][f]:l,g=p[b][f]>g?p[b][f]:g,l=p[A][f]<l?p[A][f]:l,g=p[A][f]>g?p[A][f]:g,l=p[b][S]<l?p[b][S]:l,g=p[b][S]>g?p[b][S]:g,l=p[A][S]<l?p[A][S]:l,g=p[A][S]>g?p[A][S]:g);return this.maxIndexX=r,this.maxIndexY=n,this.binMin=l,this.binMax=g,this.deltaX=t,this.deltaY=s,this.fromX=e,this.fromY=a,this.numX=r,this.numY=n,this.densitymap=p,p}autoBins(e,t){return this.numX=e||400,this.numY=t||this.numX,this.calculateDensity(this.minX,(this.maxX-this.minX)/e,e,this.minY,(this.maxY-this.minY)/t,t),this.recalculateBinsOnDraw=!1,this}setPxPerBin(e,t,i){return e&&this.calculationDensityMap({from:'min',to:'max',pxPerBin:e,weighted:i}),t&&this.calculationDensityMap(!1,{from:'min',to:'max',pxPerBin:t,weighted:i}),this}setBinsFromTo(e,t,i,r){return this.densityMapCalculation=this.densityMapCalculation||{},this.densityMapCalculation[e]={from:t,to:i,numBins:r},this.calculationDensityMap(),this}calculationDensityMap(e,t){this.method=this.calculateDensityAdvanced,this.densityMapCalculation=this.densityMapCalculation||{},e&&(this.densityMapCalculation.x=e),t&&(this.densityMapCalculation.y=t)}calculateDensityAdvanced(){var e=Math.abs,t={x:{from:0,num:0,delta:0,weighing:!1},y:{from:0,num:0,delta:0,weighing:!1}},r={x:this.graph.drawingSpaceWidth,y:this.graph.drawingSpaceHeight},a={x:this.getXAxis,y:this.getYAxis},s=!1;for(var n in this.densityMapCalculation)if(this.densityMapCalculation[n].weighted&&(s=!0,t[n].weighing=!0),this.densityMapCalculation[n].pxPerBin){var i='min'==this.densityMapCalculation[n].from?a[n].call(this).getCurrentMin():this.densityMapCalculation[n].from,o='max'==this.densityMapCalculation[n].to?a[n].call(this).getCurrentMax():this.densityMapCalculation[n].to,l=e(a[n].call(this).getRelPx(o-i));t[n].num=Math.ceil(r[n]/this.densityMapCalculation[n].pxPerBin),t[n].from=i-e(a[n].call(this).getRelVal((t[n].num*this.densityMapCalculation[n].pxPerBin-l)/2)),t[n].delta=e(a[n].call(this).getRelVal(this.densityMapCalculation[n].pxPerBin))}else t[n].num=this.densityMapCalculation[n].numBins||400,t[n].from='min'==this.densityMapCalculation[n].from?a[n].call(this).getCurrentMin():this.densityMapCalculation[n].from,t[n].delta=this.densityMapCalculation[n].to?(('max'==this.densityMapCalculation[n].to?a[n].call(this).getCurrentMax():this.densityMapCalculation[n].to)-t[n].from)/t[n].num:this.densityMapCalculate[n].delta;(s?this.calculateDensityWeighted:this.calculateDensity).call(this,t.x.from,t.x.delta,t.x.num,t.y.from,t.y.delta,t.y.num)}setColorMapBinBoundaries(e,t,i){return this.colorMapMin=e,this.colorMapMax=t,i||(this.callbackColorMapMinMax='manual'),this}autoColorMapBinBoundaries(){return this.colorMapMin=this.binMin,this.colorMapMax=this.binMax,this}onRedrawColorMapBinBoundaries(e){return this.callbackColorMapMinMax=e,this}colorMapHSL(e,t,r){var a=Math.log,s=Math.round;r=r||'linear';for(var n={exp:function(e){return(Math.exp(1*(e/t))-1)/(2.718281828459045-1)},log:function(e){return(a(e+1)-0)/(a(t+1)-0)},linear:function(e){return(e-0)/(t-0)}},o=0,l=[],p=[],d={h:null,s:null,l:null,a:null},g=e.length-1,c=0,i,u;c<=t;c++){for(var h in i=n[r](c),u=Math.floor(i*g),u==e.length-1&&(u=g-1),i=(i-u/g)/(1/g),d)d[h]=(e[u+1][h]-e[u][h])*i+e[u][h];l[o]='hsl('+d.h+', '+s(100*d.s)+'%, '+s(100*d.l)+'%)',p[o]=d.a,o++}return this.opacities=p,this.colorMap=l,this.colorMapNum=t,this}autoColorMapHSL(e,t='linear'){return this.colorMapHSL(e,100,t),this}getColorIndex(e){return Math.max(0,Math.min(this.colorMapNum,Math.floor((e-this.colorMapMin)/(this.colorMapMax-this.colorMapMin)*this.colorMapNum)))}draw(){var e;if(this.method&&this.method(),!this.callbackColorMapMinMax||void 0==this.colorMapMin||void 0==this.colorMapMax||'auto'==this.callbackColorMapMinMax)this.autoColorMapBinBoundaries();else if('function'==typeof this.callbackColorMapMinMax){var t=this.callbackColorMapMinMax(this.binMin,this.binMax);this.setColorMapBinBoundaries(t[0],t[1],!0)}for(var r=this.getXAxis().getRelPx(this.deltaX),a=this.getYAxis().getRelPx(this.deltaY),s=0;s<this.paths.length;s++)this.paths[s]='';console.log(this.maxIndexX,this.maxIndexY);for(var s=0;s<this.maxIndexX;s++)for(var i=0;i<this.maxIndexY;i++)void 0!=this.densitymap[s]&&void 0!=this.densitymap[s][i]&&(e=this.getColorIndex(this.densitymap[s][i]),this.paths[e]||(this.paths[e]=''),this.paths[e]+=' M '+this.getXAxis().getPx(s*this.deltaX+this.fromX)+' '+this.getYAxis().getPx(i*this.deltaY+this.fromY)+' h '+r+' v '+a+' h -'+r+' z');this.drawRects()}drawRects(){for(var e=0;e<this.paths.length;e++)this.rects[e]||(this.rects[e]=document.createElementNS(this.graph.ns,'path'),this.rects[e].setAttribute('shape-rendering','crispEdges')),void 0!==this.paths[e]&&(this.rects[e].setAttribute('d',this.paths[e]),this.rects[e].setAttribute('fill',this.colorMap[e]),this.rects[e].setAttribute('fill-opacity',this.opacities[e])),this.groupMain.appendChild(this.rects[e])}setOptions(e){return this.options=extend(!0,{},this.defaults(),e||{}),this}}class SerieContour extends SerieLine{constructor(e){super(...arguments),this.negativeDelta=0,this.positiveDelta=0,this.negativeThreshold=0,this.positiveThreshold=0,this.groupMain.setAttribute('clip-path','url(#_clipplot'+e._creation+')')}setData(e,t,r){var t=t||'2D',r=r||'float',a=e.length,s=[],n,i,o,l;for(e instanceof Array||'object'!=typeof e||(this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,e=e.segments,a=e.length),n=0;n<a;n++){for(o=e[n].lines.length,l=this._addData(r,o),i=0;i<o;i+=2)l[i]=e[n].lines[i],this._checkX(l[i]),l[i+1]=e[n].lines[i+1],this._checkY(l[i+1]);s.push({lines:l,zValue:e[n].zValue})}return this.data=s,this.graph.updateDataMinMaxAxes(),this.dataHasChanged(!0),this}draw(e){if(e||this.hasDataChanged()){this.currentLine=0;var t=0,i=this.data.length,r=0,a,s,n,o,l,p,d;this.minZ=Infinity,this.maxZ=-Infinity;var g=this.groupLines.nextSibling;this.groupMain.removeChild(this.groupLines),this.zValues={};var c=0,u=1;this.getFlip()&&(c=0,u=1);var h=this.getYAxis().getCurrentMin(),x=this.getXAxis().getCurrentMin(),m=this.getXAxis().getCurrentMax(),y=this.getYAxis().getCurrentMax();for(this.counter=0,this.currentLineId=0;t<i;t++){for(this.currentLine='',r=0,(d=this.data[t].lines,l=d.length);r<l;r+=4)d[r+c]<x&&d[r+2+c]<x||d[r+u]<h&&d[r+2+u]<h||d[r+u]>y&&d[r+2+u]>y||d[r+c]>m&&d[r+2+c]>m||(n=this.getX(d[r+c]),o=this.getY(d[r+u]),a=this.getX(d[r+2+c]),s=this.getY(d[r+2+u]),a!=n||s!=o)&&(this.currentLine+='M ',this.currentLine+=n,this.currentLine+=' ',this.currentLine+=o,this.currentLine+='L ',this.currentLine+=a,this.currentLine+=' ',this.currentLine+=s,this.counter++);this.currentLine+=' z',p=this._createLine(),p.setAttribute('data-zvalue',this.data[t].zValue),this.zValues[this.data[t].zValue]={dom:p},this.minZ=Math.min(this.minZ,this.data[t].zValue),this.maxZ=Math.max(this.maxZ,this.data[t].zValue)}for(t++,t=this.currentLine+1;t<this.lines.length;t++)this.groupLines.removeChild(this.lines[t]),this.lines.splice(t,1);for(t=0;t<i;t++)this.setColorTo(this.lines[t],this.data[t].zValue,this.minZ,this.maxZ);this.onMouseWheel(0,{shiftKey:!1}),this.groupMain.insertBefore(this.groupLines,g)}else if(this.hasStyleChanged(this.selectionType))for(;t<i;t++)this.setColorTo(this.lines[t],this.data[t].zValue,this.minZ,this.maxZ)}onMouseWheel(t,r,e,a){var s=Math.pow,n=Math.max,o=Math.min;for(var l in t/=250,void 0===e?r.shiftKey&&this.options.hasNegative?(this.negativeDelta=o(0,n(-1,this.negativeDelta+o(0.1,n(-0.1,t)))),this.negativeThreshold=-this.minZ*s(this.negativeDelta,3)):(this.positiveDelta=o(1,n(0,this.positiveDelta+o(0.1,n(-0.1,t)))),this.positiveThreshold=this.maxZ*s(this.positiveDelta,3)):(!a&&(this.negativeThreshold=-e*this.minZ,this.negativeDelta=-s(Math.abs(this.negativeThreshold/-this.minZ),1/3)),a&&(this.positiveThreshold=e*this.maxZ,this.positiveDelta=s(this.positiveThreshold/this.maxZ,1/3))),isNaN(this.positiveDelta)&&(this.positiveDelta=0),isNaN(this.negativeDelta)&&(this.negativeDelta=0),this.zValues)this.zValues[l].dom.setAttribute('display',0<=l&&l>=this.positiveThreshold||0>=l&&l<=this.negativeThreshold?'block':'none');this._shapeZoom&&(this.options.hasNegative?(this._shapeZoom.setHandleNeg(-s(this.negativeDelta,3),this.minZ),this._shapeZoom.showHandleNeg()):this._shapeZoom.hideHandleNeg(),this._shapeZoom.setHandlePos(s(this.positiveDelta,3),this.maxZ))}handleMouseMove(e,t,i){var r=e||this.getXAxis().getMouseVal(),a=i||this.getYAxis().getMouseVal();return{trueX:r,interpolatedY:a,xClosest:r,yClosest:a}}setDynamicColor(e){this.lineColors=e,this.styleHasChanged()}setNegative(e){this.options.hasNegative=e,e&&(this.negativeThreshold=0)}setColorTo(e,t,r,a){if(this.lineColors){var s={h:0,s:0,l:0};for(var n in s)s[n]=0<t?this.lineColors.fromPositive[n]+(this.lineColors.toPositive[n]-this.lineColors.fromPositive[n])*(t/a):this.lineColors.fromNegative[n]+(this.lineColors.toNegative[n]-this.lineColors.fromNegative[n])*(t/r);s.h/=360;var i=hslToRgb(s.h,s.s,s.l);e.setAttribute('stroke','rgb('+i.join()+')')}}getSymbolForLegend(){if(!this.lineForLegend){var e=document.createElementNS(this.graph.ns,'ellipse');e.setAttribute('cx',7),e.setAttribute('cy',0),e.setAttribute('rx',8),e.setAttribute('ry',3),e.setAttribute('cursor','pointer'),this.lineForLegend=e}return this.applyLineStyle(this.lineForLegend,this.maxZ),this.lineForLegend}applyLineStyle(e,t){e.setAttribute('stroke',this.getLineColor()),e.setAttribute('stroke-width',this.getLineWidth()+(this.isSelected()?2:0)),this.getLineDashArray()&&e.setAttribute('stroke-dasharray',this.getLineDashArray()),e.setAttribute('fill','none'),this.setColorTo(e,t===void 0?e.getAttribute('data-zvalue'):t,this.minZ,this.maxZ),this.hasStyleChanged(!1)}setShapeZoom(e){this._shapeZoom=e}}class Shape extends EventEmitter{constructor(){super()}init(e,t){var i=this;if(this.graph=e,this.properties=t||{},this.handles=[],this.options=this.options||{},this.group=document.createElementNS(this.graph.ns,'g'),this.group.setAttribute('clip-path','url(#_clipplot'+e._creation+')'),this._selected=!1,this.createDom(),this._dom&&(this._dom.jsGraphIsShape=this),this.group.jsGraphIsShape=this,this.classes=[],this.transforms=[],this._data.masker){var r=document.createElementNS(this.graph.ns,'mask');this.maskingId=Math.random(),r.setAttribute('id',this.maskingId),this.maskDomWrapper=document.createElementNS(this.graph.ns,'rect'),this.maskDomWrapper.setAttribute('fill','white'),r.appendChild(this.maskDomWrapper);var a=this._dom.cloneNode();r.appendChild(a),this.maskDom=a,this.graph.defs.appendChild(r)}return this.group&&(this._dom&&!this.isHTML()&&this.group.appendChild(this._dom),this.group.addEventListener('mouseover',function(t){i.handleMouseOver(t)}),this.group.addEventListener('mouseout',function(t){i.handleMouseOut(t)}),this.group.addEventListener('mousedown',function(t){i.graph.focus(),i.handleMouseDown(t)}),this.group.addEventListener('click',this.handleClick.bind(this)),this.group.addEventListener('dblclick',function(t){i.handleDblClick(t)})),this.initImpl(),this.graph.emit('shapeNew',this),this}initImpl(){}getData(){return this._data}getType(){return this.type}kill(e){this._inDom&&!e&&this.graph.removeShapeFromDom(this),e||this.graph._removeShape(this),this.graph.stopElementMoving(this),this.graph.emit('shapeRemoved',this),this.emit('removed',this),this._inDom=!1}hide(){return this.hidden?this:(this.hidden=!0,this.isHTML()?this._dom.style.display='none':this.group.style.display='none',this)}isHidden(){return this.hidden}isVisible(){return!this.hidden}show(){return this.hidden?(this.hidden=!1,this.isHTML()?this._dom.style.display='initial':this.group.style.display='initial',this.redraw(),this):this}addClass(e){return this.classes=this.classes||[],-1==this.classes.indexOf(e)&&this.classes.push(e),this.makeClasses(),this}removeClass(e){return this.classes.splice(this.classes.indexOf(e),1),this.makeClasses(),this}makeClasses(){return this._dom&&this._dom.setAttribute('class',this.classes.join(' ')),this}changed(e,t){return e&&(this.graph.emit(e,this,t),this.emit(e,this,t)),this.emit('changed',this,t),this.graph.emit('shapeChanged',this,t),this}setEventReceptacle(){this.rectEvent||(this.rectEvent=document.createElementNS(this.graph.ns,'rect'),this.rectEvent.setAttribute('pointer-events','fill'),this.rectEvent.setAttribute('fill','transparent'),this.group.appendChild(this.rectEvent),this.rectEvent.jsGraphIsShape=this);var e=this.group.getBBox();this.rectEvent.setAttribute('x',e.x),this.rectEvent.setAttribute('y',e.y-10),this.rectEvent.setAttribute('width',e.width),this.rectEvent.setAttribute('height',e.height+20)}setSerie(e){if(e){if(this.serie=e,!e.getXAxis||!e.getYAxis)throw console.error(e),'Serie does not implement the getXAxis or getYAxis method';return this.xAxis=e.getXAxis(),this.yAxis=e.getYAxis(),this}}getSerie(){return this.serie}autoAxes(){return this.xAxis||(this.xAxis=this.graph.getXAxis()),this.yAxis||(this.yAxis=this.graph.getYAxis()),this}setXAxis(e){return this.xAxis=e,this}setYAxis(e){this.yAxis=e}getXAxis(){return this.xAxis||this.autoAxes(),this.xAxis}getYAxis(){return this.yAxis||this.autoAxes(),this.yAxis}setLayer(e){return this.setProp('layer',e),this}getLayer(){var e=this.getProp('layer');return void 0===e?1:e}draw(e,t){return(!this._inDom||e)&&(this.appendToDom(),this._inDom=!0),this.makeLabels(),t||this.redraw(),this.applyStyle(),this}redraw(){return this.hidden?this:(this.position=this.applyPosition(),this.redrawImpl(),!this.position)?(this.updateLabels(),this):(this.updateLabels(),this._applyTransforms(),this)}redrawImpl(){}setProperties(e){this.properties=e,Array.isArray(this.properties.position)||(this.properties.position=[this.properties.position]);for(var t=this,r=0,i=this.properties.position.length,a;r<i;r++)a=Position.check(this.properties.position[r],function(e){return t.getRelativePosition(e)}),this.properties.position[r]=a;return this.emit('propertiesChanged'),this}getRelativePosition(e){var t;if(null!==(t=/position([0-9]*)/.exec(e)))return this.getPosition(t[1]);return null===(t=/labelPosition([0-9]*)/.exec(e))?void 0:this.getLabelPosition(t[1])}getProperties(){return this.properties}setProp(e,t,i){return this.properties=this.properties||{},this.properties[e]=this.properties[e]||[],this.properties[e][i||0]=t,this.emit('propertyChanged',e),this}getProp(e,t){return(this.properties[e]||[])[t||0]}getProps(e){return this.properties[e]||[]}addProp(e,t){this.properties[e]=this.properties[e]||[],this.properties[e].push(t)}resetProp(e){this.properties[e]=[]}setDom(e,t,i){!this._dom||i&&hasSavedAttribute(this._dom,e)||this._dom.setAttribute(e,t)}setDomGroup(e,t){this.group&&this.group.setAttribute(e,t)}setStrokeColor(e){return this.setProp('strokeColor',e),this.overwriteSavedProp('stroke',e),this.applySelectedStyle(),this}getStrokeColor(){return this.getProp('strokeColor')}setFillColor(e){return this.setProp('fillColor',e),this.overwriteSavedProp('fill',e),this.applySelectedStyle(),this}getFillColor(){return this.getProp('fillColor')}setFillOpacity(e){return this.setProp('fillOpacity',e),this.overwriteSavedProp('fill-opacity',e),this.applySelectedStyle(),this}setStrokeWidth(e){return this.setProp('strokeWidth',e),this.overwriteSavedProp('stroke-width',e),this.applySelectedStyle(),this}getStrokeWidth(){return this.getProp('strokeWidth')}setStrokeDasharray(e){return this.setProp('strokeDasharray',e),this.overwriteSavedProp('stroke-dasharray',e),this.applySelectedStyle(),this}setAttributes(e){return this.setProp('attributes',e),this}overwriteSavedProp(e,t){overwriteDomAttribute(this._dom,e,t)}addAttribute(e,t){var i={};return i[e]=t,this.addProp('attributes',i),this}addTransform(e,t){return this.addProp('transforms',{type:e,arguments:Array.isArray(t)?t:[t]}),this}resetTransforms(){return this.resetProp('transforms'),this}setLabelText(e,t=0){return this.setProp('labelText',e,t),this}setLabelData(e,t,i=0){return this.setProp('labelData',t,i),this}getLabelText(e,t=0){return this.getProp('labelText',t)}displayLabel(e=0){return this.setProp('labelVisible',!0,e),this}hideLabel(e=0){return this.setProp('labelVisible',!1,e),this}setLabelColor(e,t=0){return this.setProp('labelColor',e,t),this}setLabelFontSize(e,t=0){return this.setProp('labelFontSize',e,t),this}getLabelPosition(e=0){return this.getProp('labelPosition',e)}setLabelPosition(e,t){var i=Position.check(e,function(e){return r.getRelativePosition(e)}),r;return this.setProp('labelPosition',i,t||0),this}setLabelAngle(e,t){return this.setProp('labelAngle',e,t||0),this}setLabelBaseline(e,t){return this.setProp('labelBaseline',e,t||0),this}setLabelAnchor(e,t){return this.setProp('labelAnchor',e,t||0),this}setLabelSize(e,t){return this.setProp('labelSize',e,t||0),this}setLabelStrokeColor(e,t){return this.setProp('labelStrokeColor',e,t||0),this}setLabelStrokeWidth(e,t){return this.setProp('labelStrokeWidth',e,t||0),this}setLabelBackgroundColor(e,t){return this.setProp('labelBackgroundColor',e,t||0),this}setLabelBackgroundOpacity(e,t){return this.setProp('labelBackgroundOpacity',e,t||0),this}applyGenericStyle(){this.setDom('fill',this.getProp('fillColor'),!0),this.setDom('fill-opacity',this.getProp('fillOpacity'),!0),this.setDom('stroke',this.getProp('strokeColor'),!0),this.setDom('stroke-width',this.getProp('strokeWidth'),!0),this.setDom('stroke-dasharray',this.getProp('strokeDasharray'),!0);for(var e=this.getProps('attributes'),t=0,r=e.length;t<r;t++)for(var a in e[t])this.setDom(a,'function'==typeof e[t][a]?e[t][a].call(this,a):e[t][a],!0);return this._applyTransforms(),this}applyStyle(){return this.applyGenericStyle()}calculatePosition(e){var t;return t=e instanceof Position?e:this.getPosition(e),t?t&&t.compute?t.compute(this.graph,this.getXAxis(),this.getYAxis(),this.getSerie()):void this.graph.throw():void 0}getPosition(e){var t=this.getProp('position',e||0);return this.setProp('position',t=Position.check(t),e),t}setPosition(e,t){var i=this,r=Position.check(e,function(e){return i.getRelativePosition(e)});return this.setProp('position',r,t||0)}sortPositions(e){return this.getProps('position').sort(e),this}_applyTransforms(){var e=this.getProp('transforms'),t='';if(e&&(e=Array.isArray(e)?e:[e],0!=e.length)){for(var r=0;r<e.length;r++){switch(t+=e[r].type+'(',e[r].type){case'translate':let a=e[r].arguments[0].compute(this.graph,this.getXAxis(),this.getYAxis(),this.getSerie());t+=a.x,t+=', ',t+=a.y;break;case'rotate':if(t+=e[r].arguments[0],t+=', ',1==e[r].arguments.length){var i=this.computePosition(0);t+=i.x+', '+i.y}else t+=Position.getDeltaPx(e[r].arguments[1],this.getXAxis()).replace('px',''),t+=', ',t+=Position.getDeltaPx(e[r].arguments[2],this.getYAxis()).replace('px','');}t+=') '}return this.setDomGroup('transform',t),this}}makeLabels(){this._labels=this._labels||[],this._labelsBackground=this._labelsBackground||[],this._labels.map((e)=>{this.group.removeChild(e)}),this._labelsBackground.map((e)=>{this.group.removeChild(e)}),this._labels=[],this._labelsBackground[e]=[];for(var e=0;void 0!==this.getProp('labelText',e);)this._labels[e]||(this._labels[e]=document.createElementNS(this.graph.ns,'text'),this._labels[e].setAttribute('data-label-i',e),this._labels[e].jsGraphIsShape=this,this._labelsBackground[e]=document.createElementNS(this.graph.ns,'rect'),this._labelsBackground[e].setAttribute('data-label-i',e),this._labelsBackground[e].jsGraphIsShape=this,this.group.appendChild(this._labelsBackground[e]),this.group.appendChild(this._labels[e]),this._labels[e].addEventListener('dblclick',(t)=>{t.stopPropagation(),this.labelDblClickListener(t)}),this._labelsBackground[e].addEventListener('dblclick',(t)=>{t.stopPropagation(),this.labelDblClickListener(t)})),e++;return this.updateLabels(),this}isLabelEditable(e){return this.getProp('labelEditable',e||0)}updateLabels(){this._labels=this._labels||[];for(var e=0,t=this._labels.length;e<t;e++)this._applyLabelData(e)}_applyLabelData(e){e=e||0;var t=this.getProp('labelVisible',e);if(!1===t)return this._labels[e].setAttribute('display','none'),void this._labelsBackground[e].setAttribute('display','none');this._labels[e].setAttribute('display','initial'),this._labelsBackground[e].setAttribute('display','initial');var r=this.calculatePosition(Position.check(this.getProp('labelPosition',e)));if(!(isNaN(r.x)||isNaN(r.y)||!1===r.y||!1===r.x)){'NaNpx'==r.x||isNaN(r.x)||'NaN'===r.x||!1===r.x||(this._labels[e].setAttribute('x',r.x),this._labels[e].setAttribute('y',r.y));var a=this.getProp('labelAngle',e)||0;if(0!=a){var s=this._labels[e].getAttribute('x'),n=this._labels[e].getAttribute('y');this._labels[e].setAttribute('transform','rotate('+a+' '+s+' '+n+')')}let t=this.getProp('labelHTMLData',e)||{};for(var o in t)this._labels[e].setAttribute(o,t[o]),this._labelsBackground[e].setAttribute(o,t[o]);this._labels[e].setAttribute('dominant-baseline',this.getProp('labelBaseline',e)||'no-change'),this._labels[e].textContent=this.getProp('labelText',e),this._labels[e].setAttribute('fill',this.getProp('labelColor',e)||'black'),this._labels[e].setAttribute('font-size',this.getProp('labelSize',e)+'px'||'12px'),this._labels[e].setAttribute('text-anchor',this._getLabelAnchor(e)),this._labels[e].setAttribute('stroke',this.getProp('labelStrokeColor',e)||'black'),this._labels[e].setAttribute('stroke-width',this.getProp('labelStrokeWidth',e)||'0px'),this._labels[e].setAttribute('stroke-location','outside');let i=this._labels[e].getBBox();return this._labelsBackground[e].setAttribute('x',i.x),this._labelsBackground[e].setAttribute('y',i.y),this._labelsBackground[e].setAttribute('width',i.width),this._labelsBackground[e].setAttribute('height',i.height),this._labelsBackground[e].setAttribute('fill',this.getProp('labelBackgroundColor')||'transparent'),this._labelsBackground[e].setAttribute('fill-opacity',this.getProp('labelBackgroundOpacity')||1),this}}emptyLabels(){for(var e=0,t=this._labels.length;e<t;e++)this._labels[e].textContent='';return this}_getLabelAnchor(e){var t=this.getProp('labelAnchor',e);switch(t){case'middle':case'start':case'end':return t;break;case'right':return'end';break;case'left':return'start';break;default:return'start';}}isSelected(){return this._selectStatus||!1}hasHandles(e){return void 0!==e&&this.setProp('handles',e),!!this.getProp('handles')||!!this.getProp('staticHandles')}addHandles(){if(!this.isLocked()){if(!this.handlesInDom){this.handlesInDom=!0;for(var e=1;e<this.handles.length;e++)this.handles[e]&&this.group.appendChild(this.handles[e])}return this}}removeHandles(){this.hideHandles(),this.handles=[]}hideHandles(){if(!this.handlesInDom)return this;for(var e=1;e<this.handles.length;e++)this.group.removeChild(this.handles[e]);return this.handlesInDom=!1,this}areHandlesInDom(){return this.handlesInDom}_select(e){return!!this.isSelectable()&&void(this.appendToDom(),this._selectStatus=!0,this.applySelectedStyle(),this.hasHandles()&&!this.hasStaticHandles()&&(this.addHandles(),this.setHandles()),!e&&this.graph.emit('shapeSelected',this))}applySelectedStyle(){if(this._selectStatus){var e=this.getSelectStyle(),t={};for(var r in e)t[r]='function'==typeof e[r]?e[r].call(this):e[r];saveDomAttributes(this._dom,t,'select')}}_unselect(e){this._selectStatus=!1,restoreDomAttributes(this._dom,'select'),this.hasHandles()&&!this.hasStaticHandles()&&this.hideHandles(),e||this.graph.emit('shapeUnselected',this)}getSelectStyle(){return this.selectStyle}setSelectStyle(e){return this.selectStyle=e,this.applySelectedStyle(),this}setStaticHandles(e){this.setProp('staticHandles',e)}hasStaticHandles(){return!!this.getProp('staticHandles')}_createHandles(e,t,r,a){if(!(this.handles&&0<this.handles.length)){for(var s=1;s<=e;s++)((i)=>{var s=this,e=document.createElementNS(s.graph.ns,t);if(e.jsGraphIsShape=!0,r)for(var n in r)e.setAttribute(n,r[n]);e.addEventListener('mousedown',(t)=>{s.isResizable()&&(t.preventDefault(),t.stopPropagation(),s.graph.emit('beforeShapeResize',s),this.emit('beforeShapeResize'),!s.graph.prevent(!1)&&(s.resizing=!0,s.handleSelected=i,s.handleMouseDown(t)))}),a&&a(s.handles[i]),s.handles[i]=e}).call(this,s);return this.handles}}createHandles(){this.hasStaticHandles()&&(this.addHandles(),this.setHandles())}handleMouseDownImpl(){}handleMouseMoveImpl(){}handleMouseUpImpl(){}handleCreateImpl(){}handleMouseDown(t){if(!this.isLocked())return(this.isMovable()||this.isResizable())&&this.graph.elementMoving(this),this.getProp('selectOnMouseDown')&&this.graph.selectShape(this),this.isMovable()&&!this.resizing&&(this.graph.emit('beforeShapeMove',self),!this.graph.prevent(!1)&&(this.moving=!0,this.moved=!1)),this._mouseCoords=this.graph._getXY(t),this.handleMouseDownImpl(t,this._mouseCoords)}handleClick(t){return this.graph.emit('shapeClicked',this),this.emit('shapeClicked'),!!this.isSelectable()&&void(!t.shiftKey&&this.graph.unselectShapes(),this.getProp('selectOnClick')&&this.graph.selectShape(this))}handleMouseMove(t){if((this.resizing||this.moving)&&!this.isSelected()&&this.graph.selectShape(this),this.graph.emit('beforeShapeMouseMove',this),this.emit('beforeShapeMouseMove'),this.graph.prevent(!1)||!this._mouseCoords)return!1;this.moved=!0;var e=this.graph._getXY(t),i=this.getXAxis().getRelVal(e.x-this._mouseCoords.x),r=this.getYAxis().getRelVal(e.y-this._mouseCoords.y);(0!=i||0!==r)&&(this.preventUnselect=!0),this._mouseCoords=e;var a=this.handleMouseMoveImpl(t,i,r,e.x-this._mouseCoords.x,e.y-this._mouseCoords.y);return a}handleMouseUp(t){return this.moving&&this.moved&&(this.graph.emit('shapeMoved',this),this.emit('shapeMoved')),(this.handleSelected||this.resize)&&(this.graph.emit('shapeResized',this),this.emit('shapeResized')),this.moving=!1,this.resizing=!1,this.handleSelected=!1,this.graph.elementMoving(!1),this.handleMouseUpImpl(t)}handleDblClick(){}handleMouseOver(){!this.getProp('highlightOnMouseOver')||this.moving||this.resizing||this.highlight(),this.graph.emit('shapeMouseOver',this)}handleMouseOut(){this.getProp('highlightOnMouseOver')&&this.unHighlight(),this.graph.emit('shapeMouseOut',this)}lock(){return this.setProp('locked',!0),this}unlock(){return this.setProp('locked',!1),this}isLocked(){return this.getProp('locked')||this.graph.shapesLocked}movable(){this.setProp('movable',!0)}unmovable(){return this.setProp('movable',!1),!1}isMovable(){return this.getProp('movable')}resizable(){this.setProp('resizable',!0)}unresizable(){this.setProp('resizable',!1)}isResizable(){return this.getProp('resizable')}selectable(){this.setProp('selectable',!0)}unselectable(){this.graph.unselectShape(this),this.setProp('selectable',!1)}isSelectable(){return this.getProp('selectable')}highlight(e,t){return e||(e=this.getHighlightAttributes()),t||(t='highlight'),saveDomAttributes(this._dom,e,t),this.highlightImpl(),this}unHighlight(e){return e||(e='highlight'),restoreDomAttributes(this._dom,e),this.unHighlightImpl(),this}highlightImpl(){}unHighlightImpl(){}getHighlightAttributes(){return this._highlightAttributes}setHighlightAttributes(e){return this._highlightAttributes=e,this}getMaskingID(){return this.maskingId}maskWith(e){const t=e.getMaskingID();t?this._dom.setAttribute('mask','url(#'+t+')'):this._dom.removeAttribute('mask')}updateMask(){var e=Math.min,t=Math.abs}labelDblClickListener(t){var e=parseInt(t.target.getAttribute('data-label-i')),i=this;if(isNaN(e))return;if(!this.isLabelEditable(e))return;t.preventDefault(),t.stopPropagation();var r=document.createElement('input');r.setAttribute('type','text'),r.setAttribute('value',i.getProp('labelText',e)),i.graph.wrapper.prepend(r),r.select(),setCSS(r,{position:'absolute',marginTop:parseInt(t.target.getAttribute('y').replace('px',''))+this.graph.getPaddingTop()-10+'px',marginLeft:parseInt(t.target.getAttribute('x').replace('px',''))+this.graph.getPaddingLeft()-50+'px',textAlign:'center',width:'100px'});const a=i.getLabelText(e),s=function(){i.setLabelText(r.value,e),i._labels[e].textContent=r.value;const t=r.value;r.remove(),r.removeEventListener('blur',s),r=!1,i.changed('shapeLabelChanged',{previousValue:a,nextValue:t})};r.addEventListener('blur',s),r.addEventListener('keyup',function(t){13===t.keyCode&&s()}),r.addEventListener('keypress',function(t){t.stopPropagation()}),r.addEventListener('keydown',function(t){t.stopPropagation()}),r.focus()}appendToDom(){return this._forcedParentDom?this._forcedParentDom.appendChild(this.group):this.graph.appendShapeToDom(this),this}forceParentDom(e){return this._forcedParentDom=e,this}isHTML(){return!1}}Shape.prototype.computePosition=Shape.prototype.calculatePosition,Shape.prototype.showLabel=Shape.prototype.displayLabel,Shape.prototype.remove=Shape.prototype.kill;class ShapeSurfaceUnderCurve extends Shape{createDom(){this._dom=document.createElementNS(this.graph.ns,'path')}createHandles(){this._createHandles(2,'line',{"stroke-width":'3',stroke:'transparent',"pointer-events":'stroke',cursor:'ew-resize'})}handleMouseMoveImpl(t,e){if(!this.isLocked()){if(this.moving)this.getPosition(0).deltaPosition('x',e,this.getXAxis()),this.getPosition(1).deltaPosition('x',e,this.getXAxis());else if(this.serie&&this.handleSelected){this.resizingPosition=1==this.handleSelected?this.getPosition(0):this.getPosition(1);var i=this.serie.searchClosestValue(this.getXAxis().getVal(this.graph._getXY(t).x-this.graph.getPaddingLeft()));if(!i)return;this.resizingPosition.x!=i.xMin&&(this.preventUnselect=!0),this.resizingPosition.x=i.xMin}else this.handleSelected&&(this.resizingPosition=1==this.handleSelected?this.getPosition(0):this.getPosition(1),this.resizingPosition.deltaPosition('x',e,this.getXAxis()));this.applyPosition()}}applyPosition(){var e=Math.min;if(this.serie){var t=this.computePosition(0),r=this.computePosition(1),a=Math.abs(t.x-r.x),s=e(t.x,r.x);if(2>a||0>s+a||s>this.graph.getDrawingWidth())return this.setDom('d',''),!1;var n=this.serie.searchClosestValue(this.getPosition(0).x),o=this.serie.searchClosestValue(this.getPosition(1).x),l=0,p=Number.MAX_VALUE,d,g,i,c,u,h,s,x;if(!n||!o)return!1;for(n.xBeforeIndex>o.xBeforeIndex&&(d=n,n=o,o=d),this.counter=0,g=n.dataIndex;g<=o.dataIndex;g++){for(this.currentLine='',c=g==n.dataIndex?n.xBeforeIndexArr:0,u=g==o.dataIndex?o.xBeforeIndexArr:this.serie.data[g].length,h=0,c==u&&u++,i=c;i<=u;i+=2)s=this.serie.getX(this.serie.data[g][i+0]),x=this.serie.getY(this.serie.data[g][i+1]),l=Math.max(this.serie.data[g][i+1],l),p=e(this.serie.data[g][i+1],p),i==c&&(this.firstX=s,this.firstY=x),this.currentLine+=0<h?' L '+s+' '+x+' ':' M '+s+' '+x+' ',h++;if(this.lastX=s,this.lastY=x,!this.firstX||!this.firstY||!this.lastX||!this.lastY)return;this.currentLine+=' V '+this.getYAxis().getPx(0)+' H '+this.firstX+' z',this.setDom('d',this.currentLine)}return this.maxY=this.serie.getY(l),this.setHandles(),this.changed(),!0}}setHandles(){if(this.firstX){var e=this.computePosition(0),t=this.computePosition(1);e.x<t.x?(this.handles[1].setAttribute('x1',this.firstX),this.handles[1].setAttribute('x2',this.firstX),this.handles[2].setAttribute('x1',this.lastX),this.handles[2].setAttribute('x2',this.lastX)):(this.handles[1].setAttribute('x1',this.lastX),this.handles[1].setAttribute('x2',this.lastX),this.handles[2].setAttribute('x1',this.firstX),this.handles[2].setAttribute('x2',this.firstX)),this.handles[1].setAttribute('y1',this.getYAxis().getMaxPx()),this.handles[1].setAttribute('y2',this.serie.getY(0)),this.handles[2].setAttribute('y1',this.getYAxis().getMaxPx()),this.handles[2].setAttribute('y2',this.serie.getY(0))}}}class ShapeLine extends Shape{constructor(e,t){super(e,t)}createDom(){this._dom=document.createElementNS(this.graph.ns,'line'),this.getStrokeColor()||this.setStrokeColor('black'),this.getStrokeWidth()||this.setStrokeWidth(1)}createHandles(){this._createHandles(2,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white',cursor:'nwse-resize'})}applyPosition(){var e=this.calculatePosition(0),t=this.calculatePosition(1);if(e&&e.x&&e.y)return this.setDom('x2',e.x),this.setDom('y2',e.y),this.setDom('y1',t.y),this.setDom('x1',t.x),this.currentPos2x=t.x,this.currentPos2y=t.y,this.currentPos1x=e.x,this.currentPos1y=e.y,!0}handleMouseMoveImpl(t,e,i){if(!this.isLocked()){var r=this.getPosition(0),a=this.getPosition(1),s;if(1==this.handleSelected?s=r:2==this.handleSelected&&(s=a),s&&(!this._data.vertical&&s.deltaPosition('x',e,this.getXAxis()),!this._data.horizontal&&s.deltaPosition('y',i,this.getYAxis())),this.moving&&(console.log(this._data),r.x&&!this._data.noX&&r.deltaPosition('x',e,this.getXAxis()),r.y&&!this._data.noY&&r.deltaPosition('y',i,this.getYAxis()),a.x&&!this._data.noX&&a.deltaPosition('x',e,this.getXAxis()),a.y&&!this._data.noY&&a.deltaPosition('y',i,this.getYAxis())),this._data.forcedCoords){var n=this._data.forcedCoords;void 0!==n.y&&('function'==typeof n.y?a.y=r.y=n.y(this):(a.y=n.y,r.y=n.y)),void 0!==n.x&&('function'==typeof n.x?a.x=r.x=n.x(this):(a.x=n.x,r.x=n.x))}return this.rectEvent&&this.setEventReceptacle(),this.redraw(),this.changed(),this.setHandles(),!0}}setHandles(){!this.areHandlesInDom()||isNaN(this.currentPos1x)||(this.handles[1].setAttribute('x',this.currentPos1x),this.handles[1].setAttribute('y',this.currentPos1y),this.handles[2].setAttribute('x',this.currentPos2x),this.handles[2].setAttribute('y',this.currentPos2y))}setEventReceptacle(){this.currentPos1x&&(!this.rectEvent&&(this.rectEvent=document.createElementNS(this.graph.ns,'line'),this.rectEvent.setAttribute('pointer-events','stroke'),this.rectEvent.setAttribute('stroke','transparent'),this.rectEvent.jsGraphIsShape=this,this.group.appendChild(this.rectEvent)),this.rectEvent.setAttribute('x1',this.currentPos1x),this.rectEvent.setAttribute('y1',this.currentPos1y),this.rectEvent.setAttribute('x2',this.currentPos2x),this.rectEvent.setAttribute('y2',this.currentPos2y),this.rectEvent.setAttribute('stroke-width',this.getProp('strokeWidth')+2))}}class ShapeArrow extends ShapeLine{constructor(e){super(e)}createDom(){this._dom=document.createElementNS(this.graph.ns,'line'),this._dom.setAttribute('marker-end','url(#arrow'+this.graph._creation+')'),this.createHandles(this.nbHandles,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white',cursor:'nwse-resize'}),this.setStrokeColor('black'),this.setStrokeWidth(1)}}class ShapeEllipse extends Shape{constructor(e,t){super(e,t)}createDom(){this._dom=document.createElementNS(this.graph.ns,'ellipse')}applyPosition(){var e=Math.abs,t=this.computePosition(0);this.setDom('cx',t.x||0),this.setDom('cy',t.y||0);let i=this.graph.newPosition({dx:this.getProp('rx'),dy:this.getProp('ry')||this.getProp('rx')}),r=this.calculatePosition(i);return this.setDom('rx',e(r.x)||0),this.setDom('ry',e(r.y)||0),!0}setR(e,t){return this.setProp('rx',e),this.setProp('ry',t),this}handleMouseUpImpl(){this.triggerChange()}handleMouseMoveImpl(){}}class ShapeLabel extends Shape{constructor(e,t){super(e,t)}createDom(){return!1}applyPosition(){return!0}}class ShapePolyline extends Shape{constructor(e,t){super(e,t)}createDom(){this._dom=document.createElementNS(this.graph.ns,'path'),this.getStrokeColor()||this.setStrokeColor('black'),this.getStrokeWidth()==void 0&&this.setStrokeWidth(1)}createHandles(){}setPointsPx(e){return this.setProp('pxPoints',e),this}applyPosition(){let e=this.computePosition(0),t;if(t=this.getProp('pxPoints'))t=' M '+e.x+' '+e.y+' '+t,this.setDom('d',t);else if(this.points){var i,r;this.serie?(i=this.serie.getXAxis(),r=this.serie.getYAxis()):this.xAxis&&this.yAxis&&(i=this.xAxis,r=this.yAxis),this.setDom('d','M '+this.points.map(function(e){return i.getPx(e[0])+', '+r.getPx(e[1])}).join(' L '))}return this.changed(),!0}}class ShapeNMRIntegral extends Shape{constructor(e,t){super(e,t),this.nbHandles=2}createDom(){this._dom=document.createElementNS(this.graph.ns,'path'),this._domShadow=document.createElementNS(this.graph.ns,'path'),this._domShadow.jsGraphIsShape=this,this._dom.setAttribute('pointer-events','stroke'),this._domShadow.setAttribute('pointer-events','stroke'),this._domShadow.setAttribute('stroke-width','12'),this._domShadow.setAttribute('fill','transparent'),this._domShadow.setAttribute('stroke','transparent'),this.group.appendChild(this._domShadow)}initImpl(){this.setFillColor('transparent'),this.setStrokeColor('black')}createHandles(){this._createHandles(2,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white'}),this.handles[1].setAttribute('fill','red')}xor(e,t){return e&&!t||!e&&t}applyPosition(){let e=this.getAxis(),t=[],r='',a=this.getProp('baseLine',0)||300,s,n,o,p,d;if(!this.serie)throw'No serie exists for this shape';let g=this.getPosition(0),c=this.getPosition(1);if(g.x<this.serie.getXAxis().getCurrentMin()&&c.x<this.serie.getXAxis().getCurrentMin()||g.x>this.serie.getXAxis().getCurrentMax()&&c.x>this.serie.getXAxis().getCurrentMax())return this.setDom('d',''),this._domShadow.setAttribute('d',''),this.hideLabel(0),!1;this.showLabel(0);let u=0,h=this.serie.getWaveform(),x;if(!h)return;let m=h.getIndexFromX(g[e],!0,Math.floor),y=h.getIndexFromX(c[e],!0,Math.ceil),b=!1,A;m==y&&('aggregate'==h.getReductionType()?y+=4:y++),y<m&&(A=m,m=y,y=A,b=!0);let f=h.getDataInUse(),S,k,M,C,v,_,L,P,w;for('aggregate'==h.getReductionType(),(!h.getXMonotoneousAscending()||0)&&(h.getXMonotoneousAscending()||1)?(x=m,P=!1,w=1):(x=y,P=!0,w=-1);P?x>=m:x<=y;x+=w){if(o=h.getX(x,!0),p=h.getY(x,!0),s=this.serie.getX(o),n=this.serie.getY(p),u+=h.getY(x,!0),S||(S=s,k=n,M=h.getX(x),C=h.getY(x)),void 0==v){v=s,_=h.getX(x),L=h.getY(x);continue}v=s,t.push([s,n,u]),_=o}_=!1,L=!1,v=!1,0==u&&(u=1),this._sumVal=h.integrate(g.x,c.x),d=this.ratio?this.ratio*(this.sumVal/u):200/u;let E;if(0!=t.length){for(var X=0,i=t.length;X<i;X++){if(E=a-t[X][2]*d,0<X&&(t[X-1][2]>u/2&&t[X][2]<=u/2||t[X-1][2]<u/2&&t[X][2]>=u/2)){let e=a-(t[X-1][2]+t[X][2])/2*d;this.setPosition({x:t[X][0]+'px',y:e+'px'},3),this.setLabelPosition(this.getPosition(3),0)}r+=' L '+t[X][0]+', '+E+' ',this.lastPointX=t[X][0],this.lastPointY=E}return this.points=t,this._sum=u,r=this.serie.isFlipped()?' M '+a+', '+S+' '+r:' M '+S+', '+a+' '+r,this.firstPointX=S,this.firstPointY=a,this.setDom('d',r),this._domShadow.setAttribute('d',r),this.firstX=S,this.firstY=k,this.serie.ratioLabel&&this.updateIntegralValue(this.serie.ratioLabel)||this.updateLabels(),this.changed(),this.handleCondition=!this.xor(-1==w,b),this.setHandles(),this.updateIntegralValue(),!0}}updateIntegralValue(e=this.serie.ratioLabel,t){return console.log(e),e&&(this.serie.ratioLabel=e),isNaN(t)||isNaN(this.sumVal)||!this.sumVal||(this.serie.ratioLabel=t/this.sumVal),this.setLabelText(e?(Math.round(100*this.sumVal*e)/100).toPrecision(3):'N/A',0),this.updateLabels(),this.serie.ratioLabel}getAxis(){return this._data.axis||'x'}set ratio(e){this._ratio=e}get ratio(){return this._ratio}get sum(){return this._sum}get sumVal(){return this._sumVal}selectStyle(){this.setDom('stroke-width','2px')}selectHandles(){}setHandles(){void 0!=this.points&&this.isSelected()&&(this.addHandles(),this.handleCondition?(this.handles[1].setAttribute('x',this.firstPointX),this.handles[1].setAttribute('y',this.firstPointY),this.handles[2].setAttribute('x',this.lastPointX),this.handles[2].setAttribute('y',this.lastPointY)):(this.handles[2].setAttribute('x',this.firstPointX),this.handles[2].setAttribute('y',this.firstPointY),this.handles[1].setAttribute('x',this.lastPointX),this.handles[1].setAttribute('y',this.lastPointY)))}handleMouseMoveImpl(t,e){if(!this.isLocked()){var i=this.getPosition(0),r=this.getPosition(1),a;return 1==this.handleSelected?a=i:2==this.handleSelected&&(a=r),a&&!this._data.vertical&&a.deltaPosition('x',e,this.getXAxis()),this.moving&&(i.x&&i.deltaPosition('x',e,this.getXAxis()),r.x&&r.deltaPosition('x',e,this.getXAxis())),this.rectEvent&&this.setEventReceptacle(),this.redraw(),this.changed(),!0}}}class ShapeRectangle extends Shape{constructor(e,t){super(e,t)}createDom(){return this._dom=document.createElementNS(this.graph.ns,'rect'),this.getStrokeColor()||this.setStrokeColor('black'),this.getStrokeWidth()||this.setStrokeWidth(1),this.getFillColor()||this.setFillColor('transparent'),this}createHandles(){if(this.hasHandles()){var e=this.getProp('handles');switch('object'!=typeof e&&(e={}),e.type||(e.type='corners'),e.type){case'sides':extend(e,{sides:{top:!0,bottom:!0,left:!0,right:!0}});var t=0;for(var r in e.sides)e.sides[r]&&t++;this._createHandles(t,'g').map(function(e){var t=document.createElementNS(self.graph.ns,'rect');t.setAttribute('x','-3'),t.setAttribute('width','6'),t.setAttribute('y','-6'),t.setAttribute('height','12'),t.setAttribute('stroke','black'),t.setAttribute('fill','white'),t.setAttribute('cursor','pointer'),e.appendChild(t)});var t=1;for(var r in e.sides)e.sides[r]&&(this.handles[r]=this['handle'+t],this.sides[t]=r,t++);break;case'corners':this._createHandles(4,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white'}),this.handles&&(this.handles[2].setAttribute('cursor','nesw-resize'),this.handles[4].setAttribute('cursor','nesw-resize'),this.handles[1].setAttribute('cursor','nwse-resize'),this.handles[3].setAttribute('cursor','nwse-resize'));break;case'seamlessX':this._createHandles(2,'rect',{transform:'translate(-3 -3)',stroke:'transparent',fill:'transparent',width:'20px',cursor:'ew-resize'});}return super.createHandles(),this}}applyPosition(){var e=this.computePosition(0),t=this.computePosition(1),i,r,a,s;return e.x<t.x?(i=e.x,a=t.x-e.x):(i=t.x,a=e.x-t.x),e.y<t.y?(r=e.y,s=t.y-e.y):(r=t.y,s=e.y-t.y),this.currentX=i,this.currentY=r,this.currentW=a,this.currentH=s,isNaN(i)||isNaN(r)||!1===i||!1===r?!1:(this.setDom('width',a),this.setDom('height',s),this.setDom('x',i),this.setDom('y',r),this.setHandles(),this.updateMask(),!0)}handleMouseMoveImpl(t,e,i){var r=this.getProp('handles');if(this.moving||this.handleSelected){var a=this.getPosition(0),s=this.getPosition(1),n=this.getXAxis().isFlipped(),o=this.getYAxis().isFlipped(),l=a.x,p=a.y,d=s.x,g=s.y;if(this.moving)a.deltaPosition('x',e,this.getXAxis()),a.deltaPosition('y',i,this.getYAxis()),s.deltaPosition('x',e,this.getXAxis()),s.deltaPosition('y',i,this.getYAxis());else switch(r.type){case'seamlessX':switch(this.handleSelected){case 1:a.deltaPosition('x',e,this.getXAxis());break;case 2:s.deltaPosition('x',e,this.getXAxis());}break;case'sides':switch(this.sides[this.handleSelected]){case'left':a.deltaPosition('x',e,this.getXAxis());break;case'right':s.deltaPosition('x',e,this.getXAxis());break;case'top':a.deltaPosition('y',i,this.getYAxis());break;case'bottom':s.deltaPosition('y',i,this.getYAxis());}break;case'corners':default:1==this.handleSelected?(a.deltaPosition('x',e,this.getXAxis()),a.deltaPosition('y',i,this.getYAxis())):2==this.handleSelected?(s.deltaPosition('x',e,this.getXAxis()),a.deltaPosition('y',i,this.getYAxis())):3==this.handleSelected?(s.deltaPosition('y',i,this.getYAxis()),s.deltaPosition('x',e,this.getXAxis())):4==this.handleSelected&&(a.deltaPosition('x',e,this.getXAxis()),s.deltaPosition('y',i,this.getYAxis()));}return this.redraw(),this.changed(),this.setHandles(),!0}}setHandles(){var e=Math.min,t=Math.abs;if(!this.isLocked()&&(this.isSelectable()||this._staticHandles)&&this.handlesInDom){var i=this.computePosition(0),r=this.computePosition(1),a=this.getProp('handles');switch(a.type){case'seamlessX':this.handles[1]&&(this.handles[1].setAttribute('transform','translate(-10) translate('+i.x+')'),this.handles[1].setAttribute('height',t(r.y-i.y)),this.handles[1].setAttribute('y',e(r.y,i.y))),this.handles[2]&&(this.handles[2].setAttribute('transform','translate(-10)  translate('+r.x+')'),this.handles[2].setAttribute('height',t(r.y-i.y)),this.handles[2].setAttribute('y',e(r.y,i.y)));break;case'sides':this.handles.left&&this.handles.left.setAttribute('transform','translate('+this.currentX+' '+(this.currentY+this.currentH/2)+')'),this.handles.right&&this.handles.right.setAttribute('transform','translate( '+(this.currentX+this.currentW)+' '+(this.currentY+this.currentH/2)+')'),this.handles.top&&this.handles.top.setAttribute('transform','translate( '+(this.currentX+this.currentW/2)+' '+this.currentY+')'),this.handles.bottom&&this.handles.bottom.setAttribute('transform','translate( '+(this.currentX+this.currentW/2)+' '+(this.currentY+this.currentH)+')');break;case'corners':default:this.handles[1].setAttribute('x',i.x),this.handles[1].setAttribute('y',i.y),this.handles[2].setAttribute('x',r.x),this.handles[2].setAttribute('y',i.y),this.handles[3].setAttribute('x',r.x),this.handles[3].setAttribute('y',r.y),this.handles[4].setAttribute('x',i.x),this.handles[4].setAttribute('y',r.y);}}}}class ShapePeakIntegration2D extends ShapeRectangle{constructor(e,t){super(e,t),this.nbHandles=4}createDom(){this._dom=document.createElementNS(this.graph.ns,'rect'),this._dom.element=this,this.createHandles(this.nbHandles,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white',cursor:'nwse-resize'})}redrawImpl(){this.setPosition(),this.setHandles(),this.setBindableToDom(this._dom)}}class ShapeCross extends Shape{constructor(e,t){super(e,t),this.nbHandles=1}get width(){return this.options.width||10}set width(e){this.options.width=e}createDom(){this._dom=document.createElementNS(this.graph.ns,'path'),this._dom.setAttribute('d','M -'+this.width/2+' 0 h '+this.width+' m -'+this.width/2+' -'+this.width/2+' v '+this.width+'')}createHandles(){this._createHandles(this.nbHandles,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white',cursor:'nwse-resize'})}applyPosition(){var e=this.calculatePosition(0);if(e&&e.x&&e.y)return this.setDom('transform','translate( '+e.x+', '+e.y+')'),this.currentPos1x=e.x,this.currentPos1y=e.y,!0}redrawImpl(){this.setHandles()}handleCreateImpl(){}handleMouseDownImpl(){return this.moving=!0,!0}handleMouseUpImpl(){return this.triggerChange(),!0}handleMouseMoveImpl(t,e,i){if(!this.isLocked()){var r=this.getFromData('pos');return this.moving&&(r.x=this.graph.deltaPosition(r.x,e,this.getXAxis()),r.y=this.graph.deltaPosition(r.y,i,this.getYAxis())),this.redrawImpl(),!0}}setHandles(){!this.areHandlesInDom()||isNaN(this.currentPos1x)||(this.handles[1].setAttribute('x',this.currentPos1x),this.handles[1].setAttribute('y',this.currentPos1y))}selectStyle(){this.setDom('stroke','red'),this.setDom('stroke-width','2')}}class ShapePeakBoundaries extends ShapeLine{constructor(e){super(e),this.lineHeight=6}createDom(){this._dom=document.createElementNS(this.graph.ns,'line'),this.line1=document.createElementNS(this.graph.ns,'line'),this.line2=document.createElementNS(this.graph.ns,'line'),this.line3=document.createElementNS(this.graph.ns,'line'),this.rectBoundary=document.createElementNS(this.graph.ns,'path'),this.rectBoundary.setAttribute('fill','transparent'),this.rectBoundary.setAttribute('stroke','none'),this.rectBoundary.setAttribute('pointer-events','fill'),this.rectBoundary.jsGraphIsShape=!0,this.group.appendChild(this.rectBoundary),this.group.appendChild(this.line1),this.group.appendChild(this.line2),this.group.appendChild(this.line3),this._dom.element=this}createHandles(){this._createHandles(3,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white',cursor:'nwse-resize'})}redrawImpl(){this.line1.setAttribute('stroke',this.getStrokeColor()),this.line2.setAttribute('stroke',this.getStrokeColor()),this.line3.setAttribute('stroke',this.getStrokeColor()),this.line1.setAttribute('stroke-width',this.getStrokeWidth()),this.line2.setAttribute('stroke-width',this.getStrokeWidth()),this.line3.setAttribute('stroke-width',this.getStrokeWidth()),this.setHandles(),this.redrawLines()}redrawLines(){var e=this.computePosition(0),t=this.computePosition(1),i=this.computePosition(2);if(e.x&&t.x&&i.x&&this.posYPx){var r=this.lineHeight;this.rectBoundary.setAttribute('d','M '+e.x+' '+(this.posYPx-r)+' v '+2*r+' H '+t.x+' v '+-2*r+'z'),this.line1.setAttribute('x1',e.x),this.line1.setAttribute('x2',e.x),this.line2.setAttribute('x1',t.x),this.line2.setAttribute('x2',t.x),this.line3.setAttribute('x1',i.x),this.line3.setAttribute('x2',i.x),this._dom.setAttribute('x1',e.x),this._dom.setAttribute('x2',t.x),this.redrawY(r)}return this}redrawY(){if(!this.posYPx)return this;var e=this.lineHeight;return this.line1.setAttribute('y1',this.posYPx-e),this.line1.setAttribute('y2',this.posYPx+e),this.line2.setAttribute('y1',this.posYPx-e),this.line2.setAttribute('y2',this.posYPx+e),this.line3.setAttribute('y1',this.posYPx-e),this.line3.setAttribute('y2',this.posYPx+e),this._dom.setAttribute('y1',this.posYPx),this._dom.setAttribute('y2',this.posYPx),this}setHandles(){if(this.posYPx){var e=this.computePosition(0),t=this.computePosition(1),i=this.computePosition(2);e.x&&t.x&&i.x&&(this.handles[1].setAttribute('x',e.x),this.handles[1].setAttribute('y',this.posYPx),this.handles[2].setAttribute('x',t.x),this.handles[2].setAttribute('y',this.posYPx),this.handles[3].setAttribute('x',i.x),this.handles[3].setAttribute('y',this.posYPx))}}setY(e){return this.posYPx=e,this}setLineHeight(e){this.lineHeihgt=e}handleMouseMoveImpl(t,e){var i=Math.abs;if(!this.isLocked()){var r=this.getPosition(0),a=this.getPosition(1),s=this.getPosition(2);switch(this.handleSelected){case 1:r.deltaPosition('x',e,this.getXAxis()),(i(s.x-a.x)>i(a.x-r.x)||i(s.x-r.x)>i(a.x-r.x))&&(s.x=r.x+0.1*(a.x-r.x));break;case 2:a.deltaPosition('x',e,this.getXAxis()),(i(s.x-a.x)>i(a.x-r.x)||i(s.x-r.x)>i(a.x-r.x))&&(s.x=a.x+0.1*(r.x-a.x));break;case 3:if(s.deltaPosition('x',e,this.getXAxis()),i(s.x-a.x)>i(a.x-r.x)||i(s.x-r.x)>i(a.x-r.x))return;}this.setLabelPosition({y:this.getLabelPosition(0).y,x:s.x}),this.updateLabels(),this.redrawLines(),this.setHandles()}}applyPosition(){return this.redrawLines(),!0}}class ShapeHTML extends Shape{constructor(e,t){super(e,t)}createDom(){this._dom=document.createElement('div'),this._dom.setAttribute('style','position: absolute');let e=document.createElement('div');this._dom.appendChild(e),this.div=e}createHandles(){}setHeight(e){this.setProp('height',e)}setWidth(e){this.setProp('width',e)}setContent(e){this.setProp('content',e)}setRenderer(e){this._renderer=e}redraw(){this._renderer?this._renderer(this.div):this.div.innerHTML=this.getProp('content'),super.redraw(...arguments)}applyPosition(){var e=this.calculatePosition(0);if(e&&isNumeric$1(e.x)&&isNumeric$1(e.y))return this._dom.style.left=e.x+'px',this._dom.style.top=e.y+'px',this.currentPosX=e.x,this.currentPosY=e.y,!0}handleMouseMoveImpl(){return!0}setHandles(){}isHTML(){return!0}}class Plugin extends EventEmitter{static default(){return{}}constructor(e){super(...arguments),this.options=Object.assign({},Plugin.default(),this.constructor.default(),e)}init(e){this.graph=e}onMouseDown(){}onMouseUp(){}onMouseMove(){}}class PluginDrag extends Plugin{static default(){return{dragX:!0,dragY:!0,persistanceX:!1,persistanceY:!1}}init(e){this.graph=e,this.time=null,this.totaltime=2e3}onMouseDown(e,t,i){return this._draggingX=t,this._draggingY=i,this._lastDraggingX=this._draggingX,this._lastDraggingY=this._draggingY,this.stopAnimation=!0,this.moved=!1,!0}onMouseMove(e,t,i){var r=t-this._draggingX,a=i-this._draggingY;this.options.dragX&&e._applyToAxes(function(e){e.setCurrentMin(e.getVal(e.getMinPx()-r)),e.setCurrentMax(e.getVal(e.getMaxPx()-r))},!1,!0,!1),this.options.dragY&&e._applyToAxes(function(e){e.setCurrentMin(e.getVal(e.getMinPx()-a)),e.setCurrentMax(e.getVal(e.getMaxPx()-a))},!1,!1,!0),this._lastDraggingX=this._draggingX,this._lastDraggingY=this._draggingY,this._draggingX=t,this._draggingY=i,this.moved=!0,this.time=Date.now(),this.emit('dragging'),e.draw(!0)}onMouseUp(e,t,i){var r=Date.now()-this.time;return t==this._lastDraggingX||i==this._lastDraggingY?void(this.moved&&this.emit('dragged')):(this.speedX=(t-this._lastDraggingX)/r,this.speedY=(i-this._lastDraggingY)/r,isNaN(this.speedX)||isNaN(this.speedY)?void this.emit('dragged'):void(e._applyToAxes(function(e){e._pluginDragMin=e.getCurrentMin(),e._pluginDragMax=e.getCurrentMax()},!1,!0,!0),this.stopAnimation=!1,this.accelerationX=-this.speedX/this.totaltime,this.accelerationY=-this.speedY/this.totaltime,this.options.persistanceX||this.options.persistanceY?this._persistanceMove(e):this.emit('dragged')))}_persistanceMove(e){var t=this;return t.stopAnimation?void t.emit('dragged'):void window.requestAnimationFrame(function(){var i=Date.now()-t.time,r=(0.5*t.accelerationX*i+t.speedX)*i,a=(0.5*t.accelerationY*i+t.speedY)*i;t.options.persistanceX&&e._applyToAxes(function(e){e.setCurrentMin(-e.getRelVal(r)+e._pluginDragMin),e.setCurrentMax(-e.getRelVal(r)+e._pluginDragMax),e.cacheCurrentMin(),e.cacheCurrentMax(),e.cacheInterval()},!1,!0,!1),t.options.persistanceY&&e._applyToAxes(function(e){e.setCurrentMin(-e.getRelVal(a)+e._pluginDragMin),e.setCurrentMax(-e.getRelVal(a)+e._pluginDragMax),e.cacheCurrentMin(),e.cacheCurrentMax(),e.cacheInterval()},!1,!1,!0),e.draw(),i<t.totaltime?(t.emit('dragging'),t._persistanceMove(e)):t.emit('dragged')})}}class PluginShape extends Plugin{constructor(){super(...arguments)}static default(){return{}}init(e,t){super.init(e,t),this.shapeType=t.type}setShape(e){this.shapeInfo.shapeType=e}onMouseDown(t,i,r,a){if(this.shapeType||this.options.url){var e=this,s,n;this.count=this.count||0,i-=t.getPaddingLeft(),r-=t.getPaddingTop(),s=t.getXAxis().getVal(i),n=t.getYAxis().getVal(r);var o={position:[{x:s,y:n},{x:s,y:n}],onChange:function(e){t.triggerEvent('onAnnotationChange',e)},locked:!1,selectable:!0,resizable:!0,movable:!0};let p=this.options.properties;if(extend(!0,o,this.options),this.emit('beforeNewShape',a,o),!this.graph.prevent(!1)){var l=t.newShape(o.type,o,!1,p);this.emit('createdShape',a,l),l&&(e.currentShape=l,e.currentShapeEvent=a),t.once('mouseUp',()=>{console.log(this.currentShape),this.currentShape||e.emit('newShape',a,l)})}}}onMouseMove(t,i,r,a){if(this.currentShape){console.log('mv'),this.count++;var e=this.currentShape;this.currentShape=!1,t.selectedSerie&&!e.serie&&e.setSerie(t.selectedSerie),e.resizing=!0,e.options&&e.options.onCreate&&e.options.onCreate.call(e),e.draw(),t.selectShape(e),e.handleMouseDown(this.currentShapeEvent,!0),e.handleSelected=this.options.handleSelected||1,e.handleMouseMove(a,!0)}}onMouseUp(){this.currentShape&&(this.currentShape.kill(),this.currentShape=!1)}}class PluginSelectScatter extends Plugin{constructor(){super(...arguments)}static default(){return{}}init(e){this._path=document.createElementNS(e.ns,'path'),setAttributeTo(this._path,{display:'none',fill:'rgba(0,0,0,0.1)',stroke:'rgba(0,0,0,1)',"shape-rendering":'crispEdges',x:0,y:0,height:0,width:0,d:''}),this.graph=e,e.dom.appendChild(this._path)}setSerie(e){this.serie=e}onMouseDown(e,t,i){this.serie&&(this.path='M '+t+' '+i+' ',this.currentX=t,this.currentY=i,this.xs=[this.serie.getXAxis().getVal(t-e.getPaddingLeft())],this.ys=[this.serie.getYAxis().getVal(i-e.getPaddingTop())],this._path.setAttribute('d',''),this._path.setAttribute('display','block'))}onMouseMove(e,t,i){var r=Math.pow;25<r(t-this.currentX,2)+r(i-this.currentY,2)&&(this.path+=' L '+t+' '+i+' ',this.currentX=t,this.currentY=i,this.xs.push(this.serie.getXAxis().getVal(t-e.getPaddingLeft())),this.ys.push(this.serie.getYAxis().getVal(i-e.getPaddingTop())),this._path.setAttribute('d',this.path+' z'),this.findPoints())}findPoints(){for(var e=this.serie.waveform,t=[],r=0,a=0,i=e.getLength(),s;a<i;a+=1){r=0;for(var n=0,o=this.xs.length;n<o;n+=1)s=n==o-1?0:n+1,(this.ys[n]<e.getY(a)&&this.ys[s]>e.getY(a)||this.ys[n]>e.getY(a)&&this.ys[s]<e.getY(a))&&e.getX(a)>(e.getY(a)-this.ys[n])/(this.ys[s]-this.ys[n])*(this.xs[s]-this.xs[n])+this.xs[n]&&r++;1==r%2?(t.push(a),this.serie.selectPoint(a,!0,'selected')):this.serie.unselectPoint(a)}this.selected=t,this.emit('selectionProcess',t)}onMouseUp(){this._path.setAttribute('display','none'),this.emit('selectionEnd',this.selected)}}class PluginZoom extends Plugin{constructor(){super(...arguments)}static default(){return{axes:'all'}}init(e){this._zoomingGroup=document.createElementNS(e.ns,'g'),this._zoomingSquare=document.createElementNS(e.ns,'rect'),this._zoomingSquare.setAttribute('display','none'),setAttributeTo(this._zoomingSquare,{display:'none',fill:'rgba(171,12,12,0.2)',stroke:'rgba(171,12,12,1)',"shape-rendering":'crispEdges',x:0,y:0,height:0,width:0,"pointer-events":'none'}),this.graph=e,e.groupEvent.appendChild(this._zoomingGroup),this._zoomingGroup.appendChild(this._zoomingSquare)}onMouseDown(t,i,r,a,e){var s=this.options.zoomMode;if(s){switch(this._zoomingMode=s,void 0===i&&(this._backedUpZoomMode=this._zoomingMode,this._zoomingMode='y',i=0),void 0===r&&(this._backedUpZoomMode=this._zoomingMode,this._zoomingMode='x',r=0),this._zoomingXStart=i,this._zoomingYStart=r,this.x1=i-t.getPaddingLeft(),this.y1=r-t.getPaddingTop(),this._zoomingSquare.setAttribute('width',0),this._zoomingSquare.setAttribute('height',0),this._zoomingSquare.setAttribute('display','block'),this._zoomingMode){case'x':this._zoomingSquare.setAttribute('y',t.options.paddingTop),this._zoomingSquare.setAttribute('height',t.getDrawingHeight()-t.shift.bottom);break;case'y':this._zoomingSquare.setAttribute('x',t.options.paddingLeft),this._zoomingSquare.setAttribute('width',t.getDrawingWidth());break;case'forceY2':this.y2=t.getYAxis().getPx(this.options.forcedY)+t.options.paddingTop;}this.options.onZoomStart&&!e&&this.options.onZoomStart(t,i,r,a,e)}}onMouseMove(t,i,r,a,e){var s=Math.min,n=Math.abs;switch(this._zoomingMode){case'xy':this._zoomingSquare.setAttribute('x',s(this._zoomingXStart,i)),this._zoomingSquare.setAttribute('y',s(this._zoomingYStart,r)),this._zoomingSquare.setAttribute('width',n(this._zoomingXStart-i)),this._zoomingSquare.setAttribute('height',n(this._zoomingYStart-r));break;case'forceY2':this._zoomingSquare.setAttribute('y',s(this._zoomingYStart,this.y2)),this._zoomingSquare.setAttribute('height',n(this._zoomingYStart-this.y2)),this._zoomingSquare.setAttribute('x',s(this._zoomingXStart,i)),this._zoomingSquare.setAttribute('width',n(this._zoomingXStart-i));break;case'x':this._zoomingSquare.setAttribute('x',s(this._zoomingXStart,i)),this._zoomingSquare.setAttribute('width',n(this._zoomingXStart-i));break;case'y':this._zoomingSquare.setAttribute('y',s(this._zoomingYStart,r)),this._zoomingSquare.setAttribute('height',n(this._zoomingYStart-r));}this.options.onZoomMove&&!e&&this.options.onZoomMove(t,i,r,a,e)}onMouseUp(t,i,r,a,s){var n=Math.max,o=Math.min,l=this;this.removeZone();var p=i-t.options.paddingLeft,d=r-t.options.paddingTop;if((this.emit('beforeZoom',{graph:t,x:i,y:r,e:a,mute:s}),!t.prevent(!1))&&(0!=i-this._zoomingXStart||'y'==this._zoomingMode)&&(0!=r-this._zoomingYStart||'x'==this._zoomingMode))if(this.options.transition||this.options.smooth){let e=!1,t=!1;('x'==this._zoomingMode||'xy'==this._zoomingMode||'forceY2'==this._zoomingMode)&&(this.fullX=!1,this.toAxes(function(e){e._pluginZoomMin=e.getCurrentMin(),e._pluginZoomMax=e.getCurrentMax(),e._pluginZoomMinFinal=o(e.getVal(p),e.getVal(l.x1)),e._pluginZoomMaxFinal=n(e.getVal(p),e.getVal(l.x1))},!1,!0,!1),e=!0),('y'==this._zoomingMode||'xy'==this._zoomingMode)&&(this.fullY=!1,this.toAxes(function(e){e._pluginZoomMin=e.getCurrentMin(),e._pluginZoomMax=e.getCurrentMax(),e._pluginZoomMinFinal=o(e.getVal(d),e.getVal(l.y1)),e._pluginZoomMaxFinal=n(e.getVal(d),e.getVal(l.y1))},!1,!1,!0),t=!0),'forceY2'==this._zoomingMode&&(this.fullY=!1,this.toAxes(function(e){e._pluginZoomMin=e.getCurrentMin(),e._pluginZoomMax=e.getCurrentMax(),e._pluginZoomMinFinal=o(e.getVal(l.y2),e.getVal(l.y1)),e._pluginZoomMaxFinal=n(e.getVal(l.y2),e.getVal(l.y1))},!1,!1,!0),t=!0),this.transition(e,t,'zoomEnd')}else{switch(this._zoomingMode){case'x':this.fullX=!1,this.toAxes('_doZoom',[p,this.x1],!0,!1);break;case'y':this.fullY=!1,this.toAxes('_doZoom',[d,this.y1],!1,!0);break;case'xy':this.fullX=!1,this.fullY=!1,this.toAxes('_doZoom',[p,this.x1],!0,!1),this.toAxes('_doZoom',[d,this.y1],!1,!0);break;case'forceY2':this.fullX=!1,this.fullY=!1,this.toAxes('_doZoom',[p,this.x1],!0,!1),this.toAxes('_doZoom',[this.y1,this.y2],!1,!0);}t.draw(),this._backedUpZoomMode&&(this._zoomingMode=this._backedUpZoomMode),this.emit('zoomed'),t.pluginYieldActiveState()}}removeZone(){this._zoomingSquare.setAttribute('display','none')}onMouseWheel(t,i,e,r,a){a||(a={}),a.baseline||(a.baseline=0);let s=a.baseline;'mousePosition'==a.baseline&&(s=this.graph.getYAxis().getVal(r),console.log(s));var n='x'==a.direction,o='y'===a.direction;this.toAxes('handleMouseWheel',[t,i,s],n,o),this.graph.drawSeries()}onDblClick(t,i,r,a,s){var n=Math.max,o=Math.min,l=this.graph;if(this.emit('beforeDblClick',{graph:l,x:t,y:i,pref:a,e:r,mute:s}),!l.prevent(!1)){if(this.options.transition||this.options.smooth){var p=!1,d=!1;('xtotal'==a.mode||'total'==a.mode)&&(this.toAxes(function(e){e._pluginZoomMin=e.getCurrentMin(),e._pluginZoomMax=e.getCurrentMax(),e._pluginZoomMinFinal=e.getMinValue()-e.options.axisDataSpacing.min*e.getInterval(),e._pluginZoomMaxFinal=e.getMaxValue()+e.options.axisDataSpacing.max*e.getInterval()},!1,!0,!1),p=!0),('ytotal'==a.mode||'total'==a.mode)&&(this.toAxes(function(e){e._pluginZoomMin=e.getCurrentMin(),e._pluginZoomMax=e.getCurrentMax(),e._pluginZoomMinFinal=e.getMinValue()-e.options.axisDataSpacing.min*e.getInterval(),e._pluginZoomMaxFinal=e.getMaxValue()+e.options.axisDataSpacing.max*e.getInterval()},!1,!1,!0),d=!0);let e,t;return('gradualX'==a.mode||'gradualY'==a.mode||'gradual'==a.mode||'gradualXY'==a.mode)&&(e=!1,t=!1,('gradualX'==a.mode||'gradual'==a.mode||'gradualXY'==a.mode)&&(e=!0,p=!0),('gradualY'==a.mode||'gradual'==a.mode||'gradualXY'==a.mode)&&(t=!0,d=!0),this.toAxes(function(e){e._pluginZoomMin=e.getCurrentMin(),e._pluginZoomMax=e.getCurrentMax(),e._pluginZoomMinFinal=e.getCurrentMin()-(e.getCurrentMax()-e.getCurrentMin()),e._pluginZoomMaxFinal=e.getCurrentMax()+(e.getCurrentMax()-e.getCurrentMin())},!1,e,t)),void this.transition(p,d,'dblClick')}var g=this.graph.getXAxis(),c=this.graph.getYAxis();if('xtotal'==a.mode)this.toAxes('setMinMaxToFitSeries',null,!0,!1),this.fullX=!0,this.fullY=!1;else if('ytotal'==a.mode)this.toAxes('setMinMaxToFitSeries',null,!1,!0),this.fullX=!1,this.fullY=!0;else if('total'==a.mode)this.toAxes('setMinMaxToFitSeries',null,!0,!0),this.fullX=!0,this.fullY=!0;else{t-=this.graph.options.paddingLeft,i-=this.graph.options.paddingTop;var u=g.getCurrentMin(),h=g.getCurrentMax(),m=g.getVal(t),b=h-u,A=c.getCurrentMin(),f=c.getCurrentMax(),S=c.getVal(i),k=f-A;if('gradualXY'==a.mode||'gradualX'==a.mode){var M=(m-u)/(h-u);u=n(g.getMinValue()-g.getInterval()*g.options.axisDataSpacing.min,u-b*M),h=o(g.getMaxValue()+g.getInterval()*g.options.axisDataSpacing.max,h+b*(1-M)),g.setCurrentMin(u),g.setCurrentMax(h),g.options.onZoom&&g.options.onZoom(u,h),g.cacheCurrentMin(),g.cacheCurrentMax(),g.cacheInterval()}if('gradualXY'==a.mode||'gradualY'==a.mode){var M=(S-A)/(f-A);A=n(c.getMinValue()-c.getInterval()*c.options.axisDataSpacing.min,A-k*M),f=o(c.getMaxValue()+c.getInterval()*c.options.axisDataSpacing.max,f+k*(1-M)),c.setCurrentMin(A),c.setCurrentMax(f),c.options.onZoom&&c.options.onZoom(A,f),c.cacheCurrentMin(),c.cacheCurrentMax(),c.cacheInterval()}}l.pluginYieldActiveState(),this.graph.draw()}}transition(e,t,i){var r=this,a=500;r.gradualUnzoomStart||(r.gradualUnzoomStart=Date.now()),window.requestAnimationFrame(function(){var s=Date.now()-r.gradualUnzoomStart;s>a&&(s=a);var n=Math.sin(s/a*Math.PI/2);r.toAxes(function(e){e.setCurrentMin(e._pluginZoomMin+(e._pluginZoomMinFinal-e._pluginZoomMin)*n),e.setCurrentMax(e._pluginZoomMax+(e._pluginZoomMaxFinal-e._pluginZoomMax)*n),e.cacheCurrentMin(),e.cacheCurrentMax(),e.cacheInterval()},!1,e,t),r.graph.draw(),s<a?(r.transition(e,t,i),r.emit('zooming')):(r.emit('zoomed'),r.graph.pluginYieldActiveState(),i&&r.emit(i),r.gradualUnzoomStart=0)})}isFullX(){return this.fullX}isFullY(){return this.fullY}toAxes(e,t,i,r){var a=this.options.axes;switch(a&&('serieSelected'!=a||this.graph.getSelectedSerie())||(a='all'),a){case'all':this.graph._applyToAxes.apply(this.graph,arguments);break;case'serieSelected':var s=this.graph.getSelectedSerie();s&&(i&&('string'==typeof e?s.getXAxis()[e].apply(s.getXAxis(),t):e.apply(s.getXAxis(),t)),r&&('string'==typeof e?s.getYAxis()[e].apply(s.getYAxis(),t):e.apply(s.getYAxis(),t)));break;default:Array.isArray(a)||(a=[a]);for(let s of a)s.isX()&&i?'string'==typeof e?s[e].apply(s,t):e.apply(s,t):s.isY()&&r&&('string'==typeof e?s[e].apply(s,t):e.apply(s,t));}}}var memory={},memoryHead={};function getFromMemory(e,t){var i,r;if(memory[e]&&memory[e][t])return r=memoryHead[e],i=memory[e][t],i.prev=r,i.next=r.next,r.next.prev=i,r.next=i,memoryHead[e]=i,i.data}function get(e,t){var i;if((i=getFromMemory(e,t))!=void 0)return i}class PluginTimeSerieManager extends Plugin{constructor(){super(...arguments),this.series=[],this.plugins=[],this.currentSlots={},this.requestLevels=new Map,this.update=(e,t)=>{this.series.forEach(function(t){this.updateSerie(t,e)}),e||this.recalculateSeries(t)}}static default(){return{LRUName:'PluginTimeSerieManager',intervals:[1000,15000,60000,900000,3600000,8640000],maxParallelRequests:3,optimalPxPerPoint:2,nbPoints:1e3,url:''}}init(e){this.graph=e,get.create(this.options.LRUName,200),this.requestsRunning=0}setURL(e){return this.options.url=e,this}setAvailableIntervals(){this.options.intervals=arguments}newSerie(e,t,i,r,a){var n=this.graph.newSerie(e,t,i);return this.currentSlots[e]={min:0,max:0,interval:0},n.on('hide',function(){n._zoneSerie&&n._zoneSerie.hide()}),n.on('show',function(){n._zoneSerie&&n._zoneSerie.show()}),n.setInfo('timeSerieManagerDBElements',r),a||(n._zoneSerie=this.graph.newSerie(e+'_zone',{},Graph$1.SERIE_ZONE)),this.series.push(n),n}registerPlugin(e){var t;if(-1<(t=this.plugins.indexOf(e)))for(var r=1;r<arguments.length;r++)e.removeListener(arguments[r],this.update);for(var r=1;r<arguments.length;r++)e.on(arguments[r],this.update)}updateSerie(e,t){var r=this,a=e.getXAxis().getCurrentMin(),s=e.getXAxis().getCurrentMax(),n=this.getOptimalInterval(s-a),o=this.options.intervals.indexOf(n),l;this.cleanRegister(o);for(var p=o;p<=o+1;p++){l=this.options.intervals[p];var i=r.computeSlotID(a,l),d=r.computeSlotID(s,l);[[2,5,6],[1,2,4],[0,1,3]].forEach(function(a){for(var s=i-a[0]*(d-i),o=d+a[0]*(d-i),p=s;p<=o&&!(r.computeTimeMin(p,l)>Date.now());)r.register(e,p,l,l==n?a[1]:a[2],!0,t),p++})}this.processRequests()}cleanRegister(e){this.requestLevels&&this.requestLevels.forEach((t)=>{t.forEach((i,r)=>{i[4]<e&&t.splice(r,1)})})}register(e,t,i,r,a,s){var n=this.computeUniqueID(e,t,i),o=get.get(this.options.LRUName,n);(!o||this.computeTimeMax(t,i)>Date.now()&&o.timeout<Date.now()-(s?5e3:1e5)&&1==r)&&this.request(e,t,i,r,n,a)}request(e,t,r,a,s,n){for(var o in this.requestLevels)o!=a&&this.requestLevels[o][s]&&(1===this.requestLevels[o][s][0]?this.requestLevels[o][s][5]=a:delete this.requestLevels[o][s]);this.requestLevels[a]&&this.requestLevels[a][s]||(this.requestLevels[a]=this.requestLevels[a]||{},this.requestLevels[a][s]=[0,s,e.getName(),t,r,a,e.getInfo('timeSerieManagerDBElements')],!n&&this.processRequests())}processRequests(){if(!(this.requestsRunning>=this.options.maxParallelRequests)){for(var e=this,t=1,r;;){for(var a in this.requestLevels[t])if(1!=this.requestLevels[t][a][0]){r=this.requestLevels[t][a];break}if(r)break;if(t++,10<t)return}this.requestsRunning++,r&&(r[0]=1,ajaxGet({url:this.getURL(r),method:'GET',json:!0}).done(function(i){1==i.status&&(e.requestsRunning--,delete e.requestLevels[t][a],get.store(e.options.LRUName,r[1],i.data),e.processRequests(),1==r[5]&&0==Object.keys(e.requestLevels[1]).length&&e.recalculateSeries(!0))}))}}computeTimeMax(e,t){return(e+1)*(t*this.options.nbPoints)}computeTimeMin(e,t){return e*(t*this.options.nbPoints)}getURL(e){var t=this.options.url.replace('<measurementid>',e[2]).replace('<from>',this.computeTimeMin(e[3],e[4])).replace('<to>',this.computeTimeMax(e[3],e[4])).replace('<interval>',e[4]),r=e[6]||{};for(var a in r)t=t.replace('<'+a+'>',r[a]);return t}getOptimalInterval(e){var t=(this.options.optimalPxPerPoint||1)*e/this.graph.getDrawingWidth(),i=Infinity,r;return this.options.intervals.forEach(function(e){var a=Math.min(i,Math.abs(e-t));i!==a&&(r=e,i=a)}),r||1e3}computeUniqueID(e,t,r){var a='',s=e.getInfo('timeSerieManagerDBElements');for(var n in s)a+=';'+n+':'+s[n];return e.getName()+';'+t+';'+r+a}computeSlotID(e,t){return Math.floor(e/(t*this.options.nbPoints))}computeSlotTime(e,t){return e*(t*this.options.nbPoints)}getZoneSerie(e){return e._zoneSerie}updateZoneSerie(e){var t=this.graph.getSerie(e);t&&t._zoneSerie&&(t._zoneSerie.setXAxis(t.getXAxis()),t._zoneSerie.setYAxis(t.getYAxis()),t._zoneSerie.setFillColor(t.getLineColor()),t._zoneSerie.setLineColor(t.getLineColor()),t._zoneSerie.setFillOpacity(0.2),t._zoneSerie.setLineOpacity(0.3))}recalculateSeries(e){var t=this;this.locked||(this.changed=!1,this.series.map(function(i){t.recalculateSerie(i,e)}),this.changed=!1,t.graph.draw())}recalculateSerie(e,t){var i=e.getXAxis().getCurrentMin(),r=e.getXAxis().getCurrentMax(),a=this.getOptimalInterval(r-i),s=this.computeSlotID(i,a),n=this.computeSlotID(r,a),o=[],l=[];if(!(!t&&a==this.currentSlots[e.getName()].interval&&this.currentSlots[e.getName()].min<=s&&this.currentSlots[e.getName()].max>=n)){s-=2,n+=2,this.currentSlots[e.getName()].min=s,this.currentSlots[e.getName()].max=n,this.currentSlots[e.getName()].interval=a;for(var p=s;p<=n;){const t=get.get(this.options.LRUName,this.computeUniqueID(e,p,a));t?(o=o.concat(t.data.mean),l=l.concat(t.data.minmax)):this.recalculateSerieUpwards(e,p,a,o,l),p++}this.changed=!0,e.setData(o),e._zoneSerie&&e._zoneSerie.setData(l)}}setIntervalCheck(e){this.interval&&clearInterval(this.interval),this.update(!0,!0),this.interval=setInterval(()=>{this.update(!0,!1)},e)}recalculateSerieUpwards(e,t,r,a,s){var n=this.options.intervals.slice(0);n.sort();var o=n[n.indexOf(r)+1]||-1;if(0>o)return[];var p=this.computeSlotTime(t,r),d=this.computeSlotTime(t+1,r),g=this.computeSlotID(p,o),c=!1;const u=get.get(this.options.LRUName,this.computeUniqueID(e,g,o));if(u)for(var h=0,i=u.data.mean.length;h<i;h+=2){if(u.data.mean[h]<p)continue;else!1==c&&(c=h);if(u.data.mean[h]>=d)return a=a.concat(u.data.mean.slice(c,h)),void(s=a.concat(u.data.minmax.slice(c,h)))}return this.recalculateSerieUpwards(e,g,o,a,s)}lockRedraw(){this.locked=!0}unlockRedraw(){this.locked=!1}isRedrawLocked(){return!!this.locked}}class PluginSerieLineDifference extends Plugin{constructor(){super(...arguments)}static default(){return{positiveStyle:{fillColor:'green',fillOpacity:0.2,strokeWidth:0},negativeStyle:{fillColor:'red',fillOpacity:0.2,strokeWidth:0},from:0,to:0}}init(e){this.graph=e,this.pathsPositive=[],this.pathsNegative=[],this.positivePolyline=this.graph.newShape('polyline').draw(),this.positivePolyline.setFillColor(this.options.positiveStyle.fillColor).setFillOpacity(this.options.positiveStyle.fillOpacity).setStrokeWidth(this.options.positiveStyle.strokeWidth).applyStyle(),this.negativePolyline=this.graph.newShape('polyline').draw(),this.negativePolyline.setFillColor(this.options.negativeStyle.fillColor).setFillOpacity(this.options.negativeStyle.fillOpacity).setStrokeWidth(this.options.negativeStyle.strokeWidth).applyStyle()}setSeries(e,t){this.serie1=e,this.serie2=t}setBoundaries(e,t){this.options.from=e,this.options.to=t}getFrom(){return this.options.from}getTo(){return this.options.to}draw(){function e(){!0===y?a.pathsPositive.push([s,n]):!1===y&&a.pathsNegative.push([s,n]),s=[],n=[],y=void 0}function t(e,t){for(var s=0;s<t[0].length;s+=2)0==s&&(e+='M '),e+=' '+r(a.serie1.getXAxis().getPx(t[0][s]))+', '+r(a.serie1.getYAxis().getPx(t[0][s+1])),s<t[0].length-2&&(e+=' L ');for(var s=t[1].length-2;0<=s;s-=2)e+=' L '+r(a.serie2.getXAxis().getPx(t[1][s]))+', '+r(a.serie2.getYAxis().getPx(t[1][s+1])),0==s&&(e+=' z ');return e}var r=Math.round,a=this,i=this.serie1.searchClosestValue(this.getFrom()),s=[],n=[],o,l,p,g,c,u,h,x;i?(o=i.dataIndex,l=2*i.xAfterIndex):(o=0,l=0),c=this.interpolate(this.serie1,this.getFrom()),s.push(this.getFrom()),s.push(c),c=this.interpolate(this.serie2,this.getFrom()),n.push(this.getFrom()),n.push(c);for(var m,y,b;o<this.serie1.data.length;o++){for(;l<this.serie1.data[o].length;l+=2){if(this.serie1.data[o][l]>this.getTo()){c=this.interpolate(this.serie1,this.getTo()),u=this.interpolate(this.serie2,this.getTo()),h=this.computeCrossing(s[s.length-2],s[s.length-1],this.getTo(),c,n[n.length-2],n[n.length-1],this.getTo(),u),h&&(s.push(h.x),s.push(h.y),n.push(h.x),n.push(h.y),e(),s.push(h.x),s.push(h.y),n.push(h.x),n.push(h.y),y=this.serie1.data[o][l+1]>this.serie2.data[p][g+1]),s.push(this.getTo()),s.push(c),n.push(this.getTo()),n.push(u),b=!0;break}if(!m)if(m=this.serie2.searchClosestValue(this.serie1.data[o][l]),m)p=m.dataIndex,g=2*m.xBeforeIndex,c=this.interpolate(this.serie2,this.serie1.data[o][l]),s.push(this.serie1.data[o][l]),s.push(this.serie1.data[o][l+1]),n.push(this.serie1.data[o][l]),n.push(c),y=this.serie1.data[o][l+1]>c;else continue;for(x=!1,h=this.computeCrossing(s[s.length-2],s[s.length-1],this.serie1.data[o][l],this.serie1.data[o][l+1],n[n.length-2],n[n.length-1],this.serie2.data[p][g],this.serie2.data[p][g+1]),h&&(s.push(h.x),s.push(h.y),n.push(h.x),n.push(h.y),e(),s.push(h.x),s.push(h.y),n.push(h.x),n.push(h.y),y=this.serie1.data[o][l+1]>this.serie2.data[p][g+1]);this.serie2.data[p][g]<this.serie1.data[o][l];){if(n.push(this.serie2.data[p][g]),n.push(this.serie2.data[p][g+1]),g+=2,g==this.serie2.data[p].length){x=this.serie2.data[p][g-2],p++,g=0;break}h=this.computeCrossing(s[s.length-2],s[s.length-1],this.serie1.data[o][l],this.serie1.data[o][l+1],n[n.length-2],n[n.length-1],this.serie2.data[p][g],this.serie2.data[p][g+1]),h&&(s.push(h.x),s.push(h.y),n.push(h.x),n.push(h.y),e(),s.push(h.x),s.push(h.y),n.push(h.x),n.push(h.y),y=this.serie1.data[o][l+1]>this.serie2.data[p][g+1])}!1===x?(s.push(this.serie1.data[o][l]),s.push(this.serie1.data[o][l+1])):(s.push(x),s.push(this.interpolate(this.serie1,x)),m=!1,l-=2,e())}if(b){e();break}c=this.interpolate(this.serie2,s[s.length-2]),c&&(n.push(s[s.length-2]),n.push(c)),e(),l=0,m=!1}var A=this.pathsPositive.reduce(t,'');this.positivePolyline.setPointsPx(A).redraw();var A=this.pathsNegative.reduce(t,'');this.negativePolyline.setPointsPx(A).redraw()}interpolate(e,t){var i=e.searchClosestValue(t);if(!i)return!1;if(void 0==i.xMax)return i.yMin;if(void 0==i.xMin)return i.yMax;var r=(t-i.xMin)/(i.xMax-i.xMin);return(1-r)*i.yMin+r*i.yMax}computeCrossing(e,t,i,r,a,s,n,o){var l=(r-t)/(i-e),p=(o-s)/(n-a),d=r-l*i;if(e==i||a==n)return!1;if(l==p)return{x:e,y1:t,y2:t};var g=(d-(o-p*n))/(p-l);return g>i||g<e||g<a||g>n?!1:{x:g,y:l*g+d}}getPositivePolyline(){return this.positivePolyline}getNegativePolyline(){return this.negativePolyline}}class SerieLineExtended extends SerieLine{constructor(){super(...arguments),this.subSeries=[]}setData(){return super.setData(...arguments),this.subSeries.map((e)=>{e.data=this.data}),this}draw(){return this.eraseMarkers(),this}getSymbolForLegend(){return!!this.subSeries[0]&&this.subSeries[0].getSymbolForLegend()}getMarkerForLegend(){return!!this.subSeries[0]&&this.subSeries[0].getMarkerForLegend()}}class SerieScatterExtended extends SerieScatter{constructor(){super(...arguments),this.subSeries=[]}setData(){return super.setData(...arguments),this.subSeries.map((e)=>{e.data=this.data}),this}draw(){return this}getSymbolForLegend(){return!!this.subSeries[0]&&this.subSeries[0].getSymbolForLegend()}getMarkerForLegend(){return!!this.subSeries[0]&&this.subSeries[0].getMarkerForLegend()}}var excludingMethods=['constructor','init','draw','setLineColor','setLineWidth','setLineStyle','getLineColor','getLineWidth','getLineStyle','setMarkers','showMarkers','hideMarkers','getMarkerDom','getMarkerDomIndependant','getMarkerPath','eraseMarkers','_recalculateMarkerPoints'],addMethods=[];Object.getOwnPropertyNames(SerieLine.prototype).concat(addMethods).map(function(e){-1<excludingMethods.indexOf(e)||(SerieLineExtended.prototype[e]=function(e){return function(){var t=arguments;this.subSeries.map((i)=>{i[e](...t)})}}(e))});class PluginAxisSplitting extends Plugin{constructor(){super(...arguments),this.series=new Map}static defaults(){return{axes:{margins:{high:5,low:5}}}}init(e){this.graph=e}newXAxis(e){return this.newBottomAxis(e)}newYAxis(e){return this.newLeftAxis(e)}newTopAxis(e){return e=this.getOptions(e),new SplitXAxis(this.graph,'top',e)}newBottomAxis(e){return e=this.getOptions(e),new SplitXAxis(this.graph,'bottom',e)}newLeftAxis(e){return e=this.getOptions(e),new SplitYAxis(this.graph,'left',e)}newRightAxis(e){return e=this.getOptions(e),new SplitYAxis(this.graph,'right',e)}getOptions(e){var t={marginMin:this.options.axes.margins.low,marginMax:this.options.axes.margins.high};return extend(!0,t,e)}preDraw(){var e,t;this.series.forEach(({serie:i})=>{e=i.getXAxis(),t=i.getYAxis();let r=1;for(e.splitNumber&&(r*=e.splitNumber),t.splitNumber&&(r*=t.splitNumber);i.subSeries.length<r;){const e=i.getName()+'_'+i.subSeries.length,t=this.graph.newSerie(e,{},i.getType()||Graph$1.SERIE_LINE);t.excludedFromLegend=!0,t.styles=i.styles,t.data=i.data,i.getType()==Graph$1.SERIE_LINE&&(t.markerPoints=i.markerPoints,t.markerFamilies=i.markerFamilies),i.subSeries.push(t)}for(;i.subSeries.length>r;){let e=this.graph.getSerie(i.getName()+'_'+(i.subSeries.length-1));e&&e.kill&&e.kill(),i.subSeries.pop()}!i.getXAxis().splitNumber&&i.getXAxis().splitAxis&&i.getXAxis().splitAxis(),!i.getYAxis().splitNumber&&i.getYAxis().splitAxis&&i.getYAxis().splitAxis(),i.subSeries.map((t,r)=>{var a,s;if(i.getXAxis().getSubAxis){let t=r%(e.splitNumber||1);a=i.getXAxis().getSubAxis(t)}else a=i.getXAxis();if(t.setXAxis(a),i.getYAxis().getSubAxis){let t=Math.floor(r/(e.splitNumber||1));s=i.getYAxis().getSubAxis(t)}else s=i.getYAxis();t.setYAxis(s),t.draw(!0)})})}newSerie(e,t={},i){switch(i){case'line':return this.newLineSerie(e,t);break;case'scatter':return this.newScatterSerie(e,t);}throw'Cannot create a split serie of type '+i}newLineSerie(e,t){var i={type:'lineSerie',serie:new SerieLineExtended(e,t,'line')};return this.series.set(e,i),i.serie.init(this.graph,e,t),this.graph.series.push(i.serie),i.serie}newScatterSerie(e,t){var i={type:'scatterSerie',serie:new SerieScatterExtended(e,t,'scatter')};return this.series.set(e,i),i.serie.init(this.graph,t),this.graph.series.push(i.serie),i.serie}}var defaultAxisConstructorOptions={splitMarks:!0},SplitAxis=function(e){var t=Math.max,i=class extends e{constructor(e,t,i={}){super(e,t,i),this.axes=[],this.position=t,this.constructorOptions=extend(!0,{},defaultAxisConstructorOptions,i),this._splitVal=[]}all(e){if('function'==typeof e)return this.axes.map(e),this}splitAxis(...e){e.push(1);let t=e.length;for(;this.axes.length>t;)this.axes.pop().kill(!0,!0);for(;this.axes.length<t;){let e=new(this.getConstructor())(this.graph,this.position,this.constructorOptions);this.axes.push(e),e.zoomLock=!0,e.init(this.graph,this.constructorOptions)}let r=0,a=0;for(let t of this.axes)t.options.marginMin=10,t.options.marginMax=10,0==a&&(t.options.marginMin=0),a==this.axes.length-1&&(t.options.marginMax=0),t.setSpan(r,r=e[a]),t.setMinMaxFlipped(),a++;return this._splits=e,this}fixGridIntervalBasedOnAxis(e){return this.fixGridFor=e,this.graph._axisHasChanged(),this}splitSpread(e){return this.autoSpread=!!e,this}hasAxis(e){return-1<this.axes.indexOf(e)}_splitSpread(){let e=[],t=0,i=0;for(let e of this._splitVal)t+=e[1]-e[0];for(let r of this._splitVal)e.push(i+=(r[1]-r[0])/t);e.pop(),this.splitAxis(...e)}setChunkBoundaries(e){let t=0,i,r;for(let a of this.axes)Array.isArray(e[t])&&1<e[t].length&&!i&&(i=e[t][1]-e[t][0],r=t),1!=e[t].length&&Array.isArray(e[t])?a.forceMin(e[t][0]).forceMax(e[t][1]):(a._mean=e[t],Array.isArray(a._mean)&&(a._mean=a._mean[0])),t++;return this._baseWidthVal=i,this._baseWidthIndex=r,this._splitVal=e,this.graph._axisHasChanged(),this}setMinMaxToFitSeries(){(!this._splitVal||1>this._splitVal.length)&&(super.setMinMaxToFitSeries(...arguments),this._splitVal[0]=this._splitVal[0]||[],this._splitVal[this._splitVal.length-1]=this._splitVal[this._splitVal.length-1]||[],this._splitVal[0][0]=this.getCurrentMin(),this._splitVal[this._splitVal.length-1][1]=this.getCurrentMax(),this.setChunkBoundaries(this._splitVal))}draw(){this.autoSpread&&this._splitSpread();let e=0,i,r,a;if(0<=this._baseWidthIndex&&(r=this.getSubAxis(this._baseWidthIndex))&&(a=r.getSpan()),r=void 0,0<=this.fixGridFor&&(r=this.getSubAxis(this.fixGridFor))){if(void 0!==r._mean){let e=(r.getSpan()[1]-r.getSpan()[0])/(a[1]-a[0])*this._baseWidthVal;r.forceMin(r._mean-e/2),r.forceMax(r._mean+e/2)}e=r.draw(),i=r.getPrimaryTickUnit()}return this.axes.map((s)=>{if(r!==s){if(void 0!==s._mean){let e=(s.getSpan()[1]-s.getSpan()[0])/(a[1]-a[0])*this._baseWidthVal;s.forceMin(s._mean-e/2),s.forceMax(s._mean+e/2)}i&&s.forcePrimaryTickUnit(i),e=t(e,s.draw())}}),this.writeUnit(),e}setMinPx(e){super.setMinPx(e);for(let t of this.axes)t.setMinPx(e)}setMaxPx(e){super.setMaxPx(e);for(let t of this.axes)t.setMaxPx(e)}setShift(){super.setShift(...arguments);for(let e of this.axes)e.setShift(...arguments)}init(){super.init(...arguments),this.splitAxis()}getAxisPosition(){var e=0;return this.axes.map((i)=>{e=t(e,i.getAxisPosition())}),e}getSubAxis(e){if(this.axes.length<=e)throw'Impossible to reach axis. Index '+e+' is out of range';return this.axes[e]}get splitNumber(){return this._splits.length}};return['turnGridsOff','turnGridsOn','gridsOff','gridsOn','setEngineering','setScientificScaleExponent','setScientific','setLabelColor','setSecondaryGridDasharray','setPrimaryGridDasharray','setSecondaryGridsOpacity','setPrimaryGridOpacity','setSecondaryGridWidth','setPrimaryGridWidth','setSecondaryGridColor','setPrimaryGridColor','setTicksLabelColor','setSecondaryTicksColor','setPrimaryTicksColor','setAxisColor','secondaryGridOn','secondaryGridOff','primaryGridOff','primaryGridOn','setSecondaryGrid','setPrimaryGrid','setGrids','setTickPosition','setExponentialFactor','setExponentialLabelFactor','setGridLinesStyle','forcePrimaryTickUnitMin','forcePrimaryTickUnitMax','forcePrimaryTickUnit','flip','show','hide','setDisplay'].map((e)=>{i.prototype[e]=function(e){return function(){return this.axes.map((t)=>{t[e](...arguments)}),this}}(e)}),i};class SplitXAxis extends SplitAxis(AxisX){constructor(e,t){super(...arguments),this.topbottom=t}getConstructor(){return AxisX}getAxisPosition(){var e=super.getAxisPosition(...arguments);return this.labelPosY=e,this.getLabel()&&(e+=this.graph.options.fontSize),e}drawLabel(){super.drawLabel(),this.label.setAttribute('y',(this.top?-1:1)*(this.graph.options.fontSize+this.labelPosY))}draw(){var e=super.draw(...arguments);return this.drawLabel(),e}}class SplitYAxis extends SplitAxis(AxisY){constructor(){super(...arguments)}getConstructor(){return AxisY}drawLabel(){super.drawLabel()}equalizePosition(e){var t=e;if(this.getLabel()&&this.axes.map((i)=>{t=Math.max(i.equalizePosition(e),t)}),this.getLabel())return this.placeLabel(this.left?-t:t),t+this.graph.options.fontSize}}mix(SplitXAxis,new AxisX),mix(SplitYAxis,new AxisY);class PluginMakeTracesDifferent extends Plugin{constructor(){super(...arguments)}init(e,t){super.init(e,t)}static default(){return{}}checkHSL(e){let t={},i,r,a;return(i=e.h||e.hue)?(1>i&&(i=Math.round(360*i)),t.hue=i):t.h=0,(r=e.s||e.saturation)?(1<r&&(r/=100),t.saturation=r):t.saturation=0.75,(a=e.lightness||e.l)?(1<a&&(a/=100),t.lightness=a):t.lightness=0.5,t}buildHSLString(e){var t=Math.round;return'hsl( '+t(e.h)+', '+t(100*e.s)+'%, '+t(100*e.l)+'%)'}colorizeAll(e,t=!1){let i,r;if(e.serieTypes?(!Array.isArray(e.serieTypes)&&(e.serieTypes=[e.serieTypes]),i=this.graph.allSeries(...e.serieTypes)):i=this.graph.getSeries(),r=i.length,!e.startingColorHSL)if(e.colorHSL)e.startingColorHSL=this.checkHSL(e.colorHSL);else throw'No starting color was provided. There must exist either options.colorHSL or options.startingColorHSL';if(!e.endingColorHSL)switch(e.affect&&['h','s','l','hue','saturation','lightness'].include(e.affect)||(e.affect='h'),e.affect){case'h':case'hue':e.endingColorHSL={h:e.startingColorHSL.h+300,s:e.startingColorHSL.s,l:e.startingColorHSL.l};break;case'saturation':case's':let t;t=0.5<e.startingColorHSL.s?0:1,e.endingColorHSL={h:e.startingColorHSL.h,s:t,l:e.startingColorHSL.l};break;case'lightness':case'l':let i;i=0.5<e.startingColorHSL.l?0:0.75,e.endingColorHSL={h:e.startingColorHSL.h,s:e.startingColorHSL.s,l:i};}else e.endingColorHSL=Object.assign({},e.startingColorHSL,e.endingColorHSL);return i.map((i,a)=>{if(!i.setLineColor)throw'The serie '+i.getName()+' does not implement the method `startingColor`';let s;return s=1==r?this.buildHSLString({h:e.startingColorHSL.h,s:e.startingColorHSL.s,l:e.startingColorHSL.l}):this.buildHSLString({h:e.startingColorHSL.h+a/(r-1)*(e.endingColorHSL.h-e.startingColorHSL.h),s:e.startingColorHSL.s+a/(r-1)*(e.endingColorHSL.s-e.startingColorHSL.s),l:e.startingColorHSL.l+a/(r-1)*(e.endingColorHSL.l-e.startingColorHSL.l)}),i.setLineColor(s),'function'==typeof t&&t(a,s),s})}}class PluginPeakPicking extends Plugin{constructor(){super(...arguments)}static default(){return{autoPeakPicking:!1,autoPeakPickingNb:4,autoPeakPickingMinDistance:10,autoPeakPickingFormat:!1,autoPeakPickingAllowAllY:!1}}init(e,t){super.init(e,t),this.picks=[];for(var i=0,r=this.options.autoPeakPickingNb,a;i<r;i++)a=this.graph.newShape({type:'label',label:{text:'',position:{x:0},anchor:'middle'},selectable:!0,shapeOptions:{minPosY:15}}),a.draw(),this.picks.push(a)}setSerie(e){this.serie=e}serieRemoved(e){this.serie==e&&this.picks.map((e)=>{e.kill()})}preDraw(){this.serie&&(this.detectedPeaks=[],this.lastYPeakPicking=!1)}postDraw(){if(!this.serie)return;let e=!0,t=!1,r=[],a=this.serie.getWaveform(),s;if(!a)throw'The serie must have a waveform for the peak picking to work';let n=a.getLength(),o=0,i;for(;o<n;o++){if(i=a.getY(o),this.serie.options.lineToZero){r.push([a.getX(o),i]);continue}if(!s){s=[a.getX(o),i];continue}i>=s[1]&&e||i<=s[1]&&t?s=[a.getX(o),i]:(i<s[1]&&e||i>s[1]&&t)&&(t?(t=!1,e=!0):(t=!0,e=!1,r.push(s),s=!1),s=[a.getX(o),i])}var p=r,d=[],g=p.length,l,c,c,u,h,m;o=0;var y=this.graph.selectedShapes.map(function(e){return e.getProp('xval')});for(p.sort(function(e,t){return t[1]-e[1]}),h=0;o<g;o++)if((l=p[o][0],c=this.serie.getX(l),u=0,i=this.serie.getY(p[o][1]),!(c<this.serie.getXAxis().getMinPx()||c>this.serie.getXAxis().getMaxPx()))&&!(!this.options.autoPeakPickingAllowAllY&&(i>this.serie.getYAxis().getMinPx()||i<this.serie.getYAxis().getMaxPx()))){for(;u<d.length&&!(Math.abs(d[u]-c)<this.options.autoPeakPickingMinDistance);u++);if(!(u<d.length)){if(-1<(m=y.indexOf(l))){d.push(c);continue}if(!this.picks[h])return;for(0>this.serie.getYAxis().getPx(p[o][1])-20?(this.picks[h].setLabelPosition({x:l,y:'5px'}),this.picks[h].setLabelBaseline('hanging')):(this.picks[h].setLabelBaseline('no-change'),this.picks[h].setLabelPosition({x:l,y:p[o][1],dy:'-15px'})),this.picks[h].setProp('xval',l),this.options.autoPeakPickingFormat?this.picks[h].setLabelText(this.options.autoPeakPickingFormat.call(this.picks[h],l,h)):this.picks[h].setLabelText(Math.round(1e3*l)/1e3+''),this.picks[h].makeLabels(),h++;this.picks[h]&&this.picks[h].isSelected();)h++;if(d.length==this.options.autoPeakPickingNb)break}}}hidePeakPicking(e){if(this._hidePeakPickingLocked||(this._hidePeakPickingLocked=e),!!this.graph.picks)for(var t=0;t<this.graph.picks.length;t++)this.graph.picks[t].hide()}showPeakPicking(e){if((!this._hidePeakPickingLocked||e)&&this.graph.picks)for(var t=0;t<this.graph.picks.length;t++)this.graph.picks[t].show()}killPeakPicking(){if(this.picks)for(var e=0,t=this.picks.length;e<t;e++)this.picks[e].kill()}}Graph$1.registerConstructor('graph.position',Position),Graph$1.registerConstructor('graph.axis.x',AxisX),Graph$1.registerConstructor('graph.axis.y',AxisY),Graph$1.registerConstructor('graph.axis.x.bar',AxisXBar),Graph$1.registerConstructor('graph.axis.x.time',GraphTimeAxis),Graph$1.registerConstructor('graph.serie.line',SerieLine),Graph$1.registerConstructor('graph.serie.line.3d',SerieLine3D),Graph$1.registerConstructor('graph.serie.line.color',SerieLineColor),Graph$1.registerConstructor('graph.serie.contour',SerieContour),Graph$1.registerConstructor('graph.serie.bar',SerieBar),Graph$1.registerConstructor('graph.serie.box',SerieBox),Graph$1.registerConstructor('graph.serie.scatter',SerieScatter),Graph$1.registerConstructor('graph.serie.zone',SerieZone),Graph$1.registerConstructor('graph.serie.zone.3d',SerieZone3D),Graph$1.registerConstructor('graph.serie.densitymap',SerieDensityMap),Graph$1.registerConstructor(Graph$1.SERIE_LINE,SerieLine),Graph$1.registerConstructor(Graph$1.SERIE_LINE_3D,SerieLine3D),Graph$1.registerConstructor(Graph$1.SERIE_LINE_COLORED,SerieLineColor),Graph$1.registerConstructor(Graph$1.SERIE_CONTOUR,SerieContour),Graph$1.registerConstructor(Graph$1.SERIE_BAR,SerieBar),Graph$1.registerConstructor(Graph$1.SERIE_BOX,SerieBox),Graph$1.registerConstructor(Graph$1.SERIE_SCATTER,SerieScatter),Graph$1.registerConstructor(Graph$1.SERIE_ZONE,SerieZone),Graph$1.registerConstructor(Graph$1.SERIE_ZONE_3D,SerieZone3D),Graph$1.registerConstructor(Graph$1.SERIE_DENSITYMAP,SerieDensityMap),Graph$1.registerConstructor('graph.plugin.shape',PluginShape),Graph$1.registerConstructor('graph.plugin.drag',PluginDrag),Graph$1.registerConstructor('graph.plugin.zoom',PluginZoom),Graph$1.registerConstructor('graph.plugin.selectScatter',PluginSelectScatter),Graph$1.registerConstructor('graph.plugin.timeSerieManager',PluginTimeSerieManager),Graph$1.registerConstructor('graph.plugin.serielinedifference',PluginSerieLineDifference),Graph$1.registerConstructor('graph.plugin.serieLineDifference',PluginSerieLineDifference),Graph$1.registerConstructor('graph.plugin.axissplitting',PluginAxisSplitting),Graph$1.registerConstructor('graph.plugin.makeTracesDifferent',PluginMakeTracesDifferent),Graph$1.registerConstructor('graph.plugin.peakPicking',PluginPeakPicking),Graph$1.registerConstructor('graph.shape',Shape),Graph$1.registerConstructor('graph.shape.areaundercurve',ShapeSurfaceUnderCurve),Graph$1.registerConstructor('graph.shape.arrow',ShapeArrow),Graph$1.registerConstructor('graph.shape.ellipse',ShapeEllipse),Graph$1.registerConstructor('graph.shape.label',ShapeLabel),Graph$1.registerConstructor('graph.shape.polyline',ShapePolyline),Graph$1.registerConstructor('graph.shape.line',ShapeLine),Graph$1.registerConstructor('graph.shape.nmrintegral',ShapeNMRIntegral),Graph$1.registerConstructor('graph.shape.html',ShapeHTML),Graph$1.registerConstructor('graph.shape.peakintegration2d',ShapePeakIntegration2D),Graph$1.registerConstructor('graph.shape.rect',ShapeRectangle),Graph$1.registerConstructor('graph.shape.rectangle',ShapeRectangle),Graph$1.registerConstructor('graph.shape.cross',ShapeCross),Graph$1.registerConstructor('graph.shape.peakboundariescenter',ShapePeakBoundaries),Graph$1.registerConstructor('graph.legend',Legend),Graph$1.registerConstructor('graph.waveform',Waveform);export default Graph$1;
//# sourceMappingURL=jsgraph-module.min.js.map
