/* !
* Graphing JavaScript Library v0.2.0
* https://github.com/NPellet/graph
* 
* Copyright (c) 2014 Norman Pellet
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
* 
* The above copyright notice and this permission notice shall be included in
* all copies or substantial portions of the Software.
* 
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
* THE SOFTWARE.
* 
* Date: 08-08-2014
*/
define([],function(){var t=function(){};return t.prototype={init:function(t,o){this._zoomingGroup=document.createElementNS(t.ns,"g"),this._zoomingSquare=document.createElementNS(t.ns,"rect"),this._zoomingSquare.setAttribute("display","none"),t.setAttributeTo(this._zoomingSquare,{display:"none",fill:"rgba(171,12,12,0.2)",stroke:"rgba(171,12,12,1)","shape-rendering":"crispEdges",x:0,y:0,height:0,width:0}),this.options=o,this.graph=t,t.dom.appendChild(this._zoomingGroup),this._zoomingGroup.appendChild(this._zoomingSquare)},onMouseDown:function(t,o,i,e,s){var a=this.options.zoomMode;if(a){switch(this._zoomingMode=a,void 0===o&&(this._backedUpZoomMode=this._zoomingMode,this._zoomingMode="y",o=0),void 0===i&&(this._backedUpZoomMode=this._zoomingMode,this._zoomingMode="x",i=0),this._zoomingXStart=o,this._zoomingYStart=i,this.x1=o-t.getPaddingLeft(),this.y1=i-t.getPaddingTop(),this._zoomingSquare.setAttribute("width",0),this._zoomingSquare.setAttribute("height",0),this._zoomingSquare.setAttribute("display","block"),this._zoomingMode){case"x":this._zoomingSquare.setAttribute("y",t.options.paddingTop),this._zoomingSquare.setAttribute("height",t.getDrawingHeight()-t.shift[0]);break;case"y":this._zoomingSquare.setAttribute("x",t.options.paddingLeft),this._zoomingSquare.setAttribute("width",t.getDrawingWidth())}this.options.onZoomStart&&!s&&this.options.onZoomStart(t,o,i,e,s)}},onMouseMove:function(t,o,i,e,s){switch(this._zoomingMode){case"xy":this._zoomingSquare.setAttribute("x",Math.min(this._zoomingXStart,o)),this._zoomingSquare.setAttribute("y",Math.min(this._zoomingYStart,i)),this._zoomingSquare.setAttribute("width",Math.abs(this._zoomingXStart-o)),this._zoomingSquare.setAttribute("height",Math.abs(this._zoomingYStart-i));break;case"x":this._zoomingSquare.setAttribute("x",Math.min(this._zoomingXStart,o)),this._zoomingSquare.setAttribute("width",Math.abs(this._zoomingXStart-o));break;case"y":this._zoomingSquare.setAttribute("y",Math.min(this._zoomingYStart,i)),this._zoomingSquare.setAttribute("height",Math.abs(this._zoomingYStart-i))}this.options.onZoomMove&&!s&&this.options.onZoomMove(t,o,i,e,s)},onMouseUp:function(t,o,i,e,s){this._zoomingSquare.setAttribute("display","none");var a=o-t.options.paddingLeft,n=i-t.options.paddingTop;if(!(o-this._zoomingXStart==0&&"y"!=this._zoomingMode||i-this._zoomingYStart==0&&"x"!=this._zoomingMode)){switch(this._zoomingMode){case"x":t.applyToAxes("_doZoom",[a,this.x1],!0,!1);break;case"y":t.applyToAxes("_doZoom",[n,this.y1],!1,!0);break;case"xy":t.applyToAxes("_doZoom",[a,this.x1],!0,!1),t.applyToAxes("_doZoom",[n,this.y1],!1,!0)}t.redraw(!0),t.drawSeries(),this.options.onZoomEnd&&!s&&this.options.onZoomEnd(t,o,i,e,s),this._backedUpZoomMode&&(this._zoomingMode=this._backedUpZoomMode)}},onMouseWheel:function(t,o){var i;return(i=this.graph.getSelectedSerie())?void i.getYAxis().handleMouseWheel(t,o):void this.graph.applyToAxes("handleMouseWheel",[t,o],!1,!0)},onDblClick:function(t,o,i,e,s,a){var n=this.graph.getXAxis(),h=this.graph.getYAxis();if("xtotal"==e.mode)this.graph.applyToAxes("setMinMaxToFitSeries",null,!0,!1),this.graph.drawSeries();else if("ytotal"==e.mode)this.graph.applyToAxes("setMinMaxToFitSeries",null,!1,!0),this.graph.drawSeries();else if("total"==e.mode)this.graph.autoscaleAxes(),this.graph.drawSeries(),h.options.onZoom&&h.options.onZoom(h.getMinValue(),h.getMaxValue()),n.options.onZoom&&n.options.onZoom(n.getMinValue(),n.getMaxValue());else{o-=this.graph.options.paddingLeft,i-=this.graph.options.paddingTop;var r=n.getActualMin(),g=n.getActualMax(),m=n.getVal(o),d=g-r,p=h.getActualMin(),u=h.getActualMax(),l=h.getVal(i),M=u-p;if("gradualXY"==e.mode||"gradualX"==e.mode){var _=(m-r)/(g-r);r=Math.max(n.getMinValue(),r-d*_),g=Math.min(n.getMaxValue(),g+d*(1-_)),n.setCurrentMin(r),n.setCurrentMax(g),n.options.onZoom&&n.options.onZoom(r,g)}if("gradualXY"==e.mode||"gradualY"==e.mode){var _=(l-p)/(u-p);p=Math.max(h.getMinValue(),p-M*_),u=Math.min(h.getMaxValue(),u+M*(1-_)),h.setCurrentMin(p),h.setCurrentMax(u),h.options.onZoom&&h.options.onZoom(p,u)}this.graph.redraw(),this.graph.drawSeries()}this.options.onDblClick&&!a&&this.options.onDblClick(o,i,e,s)}},t});